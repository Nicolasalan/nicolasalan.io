[
  {
    "title": "Base64",
    "summary": "Como funciona e para que serve base64",
    "publishedAt": "2023-12-12",
    "tags": [
      "Code"
    ],
    "shortTitle": "Base64",
    "body": {
      "raw": "\nAtualmente, estou trabalhando em uma API para transferir uma imagem capturada por um dispositivo móvel e convertê-la para o formato base64. Aqui está tudo o que estudei sobre esse formato.\n\n### Base 64\n\nBasicamente, trata-se de uma maneira de enviar arquivos, como imagens e áudio, em um formato alfanumérico especial que pode incluir letras, números e barras, tudo em uma única string. Essa abordagem é rápida para o envio de imagens, no meu caso, visando processamento mais ágil e economia de espaço.\n\n<Alert type=\"warning\">\n Às vezes, o número de caracteres pode exceder o limite de tamanho de uma variável, já que uma string ocupa mais espaço do que dados binários. É importante ter cuidado com o tamanho limite dos logs, por exemplo.\n</Alert>\n\nPara ilustrar, imagine uma ligação telefônica entre Bob e Ana. Ela deseja enviar uma imagem para Bob, mas não pode simplesmente descrever a imagem, pois isso levaria a uma cópia imprecisa. Ela poderia converter todos os bits e enviar cada dígito, mas isso demandaria muito tempo e recursos. Então, decidem utilizar um método de \"criptografia\", onde substituem os bits por caracteres.\n\nO base64 foi criado há muito tempo para resolver esse problema de conversão de bits em caracteres. Um dos problemas era o e-mail, onde só era possível enviar texto, não sendo permitido o envio de dados binários, como imagens, vídeos e arquivos.\n\nExemplo de de imagem 5x5 em dígitos binários:\n\n```text\n010001 110100 100101 000110 001110 000011 011101 100001 000000 010000 000000 000001 000000 001111 000000 000000 000000 001111 111100 000000 000000 000000 000000 000000 000000 000010 110000 000000 000000 000000 000000 000000 000000 010000 000000 000001 000000 000000 000000 000010 000000 100100 010000 000001 000000 000011 001011\n```\nImagem convertida para Base64 tenha esta aparência:\n\n```text   \nR0lGODdhAQABAPAAAP8AAAAAACwAAAAAAQABAAACAkQBADs\n```",
      "code": "var Component=(()=>{var lr=Object.create;var k=Object.defineProperty;var ur=Object.getOwnPropertyDescriptor;var cr=Object.getOwnPropertyNames;var dr=Object.getPrototypeOf,fr=Object.prototype.hasOwnProperty;var z=(l,t)=>()=>(t||l((t={exports:{}}).exports,t),t.exports),mr=(l,t)=>{for(var m in t)k(l,m,{get:t[m],enumerable:!0})},Ee=(l,t,m,y)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let h of cr(t))!fr.call(l,h)&&h!==m&&k(l,h,{get:()=>t[h],enumerable:!(y=ur(t,h))||y.enumerable});return l};var br=(l,t,m)=>(m=l!=null?lr(dr(l)):{},Ee(t||!l||!l.__esModule?k(m,\"default\",{value:l,enumerable:!0}):m,l)),vr=l=>Ee(k({},\"__esModule\",{value:!0}),l);var Re=z((xr,xe)=>{xe.exports=React});var we=z(G=>{\"use strict\";(function(){\"use strict\";var l=Re(),t=Symbol.for(\"react.element\"),m=Symbol.for(\"react.portal\"),y=Symbol.for(\"react.fragment\"),h=Symbol.for(\"react.strict_mode\"),X=Symbol.for(\"react.profiler\"),K=Symbol.for(\"react.provider\"),H=Symbol.for(\"react.context\"),C=Symbol.for(\"react.forward_ref\"),F=Symbol.for(\"react.suspense\"),U=Symbol.for(\"react.suspense_list\"),A=Symbol.for(\"react.memo\"),I=Symbol.for(\"react.lazy\"),Ae=Symbol.for(\"react.offscreen\"),Q=Symbol.iterator,De=\"@@iterator\";function Oe(e){if(e===null||typeof e!=\"object\")return null;var r=Q&&e[Q]||e[De];return typeof r==\"function\"?r:null}var x=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function b(e){{for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];Pe(\"error\",e,n)}}function Pe(e,r,n){{var a=x.ReactDebugCurrentFrame,s=a.getStackAddendum();s!==\"\"&&(r+=\"%s\",n=n.concat([s]));var u=n.map(function(i){return String(i)});u.unshift(\"Warning: \"+r),Function.prototype.apply.call(console[e],console,u)}}var Se=!1,je=!1,ke=!1,Fe=!1,Ue=!1,J;J=Symbol.for(\"react.module.reference\");function Ie(e){return!!(typeof e==\"string\"||typeof e==\"function\"||e===y||e===X||Ue||e===h||e===F||e===U||Fe||e===Ae||Se||je||ke||typeof e==\"object\"&&e!==null&&(e.$$typeof===I||e.$$typeof===A||e.$$typeof===K||e.$$typeof===H||e.$$typeof===C||e.$$typeof===J||e.getModuleId!==void 0))}function Ye(e,r,n){var a=e.displayName;if(a)return a;var s=r.displayName||r.name||\"\";return s!==\"\"?n+\"(\"+s+\")\":n}function Z(e){return e.displayName||\"Context\"}function g(e){if(e==null)return null;if(typeof e.tag==\"number\"&&b(\"Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue.\"),typeof e==\"function\")return e.displayName||e.name||null;if(typeof e==\"string\")return e;switch(e){case y:return\"Fragment\";case m:return\"Portal\";case X:return\"Profiler\";case h:return\"StrictMode\";case F:return\"Suspense\";case U:return\"SuspenseList\"}if(typeof e==\"object\")switch(e.$$typeof){case H:var r=e;return Z(r)+\".Consumer\";case K:var n=e;return Z(n._context)+\".Provider\";case C:return Ye(e,e.render,\"ForwardRef\");case A:var a=e.displayName||null;return a!==null?a:g(e.type)||\"Memo\";case I:{var s=e,u=s._payload,i=s._init;try{return g(i(u))}catch{return null}}}return null}var E=Object.assign,T=0,ee,re,ne,ae,te,oe,ie;function se(){}se.__reactDisabledLog=!0;function $e(){{if(T===0){ee=console.log,re=console.info,ne=console.warn,ae=console.error,te=console.group,oe=console.groupCollapsed,ie=console.groupEnd;var e={configurable:!0,enumerable:!0,value:se,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}T++}}function We(){{if(T--,T===0){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:E({},e,{value:ee}),info:E({},e,{value:re}),warn:E({},e,{value:ne}),error:E({},e,{value:ae}),group:E({},e,{value:te}),groupCollapsed:E({},e,{value:oe}),groupEnd:E({},e,{value:ie})})}T<0&&b(\"disabledDepth fell below zero. This is a bug in React. Please file an issue.\")}}var Y=x.ReactCurrentDispatcher,$;function D(e,r,n){{if($===void 0)try{throw Error()}catch(s){var a=s.stack.trim().match(/\\n( *(at )?)/);$=a&&a[1]||\"\"}return`\n`+$+e}}var W=!1,O;{var Me=typeof WeakMap==\"function\"?WeakMap:Map;O=new Me}function le(e,r){if(!e||W)return\"\";{var n=O.get(e);if(n!==void 0)return n}var a;W=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var u;u=Y.current,Y.current=null,$e();try{if(r){var i=function(){throw Error()};if(Object.defineProperty(i.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(i,[])}catch(_){a=_}Reflect.construct(e,[],i)}else{try{i.call()}catch(_){a=_}e.call(i.prototype)}}else{try{throw Error()}catch(_){a=_}e()}}catch(_){if(_&&a&&typeof _.stack==\"string\"){for(var o=_.stack.split(`\n`),v=a.stack.split(`\n`),c=o.length-1,f=v.length-1;c>=1&&f>=0&&o[c]!==v[f];)f--;for(;c>=1&&f>=0;c--,f--)if(o[c]!==v[f]){if(c!==1||f!==1)do if(c--,f--,f<0||o[c]!==v[f]){var p=`\n`+o[c].replace(\" at new \",\" at \");return e.displayName&&p.includes(\"<anonymous>\")&&(p=p.replace(\"<anonymous>\",e.displayName)),typeof e==\"function\"&&O.set(e,p),p}while(c>=1&&f>=0);break}}}finally{W=!1,Y.current=u,We(),Error.prepareStackTrace=s}var w=e?e.displayName||e.name:\"\",ye=w?D(w):\"\";return typeof e==\"function\"&&O.set(e,ye),ye}function Ve(e,r,n){return le(e,!1)}function Be(e){var r=e.prototype;return!!(r&&r.isReactComponent)}function P(e,r,n){if(e==null)return\"\";if(typeof e==\"function\")return le(e,Be(e));if(typeof e==\"string\")return D(e);switch(e){case F:return D(\"Suspense\");case U:return D(\"SuspenseList\")}if(typeof e==\"object\")switch(e.$$typeof){case C:return Ve(e.render);case A:return P(e.type,r,n);case I:{var a=e,s=a._payload,u=a._init;try{return P(u(s),r,n)}catch{}}}return\"\"}var S=Object.prototype.hasOwnProperty,ue={},ce=x.ReactDebugCurrentFrame;function j(e){if(e){var r=e._owner,n=P(e.type,e._source,r?r.type:null);ce.setExtraStackFrame(n)}else ce.setExtraStackFrame(null)}function Le(e,r,n,a,s){{var u=Function.call.bind(S);for(var i in e)if(u(e,i)){var o=void 0;try{if(typeof e[i]!=\"function\"){var v=Error((a||\"React class\")+\": \"+n+\" type `\"+i+\"` is invalid; it must be a function, usually from the `prop-types` package, but received `\"+typeof e[i]+\"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.\");throw v.name=\"Invariant Violation\",v}o=e[i](r,i,a,n,null,\"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED\")}catch(c){o=c}o&&!(o instanceof Error)&&(j(s),b(\"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).\",a||\"React class\",n,i,typeof o),j(null)),o instanceof Error&&!(o.message in ue)&&(ue[o.message]=!0,j(s),b(\"Failed %s type: %s\",n,o.message),j(null))}}}var qe=Array.isArray;function M(e){return qe(e)}function ze(e){{var r=typeof Symbol==\"function\"&&Symbol.toStringTag,n=r&&e[Symbol.toStringTag]||e.constructor.name||\"Object\";return n}}function Ge(e){try{return de(e),!1}catch{return!0}}function de(e){return\"\"+e}function fe(e){if(Ge(e))return b(\"The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.\",ze(e)),de(e)}var N=x.ReactCurrentOwner,Xe={key:!0,ref:!0,__self:!0,__source:!0},me,be,V;V={};function Ke(e){if(S.call(e,\"ref\")){var r=Object.getOwnPropertyDescriptor(e,\"ref\").get;if(r&&r.isReactWarning)return!1}return e.ref!==void 0}function He(e){if(S.call(e,\"key\")){var r=Object.getOwnPropertyDescriptor(e,\"key\").get;if(r&&r.isReactWarning)return!1}return e.key!==void 0}function Qe(e,r){if(typeof e.ref==\"string\"&&N.current&&r&&N.current.stateNode!==r){var n=g(N.current.type);V[n]||(b('Component \"%s\" contains the string ref \"%s\". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',g(N.current.type),e.ref),V[n]=!0)}}function Je(e,r){{var n=function(){me||(me=!0,b(\"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",r))};n.isReactWarning=!0,Object.defineProperty(e,\"key\",{get:n,configurable:!0})}}function Ze(e,r){{var n=function(){be||(be=!0,b(\"%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",r))};n.isReactWarning=!0,Object.defineProperty(e,\"ref\",{get:n,configurable:!0})}}var er=function(e,r,n,a,s,u,i){var o={$$typeof:t,type:e,key:r,ref:n,props:i,_owner:u};return o._store={},Object.defineProperty(o._store,\"validated\",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(o,\"_self\",{configurable:!1,enumerable:!1,writable:!1,value:a}),Object.defineProperty(o,\"_source\",{configurable:!1,enumerable:!1,writable:!1,value:s}),Object.freeze&&(Object.freeze(o.props),Object.freeze(o)),o};function rr(e,r,n,a,s){{var u,i={},o=null,v=null;n!==void 0&&(fe(n),o=\"\"+n),He(r)&&(fe(r.key),o=\"\"+r.key),Ke(r)&&(v=r.ref,Qe(r,s));for(u in r)S.call(r,u)&&!Xe.hasOwnProperty(u)&&(i[u]=r[u]);if(e&&e.defaultProps){var c=e.defaultProps;for(u in c)i[u]===void 0&&(i[u]=c[u])}if(o||v){var f=typeof e==\"function\"?e.displayName||e.name||\"Unknown\":e;o&&Je(i,f),v&&Ze(i,f)}return er(e,o,v,s,a,N.current,i)}}var B=x.ReactCurrentOwner,ve=x.ReactDebugCurrentFrame;function R(e){if(e){var r=e._owner,n=P(e.type,e._source,r?r.type:null);ve.setExtraStackFrame(n)}else ve.setExtraStackFrame(null)}var L;L=!1;function q(e){return typeof e==\"object\"&&e!==null&&e.$$typeof===t}function pe(){{if(B.current){var e=g(B.current.type);if(e)return`\n\nCheck the render method of \\``+e+\"`.\"}return\"\"}}function nr(e){{if(e!==void 0){var r=e.fileName.replace(/^.*[\\\\\\/]/,\"\"),n=e.lineNumber;return`\n\nCheck your code at `+r+\":\"+n+\".\"}return\"\"}}var ge={};function ar(e){{var r=pe();if(!r){var n=typeof e==\"string\"?e:e.displayName||e.name;n&&(r=`\n\nCheck the top-level render call using <`+n+\">.\")}return r}}function _e(e,r){{if(!e._store||e._store.validated||e.key!=null)return;e._store.validated=!0;var n=ar(r);if(ge[n])return;ge[n]=!0;var a=\"\";e&&e._owner&&e._owner!==B.current&&(a=\" It was passed a child from \"+g(e._owner.type)+\".\"),R(e),b('Each child in a list should have a unique \"key\" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',n,a),R(null)}}function he(e,r){{if(typeof e!=\"object\")return;if(M(e))for(var n=0;n<e.length;n++){var a=e[n];q(a)&&_e(a,r)}else if(q(e))e._store&&(e._store.validated=!0);else if(e){var s=Oe(e);if(typeof s==\"function\"&&s!==e.entries)for(var u=s.call(e),i;!(i=u.next()).done;)q(i.value)&&_e(i.value,r)}}}function tr(e){{var r=e.type;if(r==null||typeof r==\"string\")return;var n;if(typeof r==\"function\")n=r.propTypes;else if(typeof r==\"object\"&&(r.$$typeof===C||r.$$typeof===A))n=r.propTypes;else return;if(n){var a=g(r);Le(n,e.props,\"prop\",a,e)}else if(r.PropTypes!==void 0&&!L){L=!0;var s=g(r);b(\"Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?\",s||\"Unknown\")}typeof r.getDefaultProps==\"function\"&&!r.getDefaultProps.isReactClassApproved&&b(\"getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.\")}}function or(e){{for(var r=Object.keys(e.props),n=0;n<r.length;n++){var a=r[n];if(a!==\"children\"&&a!==\"key\"){R(e),b(\"Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.\",a),R(null);break}}e.ref!==null&&(R(e),b(\"Invalid attribute `ref` supplied to `React.Fragment`.\"),R(null))}}function ir(e,r,n,a,s,u){{var i=Ie(e);if(!i){var o=\"\";(e===void 0||typeof e==\"object\"&&e!==null&&Object.keys(e).length===0)&&(o+=\" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.\");var v=nr(s);v?o+=v:o+=pe();var c;e===null?c=\"null\":M(e)?c=\"array\":e!==void 0&&e.$$typeof===t?(c=\"<\"+(g(e.type)||\"Unknown\")+\" />\",o=\" Did you accidentally export a JSX literal instead of a component?\"):c=typeof e,b(\"React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s\",c,o)}var f=rr(e,r,n,s,u);if(f==null)return f;if(i){var p=r.children;if(p!==void 0)if(a)if(M(p)){for(var w=0;w<p.length;w++)he(p[w],e);Object.freeze&&Object.freeze(p)}else b(\"React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.\");else he(p,e)}return e===y?or(f):tr(f),f}}var sr=ir;G.Fragment=y,G.jsxDEV=sr})()});var Ne=z((wr,Te)=>{\"use strict\";Te.exports=we()});var yr={};mr(yr,{default:()=>_r,frontmatter:()=>pr});var d=br(Ne()),pr={title:\"Base64\",publishedAt:\"2023-12-12\",summary:\"Como funciona e para que serve base64\",tags:[\"Code\"],shortTitle:\"Base64\"};function Ce(l){let t=Object.assign({p:\"p\",h3:\"h3\",pre:\"pre\",code:\"code\",span:\"span\"},l.components),{Alert:m}=t;return m||hr(\"Alert\",!0,\"15:1-17:9\"),(0,d.jsxDEV)(d.Fragment,{children:[(0,d.jsxDEV)(t.p,{children:\"Atualmente, estou trabalhando em uma API para transferir uma imagem capturada por um dispositivo m\\xF3vel e convert\\xEA-la para o formato base64. Aqui est\\xE1 tudo o que estudei sobre esse formato.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\",lineNumber:9,columnNumber:1},this),`\n`,(0,d.jsxDEV)(t.h3,{id:\"base-64\",children:\"Base 64\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\",lineNumber:11,columnNumber:1},this),`\n`,(0,d.jsxDEV)(t.p,{children:\"Basicamente, trata-se de uma maneira de enviar arquivos, como imagens e \\xE1udio, em um formato alfanum\\xE9rico especial que pode incluir letras, n\\xFAmeros e barras, tudo em uma \\xFAnica string. Essa abordagem \\xE9 r\\xE1pida para o envio de imagens, no meu caso, visando processamento mais \\xE1gil e economia de espa\\xE7o.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\",lineNumber:13,columnNumber:1},this),`\n`,(0,d.jsxDEV)(m,{type:\"warning\",children:(0,d.jsxDEV)(t.p,{children:\"\\xC0s vezes, o n\\xFAmero de caracteres pode exceder o limite de tamanho de uma vari\\xE1vel, j\\xE1 que uma string ocupa mais espa\\xE7o do que dados bin\\xE1rios. \\xC9 importante ter cuidado com o tamanho limite dos logs, por exemplo.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\",lineNumber:16,columnNumber:2},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\",lineNumber:15,columnNumber:1},this),`\n`,(0,d.jsxDEV)(t.p,{children:'Para ilustrar, imagine uma liga\\xE7\\xE3o telef\\xF4nica entre Bob e Ana. Ela deseja enviar uma imagem para Bob, mas n\\xE3o pode simplesmente descrever a imagem, pois isso levaria a uma c\\xF3pia imprecisa. Ela poderia converter todos os bits e enviar cada d\\xEDgito, mas isso demandaria muito tempo e recursos. Ent\\xE3o, decidem utilizar um m\\xE9todo de \"criptografia\", onde substituem os bits por caracteres.'},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\",lineNumber:19,columnNumber:1},this),`\n`,(0,d.jsxDEV)(t.p,{children:\"O base64 foi criado h\\xE1 muito tempo para resolver esse problema de convers\\xE3o de bits em caracteres. Um dos problemas era o e-mail, onde s\\xF3 era poss\\xEDvel enviar texto, n\\xE3o sendo permitido o envio de dados bin\\xE1rios, como imagens, v\\xEDdeos e arquivos.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\",lineNumber:21,columnNumber:1},this),`\n`,(0,d.jsxDEV)(t.p,{children:\"Exemplo de de imagem 5x5 em d\\xEDgitos bin\\xE1rios:\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\",lineNumber:23,columnNumber:1},this),`\n`,(0,d.jsxDEV)(t.pre,{className:\"language-text\",children:(0,d.jsxDEV)(t.code,{className:\"language-text code-highlight\",children:(0,d.jsxDEV)(t.span,{className:\"code-line\",children:`010001 110100 100101 000110 001110 000011 011101 100001 000000 010000 000000 000001 000000 001111 000000 000000 000000 001111 111100 000000 000000 000000 000000 000000 000000 000010 110000 000000 000000 000000 000000 000000 000000 010000 000000 000001 000000 000000 000000 000010 000000 100100 010000 000001 000000 000011 001011\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\"},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\",lineNumber:25,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\",lineNumber:25,columnNumber:1},this),`\n`,(0,d.jsxDEV)(t.p,{children:\"Imagem convertida para Base64 tenha esta apar\\xEAncia:\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\",lineNumber:28,columnNumber:1},this),`\n`,(0,d.jsxDEV)(t.pre,{className:\"language-text\",children:(0,d.jsxDEV)(t.code,{className:\"language-text code-highlight\",children:(0,d.jsxDEV)(t.span,{className:\"code-line\",children:`R0lGODdhAQABAPAAAP8AAAAAACwAAAAAAQABAAACAkQBADs\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\"},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\",lineNumber:30,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\",lineNumber:30,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\",lineNumber:1,columnNumber:1},this)}function gr(l={}){let{wrapper:t}=l.components||{};return t?(0,d.jsxDEV)(t,Object.assign({},l,{children:(0,d.jsxDEV)(Ce,l,void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\"},this)}),void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx\"},this):Ce(l)}var _r=gr;function hr(l,t,m){throw new Error(\"Expected \"+(t?\"component\":\"object\")+\" `\"+l+\"` to be defined: you likely forgot to import, pass, or provide it.\"+(m?\"\\nIt\\u2019s referenced in your code at `\"+m+\"` in `/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-dda62a03-6c32-4721-8858-2bfd9912331d.mdx`\":\"\"))}return vr(yr);})();\n/*! Bundled license information:\n\nreact/cjs/react-jsx-dev-runtime.development.js:\n  (**\n   * @license React\n   * react-jsx-dev-runtime.development.js\n   *\n   * Copyright (c) Facebook, Inc. and its affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n*/\n;return Component;"
    },
    "_id": "blog/base.mdx",
    "_raw": {
      "sourceFilePath": "blog/base.mdx",
      "sourceFileName": "base.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/base"
    },
    "type": "Post",
    "slug": "base",
    "image": "/blog/base/image.jpeg",
    "og": "/blog/base/image.jpeg"
  },
  {
    "title": "Aprendizagem Por Reforço: Uma introdução a DDPG",
    "summary": "Como modelo Actor-Critic funciona de uma maneira facil de entender",
    "publishedAt": "2023-08-01",
    "tags": [
      "Deep Reinforcement Learning",
      "Actor-Critic"
    ],
    "shortTitle": "DDPG",
    "body": {
      "raw": "\n## Método baseado em valor e método baseado em politica\n\nPara entender os conceitos de um agente baseado no método de valor, como o DQN (Deep Q-Network), e um agente baseado em política, \ncomo o REINFORCE, é fundamental compreender que ambos têm como objetivo utilizar o aprendizado por reforço \npara ensinar a um agente como realizar uma tarefa.\n\nUm agente baseado em valor avalia cada ação tomada em um determinado estado atribuindo um valor numérico a ela. \nEsse valor representa o quão vantajosa a ação é para alcançar o objetivo da tarefa. Se uma ação leva o agente mais \npróximo do objetivo, ela receberá uma recompensa maior. Por outro lado, se uma ação leva o agente para longe do \nobjetivo ou tem resultados indesejáveis, ela pode receber uma recompensa menor ou até mesmo uma recompensa negativa (penalização).\n\nJá um agente baseado em política depende de um “conselheiro” para orientar suas decisões. \nNesse caso, o “conselheiro” é uma pessoa experiente que já sabe como realizar a tarefa com sucesso. O agente, \npor sua vez, é como um iniciante que está aprendendo a realizar a tarefa e segue as sugestões do “conselheiro” para tomar suas ações.\n\n### Método Baseado em Política e Método Baseado em Valor\n\n> Vamos considerar uma pessoa que está tentando jogar tênis. Após uma partida, ela retorna para casa e reflete sobre o jogo,\nbuscando melhorar seus acertos e reduzir os erros cometidos durante a partida. No dia seguinte, ela leva em conta essas \nreflexões e tenta realizar as jogadas corretas. Essa abordagem é conhecida como método baseado em política. Agora, vamos imaginar o mesmo jogador entrando em uma nova partida, mas desta vez, em vez de se concentrar apenas em ações \ncorretas, ele tenta estimar o valor do jogo total a cada jogada. Quanto mais partidas ele joga, melhor ele se torna em estimar \no placar final do jogo. Essa abordagem é chamada de método baseado em valor.\n\nNa primeira analogia, a pessoa aprende a agir corretamente, buscando melhorar suas ações com base nas experiências passadas e \nnas reflexões sobre o jogo anterior. Já na segunda analogia, a pessoa tenta aprender a avaliar a qualidade de suas ações em \nrelação ao objetivo geral (placar final do jogo), utilizando a estimativa do valor do jogo em cada jogada.\n\n## Aproximação de Funções\n\nO método baseado em valor utiliza uma rede neural ou outra função de aproximação para estimar a função de valor, que \natribui uma nota para cada ação tomada em um determinado estado. Essa aproximação pode ser feita por meio de funções de \ntransferência como `Vπ(S)` (função de valor do estado), `Qπ(S, A)` (função de valor do estado-ação) e `Aπ(S, A)`\n(função de vantagem, medindo a vantagem de tomar uma ação A em relação a outras ações no estado S).\n\nGeralmente, quando um agente aprende uma função de valor, ele pode prosseguir para o aprendizado baseado em política com \nconhecimento prévio. Nesse ponto, o agente aprende a parametrizar a política e a otimizá-la diretamente. A política é \ngeralmente estocástica, denotada como `π(s|a)`, o que significa que ela introduz aleatoriedade na escolha das ações com base em probabilidades. Isso permite ao agente explorar diferentes ações e evitar ficar preso em um único comportamento. Por outro lado, uma política determinística, denotada como π(s), sempre escolhe a mesma ação para cada estado específico, sem envolver aleatoriedade na tomada de decisões.\n\n<Image rounded width={600} height={400} caption=\"Visualizations Diagram\" src=\"/blog/model/diagram.jpeg\" />\n\n### Viés e Variação\n\nO método Actor-Critic é uma abordagem que utiliza o agente baseado em valor para aprender a função de \nvalor e, em seguida, utiliza-a como linha de base para treinar o agente baseado em política.\n\nEssa técnica é adotada para resolver o problema do alto viés relacionado à simplificação ou suposições \nfeitas pelo modelo e alta variância relacionada ao agente aprender com novos dados em geral. Ao tentar \nestimar a função de valor ou política com base no retorno G (soma das recompensas obtidas pelo agente ao \nlongo de uma sequência de ações), há alto viés e variância.\n\nExistem duas formas de estimar o retorno. Uma delas é o método de Monte Carlo, onde o agente acumula a \nrecompensa ao longo de um episódio, considerando desconto ou não. Para calcular a função de valor, ele acumula \nvários episódios, em cada um deles computando a soma das recompensas, e depois calcula a média das estimativas.\n\nA outra forma é a estimativa por TD (diferença temporal), que leva em consideração tanto as recompensas \nimediatas quanto as estimativas de recompensas futuras.\n\n#### Analogia entre viés e variação\n\n> Imagine um jogador de futebol tentando acertar o gol. O viés é quando ele sempre chuta da mesma maneira, \ntornando-se previsível e fácil de defender. Já a variação é quando ele chuta de forma muito diferente a cada \ntentativa, o que torna seus chutes imprevisíveis e pouco precisos. Para ser um bom atacante, ele precisa \nencontrar um equilíbrio entre ser consistente (viés baixo) e ter chutes precisos (variação adequada), \naumentando suas chances de marcar gols com frequência. Da mesma forma, em aprendizado de máquina, encontrar \nesse equilíbrio entre viés e variação é fundamental para desenvolver modelos com bom desempenho e \ncapacidade de generalização.\n\nEstimativa de retorno TD (diferença temporal):\n\n`V(s) ← V(s) + α * [R + γ * V(s’) — V(s)]`\n​\n\nOnde:\n\n* V(s) é o valor estimado do estado atual “s” (a estimativa de quanta recompensa o \nagente espera obter a partir desse estado).\n\n* V(s’) é o valor estimado do próximo estado “s’” (a estimativa de quanta recompensa o \nagente espera obter a partir do próximo estado).\n\n* R é a recompensa imediata recebida pelo agente após tomar uma ação no estado “s”.\n\n* α (alfa) é a taxa de aprendizado, que controla o quanto a estimativa é atualizada a cada passo de aprendizado.\n\n* γ (gama) é o fator de desconto, que controla o peso das recompensas futuras em relação \nà recompensa imediata. Ele deve estar entre 0 e 1, onde 0 significa que o agente só se \nimporta com a recompensa imediata, e 1 significa que o agente considera todas as recompensas \nfuturas igualmente importantes.\n\nEstimativa de retorno Monte Carlo:\n\n`(G) = R₁ + γ * R₂ + γ² * R₃ + … + γ^(n-1) * Rₙ​`\n\nOnde:\n\n* G é o retorno total com desconto, ou seja, a soma das recompensas (R) ponderadas pelos fatores \nde desconto **γ** em cada passo do episódio.\n* **R₁, R₂, R₃, …, Rₙ** são as recompensas obtidas em cada um dos n passos do episódio.\n* **γ (gama)** é o fator de desconto, que controla o peso das recompensas futuras em relação à recompensa \nimediata. Ele deve estar entre 0 e 1, onde 0 significa que o agente só se importa com a recompensa \nimediata, e 1 significa que o agente considera todas as recompensas futuras igualmente importantes.\n\n## Estimativa de retorno​\nUma diferença entre o uso do método de Monte Carlo é que, no início, \nele retorna muitos valores aleatórios, pois em cada episódio as recompensas e ações são aleatórias. \nIsso faz com que demore mais para aprender, mas os valores obtidos são verdadeiros, pois o método de \nMonte Carlo não faz estimativas em cima de estimativas. Por outro lado, o método TD realiza estimativas \nem cima de estimativas, pois após uma etapa de estado, ação e recompensa, não há muito mais a saber. \nEsse método aprende mais rápido, mas pode demorar mais para convergir para um aprendizado verdadeiro. \nLogo, MC possui baixo viés, mas alta variância, e o TD possui alto viés, mas baixa variância.\n\nO método *Actor-Critic* utiliza o melhor dos dois mundos, empregando o método TD para estimar o retorno \ne o método MC para estimar a função de valor.\n\nAssim, utilizamos o TD como linha de base para treinar o agente, pois o principal foco é reduzir a variância, \nadicionando um pouco de viés. Claro que o método MC não possui viés, mas possui alta variância. \nNo caso do *Actor-Critic*, onde os estados são contínuos, ter uma alta variância pode causar ainda mais complexidade ao modelo, \npois os métodos baseados em política têm alta variância.\n\nDessa forma, os agentes baseados em *Actor-Critic* aprendem treinando e ajustando as probabilidades de boas e más \nações, assim como um ator sozinho, e utilizam um crítico para distinguir as boas das más ações. Esse método é \nmais estável do que os métodos baseados em valor e requer menos dados do que os baseados em políticas.\n\n## Modelo Actor-Critic​\n\n<Image rounded width={600} height={400} caption=\"Visualizations model Actor Critic\" src=\"/blog/model/image.jpeg\" />\n\nNo método Actor-Critic, são utilizadas duas redes neurais, uma para o crítico e outra para o ator. O crítico aprende a avaliar a função de valor do estado Vπ(S) utilizando o método TD (Diferença Temporal) como estimativa. Com base nas estimativas do crítico, a função de vantagem é calculada e usada para treinar o ator.\n\nA estrutra do modelo é a seguinte:\n\n* A rede do ator recebe o estado e retorna a probabilidade de cada ação **π(a|s; θπ)**.\n* A rede do critico recebe o estado e retorna a função de valor **V(s; θv)**.\n* O estado é passado para rede do ator e gera uma ação, que é passada para o ambiente.\n* Retorna o conjunto **(s, a, r, s’) -> (estado, ação, recompensa, proximo estado)**\n* Utilizando a estimativa TD que é **r + γ * V(s') - V(s)** para treinar o critico.\n* Em seguida, calcula a função de vantagem **A(s, a) = r + γ * V(s') - V(s)** e utiliza para treinar o ator.\n\n## DDPG (Deep Deterministic Policy Gradient) Paper​\nO DDPG (*Deep Deterministic Policy Gradient*) é uma extensão do DQN que permite lidar com tarefas contínuas, \npois utiliza uma rede neural para aproximar a função de valor de ação `Q(s, a)`.\n\nNo exemplo de modelo *Actor-Critic*, o ator retorna a probabilidade de cada ação, mas no DDPG, o ator retorna a \nação diretamente, ou seja, o ator escolhe diretamente a ação a ser tomada. Essa ação é calculada através de `argmax Q(s, a)`, \nou seja, selecionando a ação que maximiza a função de valor de ação `Q(s, a)`, tornando a política determinística. \nEnquanto isso, o crítico aprende a avaliar a função de valor da ação ideal usando a ação mais acreditada pelo ator, \nou seja, avalia como a ação selecionada pelo ator é vantajosa em relação às outras ações possíveis naquele estado. \nEsse cálculo é feito por `Q(s, U(s;θu); θq)`.\n\nPara treinar a rede crítica no DDPG, é utilizado o replay buffer para armazenar experiências passadas. \nO replay buffer é uma memória que permite ao algoritmo coletar e reutilizar experiências para o treinamento da rede de forma mais eficiente.\n\nAlém disso, o DDPG utiliza uma técnica conhecida como soft update para atualizar os pesos das redes alvo e regular, \ntanto para o ator quanto para o crítico. A rede alvo é atualizada com base nos pesos da rede regular, utilizando a \nseguinte fórmula: `θ_target = τ * θ_local + (1 - τ) * θ_target`. O parâmetro τ controla a taxa de atualização dos \npesos da rede alvo e é um hiperparâmetro importante para o treinamento do DDPG.",
      "code": "var Component=(()=>{var sa=Object.create;var S=Object.defineProperty;var da=Object.getOwnPropertyDescriptor;var ca=Object.getOwnPropertyNames;var ua=Object.getPrototypeOf,ma=Object.prototype.hasOwnProperty;var L=(d,a)=>()=>(a||d((a={exports:{}}).exports,a),a.exports),fa=(d,a)=>{for(var f in a)S(d,f,{get:a[f],enumerable:!0})},xe=(d,a,f,N)=>{if(a&&typeof a==\"object\"||typeof a==\"function\")for(let v of ca(a))!ma.call(d,v)&&v!==f&&S(d,v,{get:()=>a[v],enumerable:!(N=da(a,v))||N.enumerable});return d};var ba=(d,a,f)=>(f=d!=null?sa(ua(d)):{},xe(a||!d||!d.__esModule?S(f,\"default\",{value:d,enumerable:!0}):f,d)),pa=d=>xe(S({},\"__esModule\",{value:!0}),d);var De=L((ya,ye)=>{ye.exports=React});var we=L(B=>{\"use strict\";(function(){\"use strict\";var d=De(),a=Symbol.for(\"react.element\"),f=Symbol.for(\"react.portal\"),N=Symbol.for(\"react.fragment\"),v=Symbol.for(\"react.strict_mode\"),Q=Symbol.for(\"react.profiler\"),X=Symbol.for(\"react.provider\"),J=Symbol.for(\"react.context\"),R=Symbol.for(\"react.forward_ref\"),q=Symbol.for(\"react.suspense\"),z=Symbol.for(\"react.suspense_list\"),C=Symbol.for(\"react.memo\"),k=Symbol.for(\"react.lazy\"),Ce=Symbol.for(\"react.offscreen\"),K=Symbol.iterator,je=\"@@iterator\";function Te(e){if(e===null||typeof e!=\"object\")return null;var n=K&&e[K]||e[je];return typeof n==\"function\"?n:null}var y=d.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function b(e){{for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];Pe(\"error\",e,r)}}function Pe(e,n,r){{var i=y.ReactDebugCurrentFrame,s=i.getStackAddendum();s!==\"\"&&(n+=\"%s\",r=r.concat([s]));var c=r.map(function(t){return String(t)});c.unshift(\"Warning: \"+n),Function.prototype.apply.call(console[e],console,c)}}var Oe=!1,Ae=!1,Se=!1,qe=!1,ze=!1,H;H=Symbol.for(\"react.module.reference\");function ke(e){return!!(typeof e==\"string\"||typeof e==\"function\"||e===N||e===Q||ze||e===v||e===q||e===z||qe||e===Ce||Oe||Ae||Se||typeof e==\"object\"&&e!==null&&(e.$$typeof===k||e.$$typeof===C||e.$$typeof===X||e.$$typeof===J||e.$$typeof===R||e.$$typeof===H||e.getModuleId!==void 0))}function Fe(e,n,r){var i=e.displayName;if(i)return i;var s=n.displayName||n.name||\"\";return s!==\"\"?r+\"(\"+s+\")\":r}function Z(e){return e.displayName||\"Context\"}function h(e){if(e==null)return null;if(typeof e.tag==\"number\"&&b(\"Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue.\"),typeof e==\"function\")return e.displayName||e.name||null;if(typeof e==\"string\")return e;switch(e){case N:return\"Fragment\";case f:return\"Portal\";case Q:return\"Profiler\";case v:return\"StrictMode\";case q:return\"Suspense\";case z:return\"SuspenseList\"}if(typeof e==\"object\")switch(e.$$typeof){case J:var n=e;return Z(n)+\".Consumer\";case X:var r=e;return Z(r._context)+\".Provider\";case R:return Fe(e,e.render,\"ForwardRef\");case C:var i=e.displayName||null;return i!==null?i:h(e.type)||\"Memo\";case k:{var s=e,c=s._payload,t=s._init;try{return h(t(c))}catch{return null}}}return null}var x=Object.assign,E=0,ee,ae,ne,oe,re,ie,le;function te(){}te.__reactDisabledLog=!0;function Ve(){{if(E===0){ee=console.log,ae=console.info,ne=console.warn,oe=console.error,re=console.group,ie=console.groupCollapsed,le=console.groupEnd;var e={configurable:!0,enumerable:!0,value:te,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}E++}}function Ie(){{if(E--,E===0){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:x({},e,{value:ee}),info:x({},e,{value:ae}),warn:x({},e,{value:ne}),error:x({},e,{value:oe}),group:x({},e,{value:re}),groupCollapsed:x({},e,{value:ie}),groupEnd:x({},e,{value:le})})}E<0&&b(\"disabledDepth fell below zero. This is a bug in React. Please file an issue.\")}}var F=y.ReactCurrentDispatcher,V;function j(e,n,r){{if(V===void 0)try{throw Error()}catch(s){var i=s.stack.trim().match(/\\n( *(at )?)/);V=i&&i[1]||\"\"}return`\n`+V+e}}var I=!1,T;{var Me=typeof WeakMap==\"function\"?WeakMap:Map;T=new Me}function se(e,n){if(!e||I)return\"\";{var r=T.get(e);if(r!==void 0)return r}var i;I=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var c;c=F.current,F.current=null,Ve();try{if(n){var t=function(){throw Error()};if(Object.defineProperty(t.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(t,[])}catch(g){i=g}Reflect.construct(e,[],t)}else{try{t.call()}catch(g){i=g}e.call(t.prototype)}}else{try{throw Error()}catch(g){i=g}e()}}catch(g){if(g&&i&&typeof g.stack==\"string\"){for(var l=g.stack.split(`\n`),p=i.stack.split(`\n`),u=l.length-1,m=p.length-1;u>=1&&m>=0&&l[u]!==p[m];)m--;for(;u>=1&&m>=0;u--,m--)if(l[u]!==p[m]){if(u!==1||m!==1)do if(u--,m--,m<0||l[u]!==p[m]){var _=`\n`+l[u].replace(\" at new \",\" at \");return e.displayName&&_.includes(\"<anonymous>\")&&(_=_.replace(\"<anonymous>\",e.displayName)),typeof e==\"function\"&&T.set(e,_),_}while(u>=1&&m>=0);break}}}finally{I=!1,F.current=c,Ie(),Error.prepareStackTrace=s}var w=e?e.displayName||e.name:\"\",Ne=w?j(w):\"\";return typeof e==\"function\"&&T.set(e,Ne),Ne}function Ye(e,n,r){return se(e,!1)}function $e(e){var n=e.prototype;return!!(n&&n.isReactComponent)}function P(e,n,r){if(e==null)return\"\";if(typeof e==\"function\")return se(e,$e(e));if(typeof e==\"string\")return j(e);switch(e){case q:return j(\"Suspense\");case z:return j(\"SuspenseList\")}if(typeof e==\"object\")switch(e.$$typeof){case R:return Ye(e.render);case C:return P(e.type,n,r);case k:{var i=e,s=i._payload,c=i._init;try{return P(c(s),n,r)}catch{}}}return\"\"}var O=Object.prototype.hasOwnProperty,de={},ce=y.ReactDebugCurrentFrame;function A(e){if(e){var n=e._owner,r=P(e.type,e._source,n?n.type:null);ce.setExtraStackFrame(r)}else ce.setExtraStackFrame(null)}function We(e,n,r,i,s){{var c=Function.call.bind(O);for(var t in e)if(c(e,t)){var l=void 0;try{if(typeof e[t]!=\"function\"){var p=Error((i||\"React class\")+\": \"+r+\" type `\"+t+\"` is invalid; it must be a function, usually from the `prop-types` package, but received `\"+typeof e[t]+\"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.\");throw p.name=\"Invariant Violation\",p}l=e[t](n,t,i,r,null,\"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED\")}catch(u){l=u}l&&!(l instanceof Error)&&(A(s),b(\"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).\",i||\"React class\",r,t,typeof l),A(null)),l instanceof Error&&!(l.message in de)&&(de[l.message]=!0,A(s),b(\"Failed %s type: %s\",r,l.message),A(null))}}}var Ge=Array.isArray;function M(e){return Ge(e)}function Le(e){{var n=typeof Symbol==\"function\"&&Symbol.toStringTag,r=n&&e[Symbol.toStringTag]||e.constructor.name||\"Object\";return r}}function Be(e){try{return ue(e),!1}catch{return!0}}function ue(e){return\"\"+e}function me(e){if(Be(e))return b(\"The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.\",Le(e)),ue(e)}var U=y.ReactCurrentOwner,Qe={key:!0,ref:!0,__self:!0,__source:!0},fe,be,Y;Y={};function Xe(e){if(O.call(e,\"ref\")){var n=Object.getOwnPropertyDescriptor(e,\"ref\").get;if(n&&n.isReactWarning)return!1}return e.ref!==void 0}function Je(e){if(O.call(e,\"key\")){var n=Object.getOwnPropertyDescriptor(e,\"key\").get;if(n&&n.isReactWarning)return!1}return e.key!==void 0}function Ke(e,n){if(typeof e.ref==\"string\"&&U.current&&n&&U.current.stateNode!==n){var r=h(U.current.type);Y[r]||(b('Component \"%s\" contains the string ref \"%s\". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',h(U.current.type),e.ref),Y[r]=!0)}}function He(e,n){{var r=function(){fe||(fe=!0,b(\"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",n))};r.isReactWarning=!0,Object.defineProperty(e,\"key\",{get:r,configurable:!0})}}function Ze(e,n){{var r=function(){be||(be=!0,b(\"%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",n))};r.isReactWarning=!0,Object.defineProperty(e,\"ref\",{get:r,configurable:!0})}}var ea=function(e,n,r,i,s,c,t){var l={$$typeof:a,type:e,key:n,ref:r,props:t,_owner:c};return l._store={},Object.defineProperty(l._store,\"validated\",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(l,\"_self\",{configurable:!1,enumerable:!1,writable:!1,value:i}),Object.defineProperty(l,\"_source\",{configurable:!1,enumerable:!1,writable:!1,value:s}),Object.freeze&&(Object.freeze(l.props),Object.freeze(l)),l};function aa(e,n,r,i,s){{var c,t={},l=null,p=null;r!==void 0&&(me(r),l=\"\"+r),Je(n)&&(me(n.key),l=\"\"+n.key),Xe(n)&&(p=n.ref,Ke(n,s));for(c in n)O.call(n,c)&&!Qe.hasOwnProperty(c)&&(t[c]=n[c]);if(e&&e.defaultProps){var u=e.defaultProps;for(c in u)t[c]===void 0&&(t[c]=u[c])}if(l||p){var m=typeof e==\"function\"?e.displayName||e.name||\"Unknown\":e;l&&He(t,m),p&&Ze(t,m)}return ea(e,l,p,s,i,U.current,t)}}var $=y.ReactCurrentOwner,pe=y.ReactDebugCurrentFrame;function D(e){if(e){var n=e._owner,r=P(e.type,e._source,n?n.type:null);pe.setExtraStackFrame(r)}else pe.setExtraStackFrame(null)}var W;W=!1;function G(e){return typeof e==\"object\"&&e!==null&&e.$$typeof===a}function _e(){{if($.current){var e=h($.current.type);if(e)return`\n\nCheck the render method of \\``+e+\"`.\"}return\"\"}}function na(e){{if(e!==void 0){var n=e.fileName.replace(/^.*[\\\\\\/]/,\"\"),r=e.lineNumber;return`\n\nCheck your code at `+n+\":\"+r+\".\"}return\"\"}}var he={};function oa(e){{var n=_e();if(!n){var r=typeof e==\"string\"?e:e.displayName||e.name;r&&(n=`\n\nCheck the top-level render call using <`+r+\">.\")}return n}}function ge(e,n){{if(!e._store||e._store.validated||e.key!=null)return;e._store.validated=!0;var r=oa(n);if(he[r])return;he[r]=!0;var i=\"\";e&&e._owner&&e._owner!==$.current&&(i=\" It was passed a child from \"+h(e._owner.type)+\".\"),D(e),b('Each child in a list should have a unique \"key\" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',r,i),D(null)}}function ve(e,n){{if(typeof e!=\"object\")return;if(M(e))for(var r=0;r<e.length;r++){var i=e[r];G(i)&&ge(i,n)}else if(G(e))e._store&&(e._store.validated=!0);else if(e){var s=Te(e);if(typeof s==\"function\"&&s!==e.entries)for(var c=s.call(e),t;!(t=c.next()).done;)G(t.value)&&ge(t.value,n)}}}function ra(e){{var n=e.type;if(n==null||typeof n==\"string\")return;var r;if(typeof n==\"function\")r=n.propTypes;else if(typeof n==\"object\"&&(n.$$typeof===R||n.$$typeof===C))r=n.propTypes;else return;if(r){var i=h(n);We(r,e.props,\"prop\",i,e)}else if(n.PropTypes!==void 0&&!W){W=!0;var s=h(n);b(\"Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?\",s||\"Unknown\")}typeof n.getDefaultProps==\"function\"&&!n.getDefaultProps.isReactClassApproved&&b(\"getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.\")}}function ia(e){{for(var n=Object.keys(e.props),r=0;r<n.length;r++){var i=n[r];if(i!==\"children\"&&i!==\"key\"){D(e),b(\"Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.\",i),D(null);break}}e.ref!==null&&(D(e),b(\"Invalid attribute `ref` supplied to `React.Fragment`.\"),D(null))}}function la(e,n,r,i,s,c){{var t=ke(e);if(!t){var l=\"\";(e===void 0||typeof e==\"object\"&&e!==null&&Object.keys(e).length===0)&&(l+=\" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.\");var p=na(s);p?l+=p:l+=_e();var u;e===null?u=\"null\":M(e)?u=\"array\":e!==void 0&&e.$$typeof===a?(u=\"<\"+(h(e.type)||\"Unknown\")+\" />\",l=\" Did you accidentally export a JSX literal instead of a component?\"):u=typeof e,b(\"React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s\",u,l)}var m=aa(e,n,r,s,c);if(m==null)return m;if(t){var _=n.children;if(_!==void 0)if(i)if(M(_)){for(var w=0;w<_.length;w++)ve(_[w],e);Object.freeze&&Object.freeze(_)}else b(\"React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.\");else ve(_,e)}return e===N?ia(m):ra(m),m}}var ta=la;B.Fragment=N,B.jsxDEV=ta})()});var Ue=L((wa,Ee)=>{\"use strict\";Ee.exports=we()});var Na={};fa(Na,{default:()=>ga,frontmatter:()=>_a});var o=ba(Ue()),_a={title:\"Aprendizagem Por Refor\\xE7o: Uma introdu\\xE7\\xE3o a DDPG\",publishedAt:\"2023-08-01\",summary:\"Como modelo Actor-Critic funciona de uma maneira facil de entender\",tags:[\"Deep Reinforcement Learning\",\"Actor-Critic\"],shortTitle:\"DDPG\"};function Re(d){let a=Object.assign({h2:\"h2\",p:\"p\",h3:\"h3\",blockquote:\"blockquote\",code:\"code\",h4:\"h4\",ul:\"ul\",li:\"li\",strong:\"strong\",em:\"em\"},d.components),{Image:f}=a;return f||va(\"Image\",!0,\"47:1-47:107\"),(0,o.jsxDEV)(o.Fragment,{children:[(0,o.jsxDEV)(a.h2,{id:\"m\\xE9todo-baseado-em-valor-e-m\\xE9todo-baseado-em-politica\",children:\"M\\xE9todo baseado em valor e m\\xE9todo baseado em politica\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:9,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:`Para entender os conceitos de um agente baseado no m\\xE9todo de valor, como o DQN (Deep Q-Network), e um agente baseado em pol\\xEDtica,\ncomo o REINFORCE, \\xE9 fundamental compreender que ambos t\\xEAm como objetivo utilizar o aprendizado por refor\\xE7o\npara ensinar a um agente como realizar uma tarefa.`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:11,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:`Um agente baseado em valor avalia cada a\\xE7\\xE3o tomada em um determinado estado atribuindo um valor num\\xE9rico a ela.\nEsse valor representa o qu\\xE3o vantajosa a a\\xE7\\xE3o \\xE9 para alcan\\xE7ar o objetivo da tarefa. Se uma a\\xE7\\xE3o leva o agente mais\npr\\xF3ximo do objetivo, ela receber\\xE1 uma recompensa maior. Por outro lado, se uma a\\xE7\\xE3o leva o agente para longe do\nobjetivo ou tem resultados indesej\\xE1veis, ela pode receber uma recompensa menor ou at\\xE9 mesmo uma recompensa negativa (penaliza\\xE7\\xE3o).`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:15,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:`J\\xE1 um agente baseado em pol\\xEDtica depende de um \\u201Cconselheiro\\u201D para orientar suas decis\\xF5es.\nNesse caso, o \\u201Cconselheiro\\u201D \\xE9 uma pessoa experiente que j\\xE1 sabe como realizar a tarefa com sucesso. O agente,\npor sua vez, \\xE9 como um iniciante que est\\xE1 aprendendo a realizar a tarefa e segue as sugest\\xF5es do \\u201Cconselheiro\\u201D para tomar suas a\\xE7\\xF5es.`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:20,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.h3,{id:\"m\\xE9todo-baseado-em-pol\\xEDtica-e-m\\xE9todo-baseado-em-valor\",children:\"M\\xE9todo Baseado em Pol\\xEDtica e M\\xE9todo Baseado em Valor\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:24,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.blockquote,{children:[`\n`,(0,o.jsxDEV)(a.p,{children:`Vamos considerar uma pessoa que est\\xE1 tentando jogar t\\xEAnis. Ap\\xF3s uma partida, ela retorna para casa e reflete sobre o jogo,\nbuscando melhorar seus acertos e reduzir os erros cometidos durante a partida. No dia seguinte, ela leva em conta essas\nreflex\\xF5es e tenta realizar as jogadas corretas. Essa abordagem \\xE9 conhecida como m\\xE9todo baseado em pol\\xEDtica. Agora, vamos imaginar o mesmo jogador entrando em uma nova partida, mas desta vez, em vez de se concentrar apenas em a\\xE7\\xF5es\ncorretas, ele tenta estimar o valor do jogo total a cada jogada. Quanto mais partidas ele joga, melhor ele se torna em estimar\no placar final do jogo. Essa abordagem \\xE9 chamada de m\\xE9todo baseado em valor.`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:26,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:26,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:`Na primeira analogia, a pessoa aprende a agir corretamente, buscando melhorar suas a\\xE7\\xF5es com base nas experi\\xEAncias passadas e\nnas reflex\\xF5es sobre o jogo anterior. J\\xE1 na segunda analogia, a pessoa tenta aprender a avaliar a qualidade de suas a\\xE7\\xF5es em\nrela\\xE7\\xE3o ao objetivo geral (placar final do jogo), utilizando a estimativa do valor do jogo em cada jogada.`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:32,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.h2,{id:\"aproxima\\xE7\\xE3o-de-fun\\xE7\\xF5es\",children:\"Aproxima\\xE7\\xE3o de Fun\\xE7\\xF5es\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:36,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:[`O m\\xE9todo baseado em valor utiliza uma rede neural ou outra fun\\xE7\\xE3o de aproxima\\xE7\\xE3o para estimar a fun\\xE7\\xE3o de valor, que\natribui uma nota para cada a\\xE7\\xE3o tomada em um determinado estado. Essa aproxima\\xE7\\xE3o pode ser feita por meio de fun\\xE7\\xF5es de\ntransfer\\xEAncia como `,(0,o.jsxDEV)(a.code,{children:\"V\\u03C0(S)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:40,columnNumber:20},this),\" (fun\\xE7\\xE3o de valor do estado), \",(0,o.jsxDEV)(a.code,{children:\"Q\\u03C0(S, A)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:40,columnNumber:57},this),\" (fun\\xE7\\xE3o de valor do estado-a\\xE7\\xE3o) e \",(0,o.jsxDEV)(a.code,{children:\"A\\u03C0(S, A)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:40,columnNumber:103},this),`\n(fun\\xE7\\xE3o de vantagem, medindo a vantagem de tomar uma a\\xE7\\xE3o A em rela\\xE7\\xE3o a outras a\\xE7\\xF5es no estado S).`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:38,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:[`Geralmente, quando um agente aprende uma fun\\xE7\\xE3o de valor, ele pode prosseguir para o aprendizado baseado em pol\\xEDtica com\nconhecimento pr\\xE9vio. Nesse ponto, o agente aprende a parametrizar a pol\\xEDtica e a otimiz\\xE1-la diretamente. A pol\\xEDtica \\xE9\ngeralmente estoc\\xE1stica, denotada como `,(0,o.jsxDEV)(a.code,{children:\"\\u03C0(s|a)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:45,columnNumber:39},this),\", o que significa que ela introduz aleatoriedade na escolha das a\\xE7\\xF5es com base em probabilidades. Isso permite ao agente explorar diferentes a\\xE7\\xF5es e evitar ficar preso em um \\xFAnico comportamento. Por outro lado, uma pol\\xEDtica determin\\xEDstica, denotada como \\u03C0(s), sempre escolhe a mesma a\\xE7\\xE3o para cada estado espec\\xEDfico, sem envolver aleatoriedade na tomada de decis\\xF5es.\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:43,columnNumber:1},this),`\n`,(0,o.jsxDEV)(f,{rounded:!0,width:600,height:400,caption:\"Visualizations Diagram\",src:\"/blog/model/diagram.jpeg\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:47,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.h3,{id:\"vi\\xE9s-e-varia\\xE7\\xE3o\",children:\"Vi\\xE9s e Varia\\xE7\\xE3o\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:49,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:`O m\\xE9todo Actor-Critic \\xE9 uma abordagem que utiliza o agente baseado em valor para aprender a fun\\xE7\\xE3o de\nvalor e, em seguida, utiliza-a como linha de base para treinar o agente baseado em pol\\xEDtica.`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:51,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:`Essa t\\xE9cnica \\xE9 adotada para resolver o problema do alto vi\\xE9s relacionado \\xE0 simplifica\\xE7\\xE3o ou suposi\\xE7\\xF5es\nfeitas pelo modelo e alta vari\\xE2ncia relacionada ao agente aprender com novos dados em geral. Ao tentar\nestimar a fun\\xE7\\xE3o de valor ou pol\\xEDtica com base no retorno G (soma das recompensas obtidas pelo agente ao\nlongo de uma sequ\\xEAncia de a\\xE7\\xF5es), h\\xE1 alto vi\\xE9s e vari\\xE2ncia.`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:54,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:`Existem duas formas de estimar o retorno. Uma delas \\xE9 o m\\xE9todo de Monte Carlo, onde o agente acumula a\nrecompensa ao longo de um epis\\xF3dio, considerando desconto ou n\\xE3o. Para calcular a fun\\xE7\\xE3o de valor, ele acumula\nv\\xE1rios epis\\xF3dios, em cada um deles computando a soma das recompensas, e depois calcula a m\\xE9dia das estimativas.`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:59,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:`A outra forma \\xE9 a estimativa por TD (diferen\\xE7a temporal), que leva em considera\\xE7\\xE3o tanto as recompensas\nimediatas quanto as estimativas de recompensas futuras.`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:63,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.h4,{id:\"analogia-entre-vi\\xE9s-e-varia\\xE7\\xE3o\",children:\"Analogia entre vi\\xE9s e varia\\xE7\\xE3o\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:66,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.blockquote,{children:[`\n`,(0,o.jsxDEV)(a.p,{children:`Imagine um jogador de futebol tentando acertar o gol. O vi\\xE9s \\xE9 quando ele sempre chuta da mesma maneira,\ntornando-se previs\\xEDvel e f\\xE1cil de defender. J\\xE1 a varia\\xE7\\xE3o \\xE9 quando ele chuta de forma muito diferente a cada\ntentativa, o que torna seus chutes imprevis\\xEDveis e pouco precisos. Para ser um bom atacante, ele precisa\nencontrar um equil\\xEDbrio entre ser consistente (vi\\xE9s baixo) e ter chutes precisos (varia\\xE7\\xE3o adequada),\naumentando suas chances de marcar gols com frequ\\xEAncia. Da mesma forma, em aprendizado de m\\xE1quina, encontrar\nesse equil\\xEDbrio entre vi\\xE9s e varia\\xE7\\xE3o \\xE9 fundamental para desenvolver modelos com bom desempenho e\ncapacidade de generaliza\\xE7\\xE3o.`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:68,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:68,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:\"Estimativa de retorno TD (diferen\\xE7a temporal):\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:76,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:[(0,o.jsxDEV)(a.code,{children:\"V(s) \\u2190 V(s) + \\u03B1 * [R + \\u03B3 * V(s\\u2019) \\u2014 V(s)]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:78,columnNumber:1},this),`\n\\u200B`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:78,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:\"Onde:\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:81,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.ul,{children:[`\n`,(0,o.jsxDEV)(a.li,{children:[`\n`,(0,o.jsxDEV)(a.p,{children:`V(s) \\xE9 o valor estimado do estado atual \\u201Cs\\u201D (a estimativa de quanta recompensa o\nagente espera obter a partir desse estado).`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:83,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:83,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.li,{children:[`\n`,(0,o.jsxDEV)(a.p,{children:`V(s\\u2019) \\xE9 o valor estimado do pr\\xF3ximo estado \\u201Cs\\u2019\\u201D (a estimativa de quanta recompensa o\nagente espera obter a partir do pr\\xF3ximo estado).`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:86,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:86,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.li,{children:[`\n`,(0,o.jsxDEV)(a.p,{children:\"R \\xE9 a recompensa imediata recebida pelo agente ap\\xF3s tomar uma a\\xE7\\xE3o no estado \\u201Cs\\u201D.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:89,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:89,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.li,{children:[`\n`,(0,o.jsxDEV)(a.p,{children:\"\\u03B1 (alfa) \\xE9 a taxa de aprendizado, que controla o quanto a estimativa \\xE9 atualizada a cada passo de aprendizado.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:91,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:91,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.li,{children:[`\n`,(0,o.jsxDEV)(a.p,{children:`\\u03B3 (gama) \\xE9 o fator de desconto, que controla o peso das recompensas futuras em rela\\xE7\\xE3o\n\\xE0 recompensa imediata. Ele deve estar entre 0 e 1, onde 0 significa que o agente s\\xF3 se\nimporta com a recompensa imediata, e 1 significa que o agente considera todas as recompensas\nfuturas igualmente importantes.`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:93,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:93,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:83,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:\"Estimativa de retorno Monte Carlo:\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:98,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:(0,o.jsxDEV)(a.code,{children:\"(G) = R\\u2081 + \\u03B3 * R\\u2082 + \\u03B3\\xB2 * R\\u2083 + \\u2026 + \\u03B3^(n-1) * R\\u2099\\u200B\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:100,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:100,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:\"Onde:\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:102,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.ul,{children:[`\n`,(0,o.jsxDEV)(a.li,{children:[`G \\xE9 o retorno total com desconto, ou seja, a soma das recompensas (R) ponderadas pelos fatores\nde desconto `,(0,o.jsxDEV)(a.strong,{children:\"\\u03B3\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:105,columnNumber:13},this),\" em cada passo do epis\\xF3dio.\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:104,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.li,{children:[(0,o.jsxDEV)(a.strong,{children:\"R\\u2081, R\\u2082, R\\u2083, \\u2026, R\\u2099\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:106,columnNumber:3},this),\" s\\xE3o as recompensas obtidas em cada um dos n passos do epis\\xF3dio.\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:106,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.li,{children:[(0,o.jsxDEV)(a.strong,{children:\"\\u03B3 (gama)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:107,columnNumber:3},this),` \\xE9 o fator de desconto, que controla o peso das recompensas futuras em rela\\xE7\\xE3o \\xE0 recompensa\nimediata. Ele deve estar entre 0 e 1, onde 0 significa que o agente s\\xF3 se importa com a recompensa\nimediata, e 1 significa que o agente considera todas as recompensas futuras igualmente importantes.`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:107,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:104,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.h2,{id:\"estimativa-de-retorno\",children:\"Estimativa de retorno\\u200B\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:111,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:`Uma diferen\\xE7a entre o uso do m\\xE9todo de Monte Carlo \\xE9 que, no in\\xEDcio,\nele retorna muitos valores aleat\\xF3rios, pois em cada epis\\xF3dio as recompensas e a\\xE7\\xF5es s\\xE3o aleat\\xF3rias.\nIsso faz com que demore mais para aprender, mas os valores obtidos s\\xE3o verdadeiros, pois o m\\xE9todo de\nMonte Carlo n\\xE3o faz estimativas em cima de estimativas. Por outro lado, o m\\xE9todo TD realiza estimativas\nem cima de estimativas, pois ap\\xF3s uma etapa de estado, a\\xE7\\xE3o e recompensa, n\\xE3o h\\xE1 muito mais a saber.\nEsse m\\xE9todo aprende mais r\\xE1pido, mas pode demorar mais para convergir para um aprendizado verdadeiro.\nLogo, MC possui baixo vi\\xE9s, mas alta vari\\xE2ncia, e o TD possui alto vi\\xE9s, mas baixa vari\\xE2ncia.`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:112,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:[\"O m\\xE9todo \",(0,o.jsxDEV)(a.em,{children:\"Actor-Critic\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:120,columnNumber:10},this),` utiliza o melhor dos dois mundos, empregando o m\\xE9todo TD para estimar o retorno\ne o m\\xE9todo MC para estimar a fun\\xE7\\xE3o de valor.`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:120,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:[`Assim, utilizamos o TD como linha de base para treinar o agente, pois o principal foco \\xE9 reduzir a vari\\xE2ncia,\nadicionando um pouco de vi\\xE9s. Claro que o m\\xE9todo MC n\\xE3o possui vi\\xE9s, mas possui alta vari\\xE2ncia.\nNo caso do `,(0,o.jsxDEV)(a.em,{children:\"Actor-Critic\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:125,columnNumber:12},this),`, onde os estados s\\xE3o cont\\xEDnuos, ter uma alta vari\\xE2ncia pode causar ainda mais complexidade ao modelo,\npois os m\\xE9todos baseados em pol\\xEDtica t\\xEAm alta vari\\xE2ncia.`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:123,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:[\"Dessa forma, os agentes baseados em \",(0,o.jsxDEV)(a.em,{children:\"Actor-Critic\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:128,columnNumber:37},this),` aprendem treinando e ajustando as probabilidades de boas e m\\xE1s\na\\xE7\\xF5es, assim como um ator sozinho, e utilizam um cr\\xEDtico para distinguir as boas das m\\xE1s a\\xE7\\xF5es. Esse m\\xE9todo \\xE9\nmais est\\xE1vel do que os m\\xE9todos baseados em valor e requer menos dados do que os baseados em pol\\xEDticas.`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:128,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.h2,{id:\"modelo-actor-critic\",children:\"Modelo Actor-Critic\\u200B\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:132,columnNumber:1},this),`\n`,(0,o.jsxDEV)(f,{rounded:!0,width:600,height:400,caption:\"Visualizations model Actor Critic\",src:\"/blog/model/image.jpeg\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:134,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:\"No m\\xE9todo Actor-Critic, s\\xE3o utilizadas duas redes neurais, uma para o cr\\xEDtico e outra para o ator. O cr\\xEDtico aprende a avaliar a fun\\xE7\\xE3o de valor do estado V\\u03C0(S) utilizando o m\\xE9todo TD (Diferen\\xE7a Temporal) como estimativa. Com base nas estimativas do cr\\xEDtico, a fun\\xE7\\xE3o de vantagem \\xE9 calculada e usada para treinar o ator.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:136,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:\"A estrutra do modelo \\xE9 a seguinte:\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:138,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.ul,{children:[`\n`,(0,o.jsxDEV)(a.li,{children:[\"A rede do ator recebe o estado e retorna a probabilidade de cada a\\xE7\\xE3o \",(0,o.jsxDEV)(a.strong,{children:\"\\u03C0(a|s; \\u03B8\\u03C0)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:140,columnNumber:73},this),\".\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:140,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.li,{children:[\"A rede do critico recebe o estado e retorna a fun\\xE7\\xE3o de valor \",(0,o.jsxDEV)(a.strong,{children:\"V(s; \\u03B8v)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:141,columnNumber:65},this),\".\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:141,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.li,{children:\"O estado \\xE9 passado para rede do ator e gera uma a\\xE7\\xE3o, que \\xE9 passada para o ambiente.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:142,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.li,{children:[\"Retorna o conjunto \",(0,o.jsxDEV)(a.strong,{children:\"(s, a, r, s\\u2019) -> (estado, a\\xE7\\xE3o, recompensa, proximo estado)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:143,columnNumber:22},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:143,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.li,{children:[\"Utilizando a estimativa TD que \\xE9 \",(0,o.jsxDEV)(a.strong,{children:\"r + \\u03B3 * V(s') - V(s)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:144,columnNumber:36},this),\" para treinar o critico.\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:144,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.li,{children:[\"Em seguida, calcula a fun\\xE7\\xE3o de vantagem \",(0,o.jsxDEV)(a.strong,{children:\"A(s, a) = r + \\u03B3 * V(s') - V(s)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:145,columnNumber:44},this),\" e utiliza para treinar o ator.\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:145,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:140,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.h2,{id:\"ddpg-deep-deterministic-policy-gradient-paper\",children:\"DDPG (Deep Deterministic Policy Gradient) Paper\\u200B\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:147,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:[\"O DDPG (\",(0,o.jsxDEV)(a.em,{children:\"Deep Deterministic Policy Gradient\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:148,columnNumber:9},this),`) \\xE9 uma extens\\xE3o do DQN que permite lidar com tarefas cont\\xEDnuas,\npois utiliza uma rede neural para aproximar a fun\\xE7\\xE3o de valor de a\\xE7\\xE3o `,(0,o.jsxDEV)(a.code,{children:\"Q(s, a)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:149,columnNumber:71},this),\".\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:148,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:[\"No exemplo de modelo \",(0,o.jsxDEV)(a.em,{children:\"Actor-Critic\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:151,columnNumber:22},this),`, o ator retorna a probabilidade de cada a\\xE7\\xE3o, mas no DDPG, o ator retorna a\na\\xE7\\xE3o diretamente, ou seja, o ator escolhe diretamente a a\\xE7\\xE3o a ser tomada. Essa a\\xE7\\xE3o \\xE9 calculada atrav\\xE9s de `,(0,o.jsxDEV)(a.code,{children:\"argmax Q(s, a)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:152,columnNumber:109},this),`,\nou seja, selecionando a a\\xE7\\xE3o que maximiza a fun\\xE7\\xE3o de valor de a\\xE7\\xE3o `,(0,o.jsxDEV)(a.code,{children:\"Q(s, a)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:153,columnNumber:69},this),`, tornando a pol\\xEDtica determin\\xEDstica.\nEnquanto isso, o cr\\xEDtico aprende a avaliar a fun\\xE7\\xE3o de valor da a\\xE7\\xE3o ideal usando a a\\xE7\\xE3o mais acreditada pelo ator,\nou seja, avalia como a a\\xE7\\xE3o selecionada pelo ator \\xE9 vantajosa em rela\\xE7\\xE3o \\xE0s outras a\\xE7\\xF5es poss\\xEDveis naquele estado.\nEsse c\\xE1lculo \\xE9 feito por `,(0,o.jsxDEV)(a.code,{children:\"Q(s, U(s;\\u03B8u); \\u03B8q)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:156,columnNumber:26},this),\".\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:151,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:`Para treinar a rede cr\\xEDtica no DDPG, \\xE9 utilizado o replay buffer para armazenar experi\\xEAncias passadas.\nO replay buffer \\xE9 uma mem\\xF3ria que permite ao algoritmo coletar e reutilizar experi\\xEAncias para o treinamento da rede de forma mais eficiente.`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:158,columnNumber:1},this),`\n`,(0,o.jsxDEV)(a.p,{children:[`Al\\xE9m disso, o DDPG utiliza uma t\\xE9cnica conhecida como soft update para atualizar os pesos das redes alvo e regular,\ntanto para o ator quanto para o cr\\xEDtico. A rede alvo \\xE9 atualizada com base nos pesos da rede regular, utilizando a\nseguinte f\\xF3rmula: `,(0,o.jsxDEV)(a.code,{children:\"\\u03B8_target = \\u03C4 * \\u03B8_local + (1 - \\u03C4) * \\u03B8_target\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:163,columnNumber:19},this),`. O par\\xE2metro \\u03C4 controla a taxa de atualiza\\xE7\\xE3o dos\npesos da rede alvo e \\xE9 um hiperpar\\xE2metro importante para o treinamento do DDPG.`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:161,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\",lineNumber:1,columnNumber:1},this)}function ha(d={}){let{wrapper:a}=d.components||{};return a?(0,o.jsxDEV)(a,Object.assign({},d,{children:(0,o.jsxDEV)(Re,d,void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\"},this)}),void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx\"},this):Re(d)}var ga=ha;function va(d,a,f){throw new Error(\"Expected \"+(a?\"component\":\"object\")+\" `\"+d+\"` to be defined: you likely forgot to import, pass, or provide it.\"+(f?\"\\nIt\\u2019s referenced in your code at `\"+f+\"` in `/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-697851c1-1c3f-44ea-96d3-6169c1826b55.mdx`\":\"\"))}return pa(Na);})();\n/*! Bundled license information:\n\nreact/cjs/react-jsx-dev-runtime.development.js:\n  (**\n   * @license React\n   * react-jsx-dev-runtime.development.js\n   *\n   * Copyright (c) Facebook, Inc. and its affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n*/\n;return Component;"
    },
    "_id": "blog/model.mdx",
    "_raw": {
      "sourceFilePath": "blog/model.mdx",
      "sourceFileName": "model.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/model"
    },
    "type": "Post",
    "slug": "model",
    "image": "/blog/model/image.jpeg",
    "og": "/blog/model/image.jpeg"
  },
  {
    "title": "Vision Transformer (ViT) - Codificador do transformador",
    "summary": "Criando o codificador do transformador do ViT",
    "publishedAt": "2024-01-21",
    "tags": [
      "Pytorch",
      "ViT",
      "Transformer",
      "Vision"
    ],
    "shortTitle": "ViT",
    "body": {
      "raw": "\n## Atenção Multi-Cabeça (MSA)\n\nNa primeira imagem, em vermelho, está o MSA, o foco desse conteúdo. Em azul o Layer Normalization (LN) e em roxo\na conexão residual.\n\nPara simplificar o processo, o pytorch já tem uma implementação de MSA e de LN.\n\n* **Autoatenção multicabeças (MSA)** - `torch.nn.MultiheadAttention()`.\n* **Norma (LN ou LayerNorm)** - `torch.nn.LayerNorm()`.\n* **Conexão residual** - adicione a entrada a saída.\n\n### A camada LayerNorm (LN)\n\nNa documentação oficial do pytorch, a LN é mais utilizada em RNNs. Para o nosso caso o parâmetro principal é o \n`normalized_shape` que é o número de features da entrada, no caso do ViT é o número de patches que é 768.\n\n<Alert type=\"attention\">\nA normalização de camada ajuda o modelo a generalizar o modelo e treinar mais rápido.\n</Alert>\n\nUma analogia que me ajuda a entender é que a normalização é como fosse as escadas, se deixar todas com a mesma altura e \ncomprimento é muito mais fácil e rápido de subir, porem se foram cada degrau com um tamanho diferente, fica mais difícil \nde subir e mais lento. Assim, normalizar seria como deixar os dados com uma distribuição semelhante (médias e desvios padrão semelhante).\n\n<Image rounded width={800} height={600} caption=\"Consulta, Chave, Valor\" src=\"/blog/msa/chave.png\" />\n\nPara a entrada para o MSA, tem a consulta, chave e valor, esses três vetores são a parte fundamental do MSA. No pytorch, \nJá existe uma função chamada `torch.nn.MultiheadAttention()` que faz o MSA. Os parâmetros são:\n\n* `embed_dim`: dimensão de incorporação, no caso do ViT é 768.\n* `num_heads`: numero de cabeças (`multihead`), quanto mais cabeças, mais paralelismo.\n* `dropout`: probabilidade de dropout, no caso do ViT é 0.0.\n* `batch_first`: se a entrada e saída tem o batch na primeira dimensão, no caso do ViT é True.\n\n\n```python\n# 1. Criar uma instancia do MSA\nclass MultiheadSelfAttentionBlock(nn.Module):\n    \"\"\"Criacao do bloco multi-head self-attention (\"MSA block\").\n    \"\"\"\n    # 2. Inicialize o bloco com os parametros\n    def __init__(self,\n                 embedding_dim:int=768, # Camada de Embedding do ViT-Base -> (D)\n                 num_heads:int=12, # Numero de cabecas (h)\n                 attn_dropout:float=0): # No artigo nao utiliza dropout\n        super().__init__()\n\n        # 3. Criacao do Layer Normalization (LN)\n        self.layer_norm = nn.LayerNorm(normalized_shape=embedding_dim)\n\n        # 4. Criacao do Multihead Attention (MSA)\n        self.multihead_attn = nn.MultiheadAttention(embed_dim=embedding_dim,\n                                                    num_heads=num_heads,\n                                                    dropout=attn_dropout,\n                                                    batch_first=True) # nossa dimensão de lote vem primeiro?\n\n    # 5. Criacao do forward\n    def forward(self, x):\n        x = self.layer_norm(x)\n        attn_output, _ = self.multihead_attn(query=x,# consulta embeddings\n                                             key=x, # chave embeddings\n                                             value=x, # valor embeddings\n                                             need_weights=False) # precisamos dos pesos ou apenas das saídas da camada?\n        return attn_output\n```\n\nNesse código somente possui o MSA sem a conexão residual.\n\n```python\n# Create an instance of MSABlock\nmultihead_self_attention_block = MultiheadSelfAttentionBlock(embedding_dim=768, # from Table 1\n                                                             num_heads=12) # from Table 1\n\n# Passando o patch com o positional embedding no MSA\npatched_image_through_msa_block = multihead_self_attention_block(patch_and_position_embedding)\nprint(f\"Input shape of MSA block: {patch_and_position_embedding.shape}\")\nprint(f\"Output shape MSA block: {patched_image_through_msa_block.shape}\")\n```\n\nA entrada e a saída tem que ter a mesma dimensão e formado. Ou seja, os dados não mudam a medida que passam.\n\n### Perceptron Multicamadas (MLP)\n\nUm MLP pode se referir tem um significado muito genérico, pois se refere a um perceptron multicamadas, sendo uma rede neural.\nNo caso do ViT, um MLP se refere a uma camada linear seguida por uma não linear (GELU) e outra camada linear. O pytorch já possui \nambas as funções prontos para uso chamado `torch.nn.Linear()` e `torch.nn.GELU()`. Além disso Possui um Dropout que é uma \nregularização que ajuda a evitar overfitting.\n\n```python\n\nclass MLPBlock(nn.Module):\n    \"\"\"Criacao do bloco MLP.\n    \"\"\"\n    # 2. Inicialize o bloco com os parametros\n    def __init__(self,\n                 embedding_dim:int=768, # Tamanho do embedding de entrada\n                 mlp_size:int=3072, # Tamanho do MLP \n                 dropout:float=0.1): # Dropout \n        super().__init__()\n\n        # 3. (LN))\n        self.layer_norm = nn.LayerNorm(normalized_shape=embedding_dim)\n\n        # 4. (MLP)\n        self.mlp = nn.Sequential(\n            nn.Linear(in_features=embedding_dim,\n                      out_features=mlp_size),\n            nn.GELU(),\n            nn.Dropout(p=dropout),\n            nn.Linear(in_features=mlp_size, \n                      out_features=embedding_dim), \n            nn.Dropout(p=dropout) \n        )\n\n    # 5. Criacao do forward()\n    def forward(self, x):\n        x = self.layer_norm(x)\n        x = self.mlp(x)\n        return x\n```\n\n#### Codificador do transformador\n\nUm codificador é geralmente uma pilha de camadas que codifica uma entrada e gera uma saída numérica.\nNo caso do codificador, é uma séria de alternâncias entre MSA e MLP com uma conexão residual antes do MLP e antes do próximo\ncodificador.\n\nEm um pseudocódigo:\n```\nx_input -> MSA_block -> [MSA_block_output + x_input] -> MLP_block -> [MLP_block_output + MSA_block_output + x_input] -> ...\n```\n\n<Alert type=\"attention\">\nO modelo `resnet` tem esse nome por conta das conexões residuais. A conexão residual, resumidamente, ajuda a rede a aprender mais `profundamente`.\n</Alert>\n\n```python \n\nclass TransformerEncoderBlock(nn.Module):\n    \"\"\"Criacao do bloco do codificador do Transformer.\"\"\"\n    # 2. Inicializar os parametros\n    def __init__(self,\n                 embedding_dim:int=768, # tamanho do embedding\n                 num_heads:int=12, # numero de cabecas\n                 mlp_size:int=3072, # tamanho do MLP\n                 mlp_dropout:float=0.1, # Dropout do MLP\n                 attn_dropout:float=0): # Dropout do MSA\n        super().__init__()\n\n        # 3. MSA\n        self.msa_block = MultiheadSelfAttentionBlock(embedding_dim=embedding_dim,\n                                                     num_heads=num_heads,\n                                                     attn_dropout=attn_dropout)\n\n        # 4. MLP\n        self.mlp_block =  MLPBlock(embedding_dim=embedding_dim,\n                                   mlp_size=mlp_size,\n                                   dropout=mlp_dropout)\n\n    # 5. forward() =\n    def forward(self, x):\n\n        # 6. Conexao residual para MSA\n        x =  self.msa_block(x) + x\n\n        # 7. Conexao residual para MLP\n        x = self.mlp_block(x) + x\n\n        return x\n```\n\n<Image rounded width={800} height={600} caption=\"Bloco para código\" src=\"/blog/msa/code.png\" />\n\nPara ver a arquitetura toda:\n\n```python\ntransformer_encoder_block = TransformerEncoderBlock()\n\n# summary(model=transformer_encoder_block,\n#         input_size=(1, 197, 768), # (batch_size, num_patches, embedding_dimension)\n#         col_names=[\"input_size\", \"output_size\", \"num_params\", \"trainable\"],\n#         col_width=20,\n#         row_settings=[\"var_names\"])\n```\n\nO Pytorch tem toda essa função pronta, chamada `torch.nn.TransformerEncoderLayer()` que é até 2x mais rápido e menos propensa a erros.\n\n### Juntando tudo\n\nAgora que temos o MSA e o MLP, podemos juntar tudo para criar o ViT.\n\n```python\n# 1. Criar a classe ViT\nclass ViT(nn.Module):\n    # 2. Inicializar os pesos\n    def __init__(self,\n                 img_size:int=224, # Resolucao da imagem\n                 in_channels:int=3, # Numero de canais\n                 patch_size:int=16, # Tamanho do patch\n                 num_transformer_layers:int=12, # numeros de camadas do transformer\n                 embedding_dim:int=768, # Tamanho do embedding\n                 mlp_size:int=3072, # Tamanho do MLP\n                 num_heads:int=12, # Numero de cabecas\n                 attn_dropout:float=0, # Dropout do MSA\n                 mlp_dropout:float=0.1, # Dropout do MLP\n                 embedding_dropout:float=0.1, # Dropout do embedding\n                 num_classes:int=1000): # Numero de classes (1000 para o ImageNet)\n        super().__init__()\n\n        # 3. Certificar que o tamanho da imagem é divisivel pelo tamanho do patch\n        assert img_size % patch_size == 0, f\"Image size must be divisible by patch size, image size: {img_size}, patch size: {patch_size}.\"\n\n        # 4. Calcular o numero de patches\n        self.num_patches = (img_size * img_size) // patch_size**2\n\n        # 5. Criar o embedding de classe\n        self.class_embedding = nn.Parameter(data=torch.randn(1, 1, embedding_dim),\n                                            requires_grad=True)\n\n        # 6. Criar o positional embedding\n        self.position_embedding = nn.Parameter(data=torch.randn(1, self.num_patches+1, embedding_dim),\n                                               requires_grad=True)\n\n        # 7. Criar o dropout do embedding\n        self.embedding_dropout = nn.Dropout(p=embedding_dropout)\n\n        # 8. Criar o patch embedding\n        self.patch_embedding = PatchEmbedding(in_channels=in_channels,\n                                              patch_size=patch_size,\n                                              embedding_dim=embedding_dim)\n\n        # 9. Criar o codificador do transformer (TransformerEncoderBlock já está pronto no PyTorch)\n        # Note: O \"*\" significa \"todos\"\n        self.transformer_encoder = nn.Sequential(*[TransformerEncoderBlock(embedding_dim=embedding_dim,\n                                                                            num_heads=num_heads,\n                                                                            mlp_size=mlp_size,\n                                                                            mlp_dropout=mlp_dropout) for _ in range(num_transformer_layers)])\n\n        # 10. Criar o classificador\n        self.classifier = nn.Sequential(\n            nn.LayerNorm(normalized_shape=embedding_dim),\n            nn.Linear(in_features=embedding_dim,\n                      out_features=num_classes)\n        )\n\n    # 11. forward() \n    def forward(self, x):\n\n        # 12. Obter o tamanho do batch\n        batch_size = x.shape[0]\n\n        # 13. Criar a incorporacao de classe \n        class_token = self.class_embedding.expand(batch_size, -1, -1) # \"-1\" significa inferir a dimensão\n\n        # 14. Criar o patch embedding\n        x = self.patch_embedding(x)\n\n        # 15. Concatenar o class token e o patch embedding\n        x = torch.cat((class_token, x), dim=1)\n\n        # 16. Adicionar o positional embedding \n        x = self.position_embedding + x\n\n        # 17. Executar o dropout do embedding\n        x = self.embedding_dropout(x)\n\n        # 18. Passar o embedding pelo codificador do transformer \n        x = self.transformer_encoder(x)\n\n        # 19. Colocar o indice 0 (class token) no classificador\n        x = self.classifier(x[:, 0]) # executa cada amostra em um lote com índice 0\n\n        return x\n```\n\nPara testar o vit com um tensor aleatório de entrada:\n\n```python\nset_seeds()\n\n# Criacao de uma imagem aleatoria\nrandom_image_tensor = torch.randn(1, 3, 224, 224) # (batch_size, num_channels, height, width)\n\n# Criacao das classes\nvit = ViT(num_classes=3)\n\n# Passando a imagem pelo ViT\nvit(random_image_tensor)\n```\n\n```\ntensor([[-0,2377, 0,7360, 1,2137]], grad_fn=<AddmmBackward0>)\n```\nNo caso a saída tem que ser 3 valores, um para cada classe.\n\n*Continua ... 8.1*",
      "code": "var Component=(()=>{var re=Object.create;var M=Object.defineProperty;var me=Object.getOwnPropertyDescriptor;var be=Object.getOwnPropertyNames;var fe=Object.getPrototypeOf,ue=Object.prototype.hasOwnProperty;var W=(c,n)=>()=>(n||c((n={exports:{}}).exports,n),n.exports),_e=(c,n)=>{for(var f in n)M(c,f,{get:n[f],enumerable:!0})},wn=(c,n,f,p)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let g of be(n))!ue.call(c,g)&&g!==f&&M(c,g,{get:()=>n[g],enumerable:!(p=me(n,g))||p.enumerable});return c};var Ne=(c,n,f)=>(f=c!=null?re(fe(c)):{},wn(n||!c||!c.__esModule?M(f,\"default\",{value:c,enumerable:!0}):f,c)),pe=c=>wn(M({},\"__esModule\",{value:!0}),c);var Un=W((De,Dn)=>{Dn.exports=React});var kn=W(G=>{\"use strict\";(function(){\"use strict\";var c=Un(),n=Symbol.for(\"react.element\"),f=Symbol.for(\"react.portal\"),p=Symbol.for(\"react.fragment\"),g=Symbol.for(\"react.strict_mode\"),X=Symbol.for(\"react.profiler\"),K=Symbol.for(\"react.provider\"),H=Symbol.for(\"react.context\"),E=Symbol.for(\"react.forward_ref\"),O=Symbol.for(\"react.suspense\"),j=Symbol.for(\"react.suspense_list\"),T=Symbol.for(\"react.memo\"),L=Symbol.for(\"react.lazy\"),Pn=Symbol.for(\"react.offscreen\"),J=Symbol.iterator,Rn=\"@@iterator\";function Sn(a){if(a===null||typeof a!=\"object\")return null;var l=J&&a[J]||a[Rn];return typeof l==\"function\"?l:null}var w=c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function u(a){{for(var l=arguments.length,o=new Array(l>1?l-1:0),i=1;i<l;i++)o[i-1]=arguments[i];An(\"error\",a,o)}}function An(a,l,o){{var i=w.ReactDebugCurrentFrame,t=i.getStackAddendum();t!==\"\"&&(l+=\"%s\",o=o.concat([t]));var r=o.map(function(d){return String(d)});r.unshift(\"Warning: \"+l),Function.prototype.apply.call(console[a],console,r)}}var Mn=!1,On=!1,jn=!1,Ln=!1,zn=!1,Z;Z=Symbol.for(\"react.module.reference\");function Fn(a){return!!(typeof a==\"string\"||typeof a==\"function\"||a===p||a===X||zn||a===g||a===O||a===j||Ln||a===Pn||Mn||On||jn||typeof a==\"object\"&&a!==null&&(a.$$typeof===L||a.$$typeof===T||a.$$typeof===K||a.$$typeof===H||a.$$typeof===E||a.$$typeof===Z||a.getModuleId!==void 0))}function Vn(a,l,o){var i=a.displayName;if(i)return i;var t=l.displayName||l.name||\"\";return t!==\"\"?o+\"(\"+t+\")\":o}function Q(a){return a.displayName||\"Context\"}function h(a){if(a==null)return null;if(typeof a.tag==\"number\"&&u(\"Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue.\"),typeof a==\"function\")return a.displayName||a.name||null;if(typeof a==\"string\")return a;switch(a){case p:return\"Fragment\";case f:return\"Portal\";case X:return\"Profiler\";case g:return\"StrictMode\";case O:return\"Suspense\";case j:return\"SuspenseList\"}if(typeof a==\"object\")switch(a.$$typeof){case H:var l=a;return Q(l)+\".Consumer\";case K:var o=a;return Q(o._context)+\".Provider\";case E:return Vn(a,a.render,\"ForwardRef\");case T:var i=a.displayName||null;return i!==null?i:h(a.type)||\"Memo\";case L:{var t=a,r=t._payload,d=t._init;try{return h(d(r))}catch{return null}}}return null}var y=Object.assign,k=0,nn,en,an,ln,on,sn,dn;function tn(){}tn.__reactDisabledLog=!0;function In(){{if(k===0){nn=console.log,en=console.info,an=console.warn,ln=console.error,on=console.group,sn=console.groupCollapsed,dn=console.groupEnd;var a={configurable:!0,enumerable:!0,value:tn,writable:!0};Object.defineProperties(console,{info:a,log:a,warn:a,error:a,group:a,groupCollapsed:a,groupEnd:a})}k++}}function qn(){{if(k--,k===0){var a={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:y({},a,{value:nn}),info:y({},a,{value:en}),warn:y({},a,{value:an}),error:y({},a,{value:ln}),group:y({},a,{value:on}),groupCollapsed:y({},a,{value:sn}),groupEnd:y({},a,{value:dn})})}k<0&&u(\"disabledDepth fell below zero. This is a bug in React. Please file an issue.\")}}var z=w.ReactCurrentDispatcher,F;function C(a,l,o){{if(F===void 0)try{throw Error()}catch(t){var i=t.stack.trim().match(/\\n( *(at )?)/);F=i&&i[1]||\"\"}return`\n`+F+a}}var V=!1,P;{var Yn=typeof WeakMap==\"function\"?WeakMap:Map;P=new Yn}function cn(a,l){if(!a||V)return\"\";{var o=P.get(a);if(o!==void 0)return o}var i;V=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var r;r=z.current,z.current=null,In();try{if(l){var d=function(){throw Error()};if(Object.defineProperty(d.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(d,[])}catch(x){i=x}Reflect.construct(a,[],d)}else{try{d.call()}catch(x){i=x}a.call(d.prototype)}}else{try{throw Error()}catch(x){i=x}a()}}catch(x){if(x&&i&&typeof x.stack==\"string\"){for(var s=x.stack.split(`\n`),_=i.stack.split(`\n`),m=s.length-1,b=_.length-1;m>=1&&b>=0&&s[m]!==_[b];)b--;for(;m>=1&&b>=0;m--,b--)if(s[m]!==_[b]){if(m!==1||b!==1)do if(m--,b--,b<0||s[m]!==_[b]){var N=`\n`+s[m].replace(\" at new \",\" at \");return a.displayName&&N.includes(\"<anonymous>\")&&(N=N.replace(\"<anonymous>\",a.displayName)),typeof a==\"function\"&&P.set(a,N),N}while(m>=1&&b>=0);break}}}finally{V=!1,z.current=r,qn(),Error.prepareStackTrace=t}var U=a?a.displayName||a.name:\"\",yn=U?C(U):\"\";return typeof a==\"function\"&&P.set(a,yn),yn}function $n(a,l,o){return cn(a,!1)}function Bn(a){var l=a.prototype;return!!(l&&l.isReactComponent)}function R(a,l,o){if(a==null)return\"\";if(typeof a==\"function\")return cn(a,Bn(a));if(typeof a==\"string\")return C(a);switch(a){case O:return C(\"Suspense\");case j:return C(\"SuspenseList\")}if(typeof a==\"object\")switch(a.$$typeof){case E:return $n(a.render);case T:return R(a.type,l,o);case L:{var i=a,t=i._payload,r=i._init;try{return R(r(t),l,o)}catch{}}}return\"\"}var S=Object.prototype.hasOwnProperty,rn={},mn=w.ReactDebugCurrentFrame;function A(a){if(a){var l=a._owner,o=R(a.type,a._source,l?l.type:null);mn.setExtraStackFrame(o)}else mn.setExtraStackFrame(null)}function Wn(a,l,o,i,t){{var r=Function.call.bind(S);for(var d in a)if(r(a,d)){var s=void 0;try{if(typeof a[d]!=\"function\"){var _=Error((i||\"React class\")+\": \"+o+\" type `\"+d+\"` is invalid; it must be a function, usually from the `prop-types` package, but received `\"+typeof a[d]+\"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.\");throw _.name=\"Invariant Violation\",_}s=a[d](l,d,i,o,null,\"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED\")}catch(m){s=m}s&&!(s instanceof Error)&&(A(t),u(\"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).\",i||\"React class\",o,d,typeof s),A(null)),s instanceof Error&&!(s.message in rn)&&(rn[s.message]=!0,A(t),u(\"Failed %s type: %s\",o,s.message),A(null))}}}var Gn=Array.isArray;function I(a){return Gn(a)}function Xn(a){{var l=typeof Symbol==\"function\"&&Symbol.toStringTag,o=l&&a[Symbol.toStringTag]||a.constructor.name||\"Object\";return o}}function Kn(a){try{return bn(a),!1}catch{return!0}}function bn(a){return\"\"+a}function fn(a){if(Kn(a))return u(\"The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.\",Xn(a)),bn(a)}var v=w.ReactCurrentOwner,Hn={key:!0,ref:!0,__self:!0,__source:!0},un,_n,q;q={};function Jn(a){if(S.call(a,\"ref\")){var l=Object.getOwnPropertyDescriptor(a,\"ref\").get;if(l&&l.isReactWarning)return!1}return a.ref!==void 0}function Zn(a){if(S.call(a,\"key\")){var l=Object.getOwnPropertyDescriptor(a,\"key\").get;if(l&&l.isReactWarning)return!1}return a.key!==void 0}function Qn(a,l){if(typeof a.ref==\"string\"&&v.current&&l&&v.current.stateNode!==l){var o=h(v.current.type);q[o]||(u('Component \"%s\" contains the string ref \"%s\". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',h(v.current.type),a.ref),q[o]=!0)}}function ne(a,l){{var o=function(){un||(un=!0,u(\"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",l))};o.isReactWarning=!0,Object.defineProperty(a,\"key\",{get:o,configurable:!0})}}function ee(a,l){{var o=function(){_n||(_n=!0,u(\"%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",l))};o.isReactWarning=!0,Object.defineProperty(a,\"ref\",{get:o,configurable:!0})}}var ae=function(a,l,o,i,t,r,d){var s={$$typeof:n,type:a,key:l,ref:o,props:d,_owner:r};return s._store={},Object.defineProperty(s._store,\"validated\",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(s,\"_self\",{configurable:!1,enumerable:!1,writable:!1,value:i}),Object.defineProperty(s,\"_source\",{configurable:!1,enumerable:!1,writable:!1,value:t}),Object.freeze&&(Object.freeze(s.props),Object.freeze(s)),s};function le(a,l,o,i,t){{var r,d={},s=null,_=null;o!==void 0&&(fn(o),s=\"\"+o),Zn(l)&&(fn(l.key),s=\"\"+l.key),Jn(l)&&(_=l.ref,Qn(l,t));for(r in l)S.call(l,r)&&!Hn.hasOwnProperty(r)&&(d[r]=l[r]);if(a&&a.defaultProps){var m=a.defaultProps;for(r in m)d[r]===void 0&&(d[r]=m[r])}if(s||_){var b=typeof a==\"function\"?a.displayName||a.name||\"Unknown\":a;s&&ne(d,b),_&&ee(d,b)}return ae(a,s,_,t,i,v.current,d)}}var Y=w.ReactCurrentOwner,Nn=w.ReactDebugCurrentFrame;function D(a){if(a){var l=a._owner,o=R(a.type,a._source,l?l.type:null);Nn.setExtraStackFrame(o)}else Nn.setExtraStackFrame(null)}var $;$=!1;function B(a){return typeof a==\"object\"&&a!==null&&a.$$typeof===n}function pn(){{if(Y.current){var a=h(Y.current.type);if(a)return`\n\nCheck the render method of \\``+a+\"`.\"}return\"\"}}function oe(a){{if(a!==void 0){var l=a.fileName.replace(/^.*[\\\\\\/]/,\"\"),o=a.lineNumber;return`\n\nCheck your code at `+l+\":\"+o+\".\"}return\"\"}}var hn={};function ie(a){{var l=pn();if(!l){var o=typeof a==\"string\"?a:a.displayName||a.name;o&&(l=`\n\nCheck the top-level render call using <`+o+\">.\")}return l}}function xn(a,l){{if(!a._store||a._store.validated||a.key!=null)return;a._store.validated=!0;var o=ie(l);if(hn[o])return;hn[o]=!0;var i=\"\";a&&a._owner&&a._owner!==Y.current&&(i=\" It was passed a child from \"+h(a._owner.type)+\".\"),D(a),u('Each child in a list should have a unique \"key\" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',o,i),D(null)}}function gn(a,l){{if(typeof a!=\"object\")return;if(I(a))for(var o=0;o<a.length;o++){var i=a[o];B(i)&&xn(i,l)}else if(B(a))a._store&&(a._store.validated=!0);else if(a){var t=Sn(a);if(typeof t==\"function\"&&t!==a.entries)for(var r=t.call(a),d;!(d=r.next()).done;)B(d.value)&&xn(d.value,l)}}}function se(a){{var l=a.type;if(l==null||typeof l==\"string\")return;var o;if(typeof l==\"function\")o=l.propTypes;else if(typeof l==\"object\"&&(l.$$typeof===E||l.$$typeof===T))o=l.propTypes;else return;if(o){var i=h(l);Wn(o,a.props,\"prop\",i,a)}else if(l.PropTypes!==void 0&&!$){$=!0;var t=h(l);u(\"Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?\",t||\"Unknown\")}typeof l.getDefaultProps==\"function\"&&!l.getDefaultProps.isReactClassApproved&&u(\"getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.\")}}function de(a){{for(var l=Object.keys(a.props),o=0;o<l.length;o++){var i=l[o];if(i!==\"children\"&&i!==\"key\"){D(a),u(\"Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.\",i),D(null);break}}a.ref!==null&&(D(a),u(\"Invalid attribute `ref` supplied to `React.Fragment`.\"),D(null))}}function te(a,l,o,i,t,r){{var d=Fn(a);if(!d){var s=\"\";(a===void 0||typeof a==\"object\"&&a!==null&&Object.keys(a).length===0)&&(s+=\" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.\");var _=oe(t);_?s+=_:s+=pn();var m;a===null?m=\"null\":I(a)?m=\"array\":a!==void 0&&a.$$typeof===n?(m=\"<\"+(h(a.type)||\"Unknown\")+\" />\",s=\" Did you accidentally export a JSX literal instead of a component?\"):m=typeof a,u(\"React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s\",m,s)}var b=le(a,l,o,t,r);if(b==null)return b;if(d){var N=l.children;if(N!==void 0)if(i)if(I(N)){for(var U=0;U<N.length;U++)gn(N[U],a);Object.freeze&&Object.freeze(N)}else u(\"React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.\");else gn(N,a)}return a===p?de(b):se(b),b}}var ce=te;G.Fragment=p,G.jsxDEV=ce})()});var En=W((ke,vn)=>{\"use strict\";vn.exports=kn()});var ye={};_e(ye,{default:()=>ge,frontmatter:()=>he});var e=Ne(En()),he={title:\"Vision Transformer (ViT) - Codificador do transformador\",publishedAt:\"2024-01-21\",summary:\"Criando o codificador do transformador do ViT\",tags:[\"Pytorch\",\"ViT\",\"Transformer\",\"Vision\"],shortTitle:\"ViT\"};function Tn(c){let n=Object.assign({h2:\"h2\",p:\"p\",ul:\"ul\",li:\"li\",strong:\"strong\",code:\"code\",h3:\"h3\",pre:\"pre\",span:\"span\",h4:\"h4\",em:\"em\"},c.components),{Alert:f,Image:p}=n;return f||Cn(\"Alert\",!0,\"25:1-27:9\"),p||Cn(\"Image\",!0,\"33:1-33:102\"),(0,e.jsxDEV)(e.Fragment,{children:[(0,e.jsxDEV)(n.h2,{id:\"aten\\xE7\\xE3o-multi-cabe\\xE7a-msa\",children:\"Aten\\xE7\\xE3o Multi-Cabe\\xE7a (MSA)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:`Na primeira imagem, em vermelho, est\\xE1 o MSA, o foco desse conte\\xFAdo. Em azul o Layer Normalization (LN) e em roxo\na conex\\xE3o residual.`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:11,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Para simplificar o processo, o pytorch j\\xE1 tem uma implementa\\xE7\\xE3o de MSA e de LN.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:14,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(n.strong,{children:\"Autoaten\\xE7\\xE3o multicabe\\xE7as (MSA)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:3},this),\" - \",(0,e.jsxDEV)(n.code,{children:\"torch.nn.MultiheadAttention()\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:40},this),\".\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(n.strong,{children:\"Norma (LN ou LayerNorm)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:17,columnNumber:3},this),\" - \",(0,e.jsxDEV)(n.code,{children:\"torch.nn.LayerNorm()\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:17,columnNumber:33},this),\".\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:17,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(n.strong,{children:\"Conex\\xE3o residual\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:18,columnNumber:3},this),\" - adicione a entrada a sa\\xEDda.\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:18,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h3,{id:\"a-camada-layernorm-ln\",children:\"A camada LayerNorm (LN)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:20,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[`Na documenta\\xE7\\xE3o oficial do pytorch, a LN \\xE9 mais utilizada em RNNs. Para o nosso caso o par\\xE2metro principal \\xE9 o\n`,(0,e.jsxDEV)(n.code,{children:\"normalized_shape\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:23,columnNumber:1},this),\" que \\xE9 o n\\xFAmero de features da entrada, no caso do ViT \\xE9 o n\\xFAmero de patches que \\xE9 768.\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),`\n`,(0,e.jsxDEV)(f,{type:\"attention\",children:(0,e.jsxDEV)(n.p,{children:\"A normaliza\\xE7\\xE3o de camada ajuda o modelo a generalizar o modelo e treinar mais r\\xE1pido.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:26,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:`Uma analogia que me ajuda a entender \\xE9 que a normaliza\\xE7\\xE3o \\xE9 como fosse as escadas, se deixar todas com a mesma altura e\ncomprimento \\xE9 muito mais f\\xE1cil e r\\xE1pido de subir, porem se foram cada degrau com um tamanho diferente, fica mais dif\\xEDcil\nde subir e mais lento. Assim, normalizar seria como deixar os dados com uma distribui\\xE7\\xE3o semelhante (m\\xE9dias e desvios padr\\xE3o semelhante).`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),`\n`,(0,e.jsxDEV)(p,{rounded:!0,width:800,height:600,caption:\"Consulta, Chave, Valor\",src:\"/blog/msa/chave.png\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:33,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[`Para a entrada para o MSA, tem a consulta, chave e valor, esses tr\\xEAs vetores s\\xE3o a parte fundamental do MSA. No pytorch,\nJ\\xE1 existe uma fun\\xE7\\xE3o chamada `,(0,e.jsxDEV)(n.code,{children:\"torch.nn.MultiheadAttention()\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:36,columnNumber:30},this),\" que faz o MSA. Os par\\xE2metros s\\xE3o:\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:35,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(n.code,{children:\"embed_dim\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:38,columnNumber:3},this),\": dimens\\xE3o de incorpora\\xE7\\xE3o, no caso do ViT \\xE9 768.\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:38,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(n.code,{children:\"num_heads\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:39,columnNumber:3},this),\": numero de cabe\\xE7as (\",(0,e.jsxDEV)(n.code,{children:\"multihead\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:39,columnNumber:35},this),\"), quanto mais cabe\\xE7as, mais paralelismo.\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:39,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(n.code,{children:\"dropout\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:40,columnNumber:3},this),\": probabilidade de dropout, no caso do ViT \\xE9 0.0.\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:40,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(n.code,{children:\"batch_first\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:41,columnNumber:3},this),\": se a entrada e sa\\xEDda tem o batch na primeira dimens\\xE3o, no caso do ViT \\xE9 True.\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:41,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:38,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.pre,{className:\"language-python\",children:(0,e.jsxDEV)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 1. Criar uma instancia do MSA\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:1,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"class\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token class-name\",children:\"MultiheadSelfAttentionBlock\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),\"nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),\"Module\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token triple-quoted-string string\",children:`\"\"\"Criacao do bloco multi-head self-attention (\"MSA block\").\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:3,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token triple-quoted-string string\",children:'    \"\"\"'},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:3,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 2. Inicialize o bloco com os parametros\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:5,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"def\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token function\",children:\"__init__\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),\"self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"int\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"768\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Camada de Embedding do ViT-Base -> (D)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 num_heads\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"int\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"12\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Numero de cabecas (h)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 attn_dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"float\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"0\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# No artigo nao utiliza dropout\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"super\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),\"__init__\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 3. Criacao do Layer Normalization (LN)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:12,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),\"layer_norm \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),\" nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),\"LayerNorm\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),\"normalized_shape\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),\"embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 4. Criacao do Multihead Attention (MSA)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:15,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),\"multihead_attn \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),\" nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),\"MultiheadAttention\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),\"embed_dim\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),\"embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                                    num_heads\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:17,columnNumber:1},this),\"num_heads\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:17,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                                    dropout\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:18,columnNumber:1},this),\"attn_dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:18,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                                    batch_first\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token boolean\",children:\"True\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# nossa dimens\\xE3o de lote vem primeiro?\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 5. Criacao do forward\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:21,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"def\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token function\",children:\"forward\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),\"self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),\" x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        x \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:23,columnNumber:1},this),\" self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:23,columnNumber:1},this),\"layer_norm\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:23,columnNumber:1},this),\"x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:23,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        attn_output\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:24,columnNumber:1},this),\" _ \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:24,columnNumber:1},this),\" self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:24,columnNumber:1},this),\"multihead_attn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:24,columnNumber:1},this),\"query\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:24,columnNumber:1},this),\"x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:24,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# consulta embeddings\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:24,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                             key\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),\"x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# chave embeddings\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                             value\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:26,columnNumber:1},this),\"x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:26,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# valor embeddings\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:26,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                             need_weights\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:27,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token boolean\",children:\"False\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:27,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:27,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# precisamos dos pesos ou apenas das sa\\xEDdas da camada?\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:27,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"return\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:28,columnNumber:1},this),` attn_output\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:44,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:44,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Nesse c\\xF3digo somente possui o MSA sem a conex\\xE3o residual.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:75,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.pre,{className:\"language-python\",children:(0,e.jsxDEV)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Create an instance of MSABlock\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:1,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"multihead_self_attention_block \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),\" MultiheadSelfAttentionBlock\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),\"embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"768\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# from Table 1\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                                             num_heads\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:3,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"12\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:3,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:3,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# from Table 1\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:3,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Passando o patch com o positional embedding no MSA\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:5,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"patched_image_through_msa_block \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),\" multihead_self_attention_block\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),\"patch_and_position_embedding\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"print\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token string-interpolation\",children:[(0,e.jsxDEV)(n.span,{className:\"token string\",children:'f\"Input shape of MSA block: '},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token interpolation\",children:[(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"{\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),\"patch_and_position_embedding\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),\"shape\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"}\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token string\",children:'\"'},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"print\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token string-interpolation\",children:[(0,e.jsxDEV)(n.span,{className:\"token string\",children:'f\"Output shape MSA block: '},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token interpolation\",children:[(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"{\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),\"patched_image_through_msa_block\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),\"shape\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"}\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token string\",children:'\"'},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:77,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:77,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"A entrada e a sa\\xEDda tem que ter a mesma dimens\\xE3o e formado. Ou seja, os dados n\\xE3o mudam a medida que passam.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:88,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h3,{id:\"perceptron-multicamadas-mlp\",children:\"Perceptron Multicamadas (MLP)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:90,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[`Um MLP pode se referir tem um significado muito gen\\xE9rico, pois se refere a um perceptron multicamadas, sendo uma rede neural.\nNo caso do ViT, um MLP se refere a uma camada linear seguida por uma n\\xE3o linear (GELU) e outra camada linear. O pytorch j\\xE1 possui\nambas as fun\\xE7\\xF5es prontos para uso chamado `,(0,e.jsxDEV)(n.code,{children:\"torch.nn.Linear()\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:94,columnNumber:43},this),\" e \",(0,e.jsxDEV)(n.code,{children:\"torch.nn.GELU()\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:94,columnNumber:65},this),`. Al\\xE9m disso Possui um Dropout que \\xE9 uma\nregulariza\\xE7\\xE3o que ajuda a evitar overfitting.`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:92,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.pre,{className:\"language-python\",children:(0,e.jsxDEV)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"class\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token class-name\",children:\"MLPBlock\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),\"nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),\"Module\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token triple-quoted-string string\",children:`\"\"\"Criacao do bloco MLP.\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:3,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token triple-quoted-string string\",children:'    \"\"\"'},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:3,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 2. Inicialize o bloco com os parametros\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:5,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"def\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token function\",children:\"__init__\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),\"self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"int\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"768\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Tamanho do embedding de entrada\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 mlp_size\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"int\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"3072\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Tamanho do MLP \"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"float\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"0.1\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Dropout \"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"super\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),\"__init__\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 3. (LN))\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:12,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),\"layer_norm \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),\" nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),\"LayerNorm\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),\"normalized_shape\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),\"embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 4. (MLP)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:15,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),\"mlp \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),\" nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),\"Sequential\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"            nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:17,columnNumber:1},this),\"Linear\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:17,columnNumber:1},this),\"in_features\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:17,columnNumber:1},this),\"embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:17,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                      out_features\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:18,columnNumber:1},this),\"mlp_size\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:18,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:18,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"            nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),\"GELU\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"            nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:20,columnNumber:1},this),\"Dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:20,columnNumber:1},this),\"p\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:20,columnNumber:1},this),\"dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:20,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:20,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"            nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:21,columnNumber:1},this),\"Linear\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:21,columnNumber:1},this),\"in_features\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:21,columnNumber:1},this),\"mlp_size\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:21,columnNumber:1},this),` \n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                      out_features\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),\"embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),` \n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"            nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:23,columnNumber:1},this),\"Dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:23,columnNumber:1},this),\"p\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:23,columnNumber:1},this),\"dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:23,columnNumber:1},this),` \n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:24,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 5. Criacao do forward()\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:26,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"def\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:27,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token function\",children:\"forward\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:27,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:27,columnNumber:1},this),\"self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:27,columnNumber:1},this),\" x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:27,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:27,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        x \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:28,columnNumber:1},this),\" self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:28,columnNumber:1},this),\"layer_norm\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:28,columnNumber:1},this),\"x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:28,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        x \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),\" self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),\"mlp\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),\"x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"return\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:30,columnNumber:1},this),` x\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:97,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:97,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h4,{id:\"codificador-do-transformador\",children:\"Codificador do transformador\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:130,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:`Um codificador \\xE9 geralmente uma pilha de camadas que codifica uma entrada e gera uma sa\\xEDda num\\xE9rica.\nNo caso do codificador, \\xE9 uma s\\xE9ria de altern\\xE2ncias entre MSA e MLP com uma conex\\xE3o residual antes do MLP e antes do pr\\xF3ximo\ncodificador.`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:132,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Em um pseudoc\\xF3digo:\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:136,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.pre,{children:(0,e.jsxDEV)(n.code,{className:\"code-highlight\",children:(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`x_input -> MSA_block -> [MSA_block_output + x_input] -> MLP_block -> [MLP_block_output + MSA_block_output + x_input] -> ...\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:1,columnNumber:0},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:137,columnNumber:1},this),`\n`,(0,e.jsxDEV)(f,{type:\"attention\",children:(0,e.jsxDEV)(n.p,{children:[\"O modelo \",(0,e.jsxDEV)(n.code,{children:\"resnet\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:142,columnNumber:10},this),\" tem esse nome por conta das conex\\xF5es residuais. A conex\\xE3o residual, resumidamente, ajuda a rede a aprender mais \",(0,e.jsxDEV)(n.code,{children:\"profundamente\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:142,columnNumber:131},this),\".\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:142,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:141,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.pre,{className:\"language-python\",children:(0,e.jsxDEV)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"class\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token class-name\",children:\"TransformerEncoderBlock\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),\"nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),\"Module\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token triple-quoted-string string\",children:'\"\"\"Criacao do bloco do codificador do Transformer.\"\"\"'},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:3,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 2. Inicializar os parametros\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"def\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:5,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token function\",children:\"__init__\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:5,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:5,columnNumber:1},this),\"self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:5,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"int\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"768\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# tamanho do embedding\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 num_heads\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"int\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"12\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# numero de cabecas\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 mlp_size\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"int\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"3072\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# tamanho do MLP\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 mlp_dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"float\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"0.1\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Dropout do MLP\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 attn_dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"float\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"0\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Dropout do MSA\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"super\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:11,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:11,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:11,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:11,columnNumber:1},this),\"__init__\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:11,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:11,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 3. MSA\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:14,columnNumber:1},this),\"msa_block \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:14,columnNumber:1},this),\" MultiheadSelfAttentionBlock\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:14,columnNumber:1},this),\"embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:14,columnNumber:1},this),\"embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:14,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                                     num_heads\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:15,columnNumber:1},this),\"num_heads\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:15,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                                     attn_dropout\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),\"attn_dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 4. MLP\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:18,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),\"mlp_block \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),\"  MLPBlock\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),\"embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),\"embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                   mlp_size\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:20,columnNumber:1},this),\"mlp_size\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:20,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                   dropout\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:21,columnNumber:1},this),\"mlp_dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:21,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 5. forward() =\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:23,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"def\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:24,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token function\",children:\"forward\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:24,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:24,columnNumber:1},this),\"self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:24,columnNumber:1},this),\" x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:24,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:24,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 6. Conexao residual para MSA\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:26,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        x \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:27,columnNumber:1},this),\"  self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:27,columnNumber:1},this),\"msa_block\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:27,columnNumber:1},this),\"x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:27,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"+\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:27,columnNumber:1},this),` x\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 7. Conexao residual para MLP\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        x \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:30,columnNumber:1},this),\" self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:30,columnNumber:1},this),\"mlp_block\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:30,columnNumber:1},this),\"x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:30,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"+\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:30,columnNumber:1},this),` x\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"return\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:32,columnNumber:1},this),` x\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:145,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:145,columnNumber:1},this),`\n`,(0,e.jsxDEV)(p,{rounded:!0,width:800,height:600,caption:\"Bloco para c\\xF3digo\",src:\"/blog/msa/code.png\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:180,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Para ver a arquitetura toda:\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:182,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.pre,{className:\"language-python\",children:(0,e.jsxDEV)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"transformer_encoder_block \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:1,columnNumber:1},this),\" TransformerEncoderBlock\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:1,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:1,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# summary(model=transformer_encoder_block,\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:3,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"#         input_size=(1, 197, 768), # (batch_size, num_patches, embedding_dimension)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token comment\",children:'#         col_names=[\"input_size\", \"output_size\", \"num_params\", \"trainable\"],'},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:5,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"#         col_width=20,\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token comment\",children:'#         row_settings=[\"var_names\"])'},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:184,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:184,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"O Pytorch tem toda essa fun\\xE7\\xE3o pronta, chamada \",(0,e.jsxDEV)(n.code,{children:\"torch.nn.TransformerEncoderLayer()\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:194,columnNumber:48},this),\" que \\xE9 at\\xE9 2x mais r\\xE1pido e menos propensa a erros.\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:194,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h3,{id:\"juntando-tudo\",children:\"Juntando tudo\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:196,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Agora que temos o MSA e o MLP, podemos juntar tudo para criar o ViT.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:198,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.pre,{className:\"language-python\",children:(0,e.jsxDEV)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 1. Criar a classe ViT\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:1,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"class\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token class-name\",children:\"ViT\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),\"nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),\"Module\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:2,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 2. Inicializar os pesos\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:3,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"def\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token function\",children:\"__init__\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),\"self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 img_size\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:5,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"int\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:5,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:5,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"224\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:5,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:5,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Resolucao da imagem\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:5,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 in_channels\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"int\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"3\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Numero de canais\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 patch_size\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"int\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"16\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Tamanho do patch\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 num_transformer_layers\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"int\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"12\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# numeros de camadas do transformer\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:8,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"int\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"768\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Tamanho do embedding\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 mlp_size\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"int\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"3072\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Tamanho do MLP\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 num_heads\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:11,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"int\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:11,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:11,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"12\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:11,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:11,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Numero de cabecas\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:11,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 attn_dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:12,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"float\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:12,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:12,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"0\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:12,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:12,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Dropout do MSA\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:12,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 mlp_dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"float\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"0.1\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Dropout do MLP\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:13,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 embedding_dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:14,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"float\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:14,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:14,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"0.1\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:14,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:14,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Dropout do embedding\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:14,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                 num_classes\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:15,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"int\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:15,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:15,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"1000\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:15,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:15,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:15,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Numero de classes (1000 para o ImageNet)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:15,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"super\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),\"__init__\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:16,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 3. Certificar que o tamanho da imagem \\xE9 divisivel pelo tamanho do patch\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:18,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"assert\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),\" img_size \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"%\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),\" patch_size \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"==\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"0\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token string-interpolation\",children:[(0,e.jsxDEV)(n.span,{className:\"token string\",children:'f\"Image size must be divisible by patch size, image size: '},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token interpolation\",children:[(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"{\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),\"img_size\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"}\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token string\",children:\", patch size: \"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token interpolation\",children:[(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"{\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),\"patch_size\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"}\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token string\",children:'.\"'},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:19,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 4. Calcular o numero de patches\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:21,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),\"num_patches \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),\"img_size \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"*\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),\" img_size\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"//\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),\" patch_size\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"**\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"2\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:22,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 5. Criar o embedding de classe\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:24,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),\"class_embedding \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),\" nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),\"Parameter\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),\"data\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),\"torch\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),\"randn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"1\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"1\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),\" embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:25,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                            requires_grad\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:26,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token boolean\",children:\"True\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:26,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:26,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 6. Criar o positional embedding\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:28,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),\"position_embedding \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),\" nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),\"Parameter\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),\"data\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),\"torch\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),\"randn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"1\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),\" self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),\"num_patches\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"+\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"1\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),\" embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:29,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                               requires_grad\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:30,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token boolean\",children:\"True\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:30,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:30,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 7. Criar o dropout do embedding\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:32,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:33,columnNumber:1},this),\"embedding_dropout \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:33,columnNumber:1},this),\" nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:33,columnNumber:1},this),\"Dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:33,columnNumber:1},this),\"p\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:33,columnNumber:1},this),\"embedding_dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:33,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 8. Criar o patch embedding\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:35,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:36,columnNumber:1},this),\"patch_embedding \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:36,columnNumber:1},this),\" PatchEmbedding\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:36,columnNumber:1},this),\"in_channels\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:36,columnNumber:1},this),\"in_channels\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:36,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                              patch_size\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:37,columnNumber:1},this),\"patch_size\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:37,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                              embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:38,columnNumber:1},this),\"embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:38,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 9. Criar o codificador do transformer (TransformerEncoderBlock j\\xE1 est\\xE1 pronto no PyTorch)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:40,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:'# Note: O \"*\" significa \"todos\"'},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:41,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:42,columnNumber:1},this),\"transformer_encoder \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:42,columnNumber:1},this),\" nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:42,columnNumber:1},this),\"Sequential\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:42,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"*\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:42,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"[\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:42,columnNumber:1},this),\"TransformerEncoderBlock\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:42,columnNumber:1},this),\"embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:42,columnNumber:1},this),\"embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:42,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                                                            num_heads\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:43,columnNumber:1},this),\"num_heads\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:43,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                                                            mlp_size\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:44,columnNumber:1},this),\"mlp_size\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:44,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                                                                            mlp_dropout\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:45,columnNumber:1},this),\"mlp_dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:45,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"for\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:45,columnNumber:1},this),\" _ \",(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"in\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:45,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token builtin\",children:\"range\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:45,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:45,columnNumber:1},this),\"num_transformer_layers\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:45,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:45,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:45,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 10. Criar o classificador\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:47,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:48,columnNumber:1},this),\"classifier \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:48,columnNumber:1},this),\" nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:48,columnNumber:1},this),\"Sequential\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:48,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"            nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:49,columnNumber:1},this),\"LayerNorm\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:49,columnNumber:1},this),\"normalized_shape\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:49,columnNumber:1},this),\"embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:49,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:49,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"            nn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:50,columnNumber:1},this),\"Linear\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:50,columnNumber:1},this),\"in_features\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:50,columnNumber:1},this),\"embedding_dim\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:50,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"                      out_features\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:51,columnNumber:1},this),\"num_classes\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:51,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:52,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 11. forward() \"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:54,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"def\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:55,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token function\",children:\"forward\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:55,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:55,columnNumber:1},this),\"self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:55,columnNumber:1},this),\" x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:55,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:55,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 12. Obter o tamanho do batch\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:57,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        batch_size \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:58,columnNumber:1},this),\" x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:58,columnNumber:1},this),\"shape\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"[\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:58,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"0\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:58,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:58,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 13. Criar a incorporacao de classe \"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:60,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        class_token \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:61,columnNumber:1},this),\" self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:61,columnNumber:1},this),\"class_embedding\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:61,columnNumber:1},this),\"expand\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:61,columnNumber:1},this),\"batch_size\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:61,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"-\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:61,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"1\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:61,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:61,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"-\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:61,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"1\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:61,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:61,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:'# \"-1\" significa inferir a dimens\\xE3o'},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:61,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 14. Criar o patch embedding\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:63,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        x \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:64,columnNumber:1},this),\" self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:64,columnNumber:1},this),\"patch_embedding\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:64,columnNumber:1},this),\"x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:64,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 15. Concatenar o class token e o patch embedding\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:66,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        x \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:67,columnNumber:1},this),\" torch\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:67,columnNumber:1},this),\"cat\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:67,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:67,columnNumber:1},this),\"class_token\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:67,columnNumber:1},this),\" x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:67,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:67,columnNumber:1},this),\" dim\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:67,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"1\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:67,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:67,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 16. Adicionar o positional embedding \"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:69,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        x \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:70,columnNumber:1},this),\" self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:70,columnNumber:1},this),\"position_embedding \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"+\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:70,columnNumber:1},this),` x\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 17. Executar o dropout do embedding\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:72,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        x \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:73,columnNumber:1},this),\" self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:73,columnNumber:1},this),\"embedding_dropout\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:73,columnNumber:1},this),\"x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:73,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 18. Passar o embedding pelo codificador do transformer \"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:75,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        x \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:76,columnNumber:1},this),\" self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:76,columnNumber:1},this),\"transformer_encoder\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:76,columnNumber:1},this),\"x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:76,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# 19. Colocar o indice 0 (class token) no classificador\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:78,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        x \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:79,columnNumber:1},this),\" self\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:79,columnNumber:1},this),\"classifier\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:79,columnNumber:1},this),\"x\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"[\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:79,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:79,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:79,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"0\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:79,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:79,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:79,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# executa cada amostra em um lote com \\xEDndice 0\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:79,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxDEV)(n.span,{className:\"token keyword\",children:\"return\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:81,columnNumber:1},this),` x\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:200,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:200,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Para testar o vit com um tensor aleat\\xF3rio de entrada:\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:284,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.pre,{className:\"language-python\",children:(0,e.jsxDEV)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"set_seeds\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:1,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:1,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Criacao de uma imagem aleatoria\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:3,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"random_image_tensor \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),\" torch\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),\"randn\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"1\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"3\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"224\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"224\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),\" \",(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# (batch_size, num_channels, height, width)\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:4,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Criacao das classes\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:6,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"vit \",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),\" ViT\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),\"num_classes\",(0,e.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token number\",children:\"3\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:7,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[(0,e.jsxDEV)(n.span,{className:\"token comment\",children:\"# Passando a imagem pelo ViT\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:9,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this),(0,e.jsxDEV)(n.span,{className:\"code-line\",children:[\"vit\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),\"random_image_tensor\",(0,e.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:10,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:286,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:286,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.pre,{children:(0,e.jsxDEV)(n.code,{className:\"code-highlight\",children:(0,e.jsxDEV)(n.span,{className:\"code-line\",children:`tensor([[-0,2377, 0,7360, 1,2137]], grad_fn=<AddmmBackward0>)\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:1,columnNumber:0},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:299,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"No caso a sa\\xEDda tem que ser 3 valores, um para cada classe.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:302,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:(0,e.jsxDEV)(n.em,{children:\"Continua ... 8.1\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:304,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:304,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\",lineNumber:1,columnNumber:1},this)}function xe(c={}){let{wrapper:n}=c.components||{};return n?(0,e.jsxDEV)(n,Object.assign({},c,{children:(0,e.jsxDEV)(Tn,c,void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this)}),void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx\"},this):Tn(c)}var ge=xe;function Cn(c,n,f){throw new Error(\"Expected \"+(n?\"component\":\"object\")+\" `\"+c+\"` to be defined: you likely forgot to import, pass, or provide it.\"+(f?\"\\nIt\\u2019s referenced in your code at `\"+f+\"` in `/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-686228b1-ef64-467f-aa85-b2e49fb6d4dc.mdx`\":\"\"))}return pe(ye);})();\n/*! Bundled license information:\n\nreact/cjs/react-jsx-dev-runtime.development.js:\n  (**\n   * @license React\n   * react-jsx-dev-runtime.development.js\n   *\n   * Copyright (c) Facebook, Inc. and its affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n*/\n;return Component;"
    },
    "_id": "blog/msa.mdx",
    "_raw": {
      "sourceFilePath": "blog/msa.mdx",
      "sourceFileName": "msa.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/msa"
    },
    "type": "Post",
    "slug": "msa",
    "image": "/blog/msa/image.jpeg",
    "og": "/blog/msa/image.jpeg"
  },
  {
    "title": "Vision Transformer (ViT) - Patches",
    "summary": "Dividir os dados em patches e criar a classe, posição e incorporação de patches",
    "publishedAt": "2024-01-15",
    "tags": [
      "Pytorch",
      "ViT",
      "Transformer",
      "Vision"
    ],
    "shortTitle": "ViT",
    "body": {
      "raw": "\n## Equação 1: Dividir os dados em patches\n\n> Se puder dividir os dados de uma forma facil de enteder e boa de aprender, é provavel que o algoritmo tenha um maior desempenho com dados reais.\n\nPara começar primeiro precisa criar os embeddings de classe, posição e patch, Assim começando por uma incorporação de pacth.\n\n<Alert type=\"attention\">\n  Incorporação se refere a transformar os dados em um vetor (geralmente) de uma forma que o algoritmo consiga entender mais fácil.\n</Alert>\n\nAnalisando o artigo:\n\n* *D* tamanho do embeddings de patch.\n* Imagem com dimensão *H* x *W x C*.\n  * (*H* x *W*) - (altura, largura).\n  * *C* - numero de canais (RGB = 3).\n* Tamanho *N×(P^2⋅C)* da sequência de patch 2D.\n  * *(P, P)* - resolução da imagem em cada patch.\n  * *N = HW / P^2* numero resultante de patches que também serve como entrada para o MSA.\n\n<Image rounded width={600} height={400} caption=\"Visualização da transformação de imagem em patch\" src=\"/blog/patchs/patch.png\" />\n\n### Calculando manualmente utilizando Python\n\nUm exemplo de como calcular o número de patches de uma imagem com altura 224, largura 224 e patch de tamanho 16.\n\n```python\nheight = 224 # Altura\nwidth = 224 # Largura\ncolor_channels = 3 # Numero de canais\npatch_size = 16 # Ramanho do patch\n\n# Calculando N *(numero de patches)\nnumber_of_patches = int((height * width) / patch_size**2)\nprint(f\"Number of patches (N) with image height (H={height}), width (W={width}) and patch size (P={patch_size}): {number_of_patches}\")\n```\n\n```\nNumber of patches (N) with image height (H=224), width (W=224) and patch size (P=16): 196\n```\n\nAgora que temos o número de patches, precisa calcular o tamanho de vetor de cada patch.\n\n* **INPUT:** Imagem com dimensão *H* x *W x C*.\n* **OUTPUT:** Sequência de patch 2D com tamanho *N×(P^2⋅C)*.\n\n```python\n# input imagem shape\nembedding_layer_input_shape = (height, width, color_channels)\n\n# Output shape\nembedding_layer_output_shape = (number_of_patches, patch_size**2 * color_channels)\n\nprint(f\"Input shape (single 2D image): {embedding_layer_input_shape}\")\nprint(f\"Output shape (single 2D image flattened into patches): {embedding_layer_output_shape}\")\n```\n```\nInput shape (single 2D image): (224, 224, 3)\nOutput shape (single 2D image flattened into patches): (196, 768)\n```\n\n<Alert type=\"attention\">\nTodos os códigos se complementam!!\n</Alert>\n\n## Transformando uma imagem real em um patch\n\nA parte principal de replicar um artigo é criar partes menores (camadas), se concentrando na entrada e saída.\n\n```python\n# View single image\nplt.imshow(image.permute(1, 2, 0)) # ajustando a ordem dos canais\nplt.title(class_names[label])\nplt.axis(False);\n```\n\nPara começar do básico, mostrando somente a parte superior antes de fragmentar a imagem por inteiro.\n\n```python\n# Altere o formato da imagem para ser compatível com matplotlib (color_channels, height, width) -> (height, width, color_channels)\nimage_permuted = image.permute(1, 2, 0)\n\n# Índice para traçar a linha superior de pixels corrigidos\npatch_size = 16\nplt.figure(figsize=(patch_size, patch_size))\nplt.imshow(image_permuted[:patch_size, :, :]);\n```\n\nAgora que temos a linha superior da imagem, precisa dividir em patches.\n\n```python\n# Configure hiperparâmetros e certifique-se de que img_size e patch_size sejam compatíveis\nimg_size = 224\npatch_size = 16\nnum_patches = img_size/patch_size\nassert img_size % patch_size == 0, \"Image size must be divisible by patch size\"\nprint(f\"Number of patches per row: {num_patches}\\nPatch size: {patch_size} pixels x {patch_size} pixels\")\n\nfig, axs = plt.subplots(nrows=1,\n                        ncols=img_size // patch_size,\n                        figsize=(num_patches, num_patches),\n                        sharex=True,\n                        sharey=True)\n\nfor i, patch in enumerate(range(0, img_size, patch_size)):\n    axs[i].imshow(image_permuted[:patch_size, patch:patch+patch_size, :]); \n    axs[i].set_xlabel(i+1)\n    axs[i].set_xticks([])\n    axs[i].set_yticks([])\n```\n\n```\nNumber of patches per row: 14.0\nPatch size: 16 pixels x 16 pixels\n```\n\nAgora que fizemos para a parte superior vamos fazer para a imagem inteira.\n\n```python\n# Configure hiperparâmetros e certifique-se de que img_size e patch_size sejam compatíveis\nimg_size = 224\npatch_size = 16\nnum_patches = img_size/patch_size\nassert img_size % patch_size == 0, \"Image size must be divisible by patch size\"\nprint(f\"Number of patches per row: {num_patches}\\\n        \\nNumber of patches per column: {num_patches}\\\n        \\nTotal patches: {num_patches*num_patches}\\\n        \\nPatch size: {patch_size} pixels x {patch_size} pixels\")\n\n# Crie uma série de subtramas\nfig, axs = plt.subplots(nrows=img_size // patch_size, # precisa que int não flutue\n                        ncols=img_size // patch_size,\n                        figsize=(num_patches, num_patches),\n                        sharex=True,\n                        sharey=True)\n\n# Loop pela altura e largura da imagem\nfor i, patch_height in enumerate(range(0, img_size, patch_size)): # iterar pela altura\n    for j, patch_width in enumerate(range(0, img_size, patch_size)):# iterar pela largura\n\n        # Plote o patch da imagem permutada (image_permuted -> (Altura, Largura, Canais de cores))\n        axs[i, j].imshow(image_permuted[patch_height:patch_height+patch_size, # iterar pela altura\n                                        patch_width:patch_width+patch_size, # iterar pela largura\n                                        :]) #obtém todos os canais de cores\n\n        # Configure as informações do rótulo, remova as marcas para maior clareza e defina os rótulos para fora\n        axs[i, j].set_ylabel(i+1,\n                             rotation=\"horizontal\",\n                             horizontalalignment=\"right\",\n                             verticalalignment=\"center\")\n        axs[i, j].set_xlabel(j+1)\n        axs[i, j].set_xticks([])\n        axs[i, j].set_yticks([])\n        axs[i, j].label_outer()\n\n# Defina um supertítulo\nfig.suptitle(f\"{class_names[label]} -> Patchified\", fontsize=16)\nplt.show()\n```\n\n```\nNumber of patches per row: 14.0        \nNumber of patches per column: 14.0        \nTotal patches: 196.0        \nPatch size: 16 pixels x 16 pixels\n```\n\n### Criando patches de imagem com `torch.nn.Conv2d()`\n\nEssa incorporação de patches é o mesmo que utilizar `torch.nn.Conv2d()`, uma alternativa seria a entrada como formado de \nmapas de características (*pesos/ativações*) como na CNN.\n\n<Alert type=\"attention\">\nOu seja, podemos simplesmente utilizar um `kernel_size` e um `stripe` para criar os patches, que seria o mesmo, \ndo que fazer os `patch_size`.\n</Alert>\n\nNo exemplo do código, utiliza uma imagem 2D e convertemos em uma sequência de 1D de fragmentos 2D achatados.\n\nNo Pytorch podemos utilizar:\n\n* `torch.nn.Conv2d()` para fragmentar a imagem em uma sequência de mapas de características.\n* `torch.nn.flatten()` para achatá-los em uma sequência de vetores.\n\nPassamos como parâmetros `kernel_size` e `stride` com o mesmo valor de `patch_size` para obter o mesmo resultado.\nPara cada kernel convolucional de tamanho (patch_size, patch_size), e o `stripe` tera `patch_size` píxeis de tamanho.\n\n* `patch_size` = 16 -> Tamanho do patch\n* `kernel_size` = (patch_size, patch_size) -> altura e largura do kernel\n* `stride` = (patch_size) -> Tamanho dos píxeis\n\n<Image rounded width={600} height={400} caption=\"nn.Conv2d\" src=\"/blog/patchs/conv.png\" />\n\nAlém disso, definimos `in_channels=3`, pois são 3 canais de cores e `out_channels=768`, esse valor é o *D* da equação 1.\nEsse valor significa que cada imagem terá um vetor de incorporação de tamanho 768, para ser aprendido.\n\n```python\nfrom torch import nn\n\npatch_size=16\n\nconv2d = nn.Conv2d(in_channels=3, \n                   out_channels=768, \n                   kernel_size=patch_size,\n                   stride=patch_size,\n                   padding=0) # padding=0 -> sem padding, ou seja nao adiciona pixels na borda\n```\nPassando a imagem pela camada `conv2d` e verificando a forma de saída.\n\n```python\nimage_out_of_conv = conv2d(image.unsqueeze(0)) \nprint(image_out_of_conv.shape)\n```\n```\ntorch.Size([1, 768, 14, 14])\n```\n\nIsso significa que:\n```\ntorch.Size([1, 768, 14, 14]) -> [batch_size, embedding_dim, feature_map_height, feature_map_width]\n```\n\nPara visualizar os mapas:\n```python\nimport random\nrandom_indexes = random.sample(range(0, 758), k=5)\nprint(f\"Showing random convolutional feature maps from indexes: {random_indexes}\")\n\nfig, axs = plt.subplots(nrows=1, ncols=5, figsize=(12, 12))\n\nfor i, idx in enumerate(random_indexes):\n    image_conv_feature_map = image_out_of_conv[:, idx, :, :] \n    axs[i].imshow(image_conv_feature_map.squeeze().detach().numpy())\n    axs[i].set(xticklabels=[], yticklabels=[], xticks=[], yticks=[]);\n```\n\n<Image rounded width={600} height={400} caption=\"Mapas de recursos\" src=\"/blog/patchs/maps.png\" />\n\nEssa visualização pode mudar com o tempo, conforme a rede aprende, pois são pesos. Essa representação é de acordo \ncom a imagem original, ou seja, cada mapa de características é uma representação da imagem original.\n\nEm forma de valores seria:\n  \n```python\nsingle_feature_map = image_out_of_conv[:, 0, :, :]\nsingle_feature_map, single_feature_map.requires_grad\n```\n\n<Image rounded width={600} height={400} caption=\"Saida em valores\" src=\"/blog/patchs/one.png\" />\n\n<details>\n\nSaida do código:\n\n```\n(tensor([[[ 0.4732,  0.3567,  0.3377,  0.3736,  0.3208,  0.3913,  0.3464,\n            0.3702,  0.2541,  0.3594,  0.1984,  0.3982,  0.3741,  0.1251],\n          [ 0.4178,  0.4771,  0.3374,  0.3353,  0.3159,  0.4008,  0.3448,\n            0.3345,  0.5850,  0.4115,  0.2969,  0.2751,  0.6150,  0.4188],\n          [ 0.3209,  0.3776,  0.4970,  0.4272,  0.3301,  0.4787,  0.2754,\n            0.3726,  0.3298,  0.4631,  0.3087,  0.4915,  0.4129,  0.4592],\n          [ 0.4540,  0.4930,  0.5570,  0.2660,  0.2150,  0.2044,  0.2766,\n            0.2076,  0.3278,  0.3727,  0.2637,  0.2493,  0.2782,  0.3664],\n          [ 0.4920,  0.5671,  0.3298,  0.2992,  0.1437,  0.1701,  0.1554,\n            0.1375,  0.1377,  0.3141,  0.2694,  0.2771,  0.2412,  0.3700],\n          [ 0.5783,  0.5790,  0.4229,  0.5032,  0.1216,  0.1000,  0.0356,\n            0.1258, -0.0023,  0.1640,  0.2809,  0.2418,  0.2606,  0.3787],\n          [ 0.5334,  0.5645,  0.4781,  0.3307,  0.2391,  0.0461,  0.0095,\n            0.0542,  0.1012,  0.1331,  0.2446,  0.2526,  0.3323,  0.4120],\n          [ 0.5724,  0.2840,  0.5188,  0.3934,  0.1328,  0.0776,  0.0235,\n            0.1366,  0.3149,  0.2200,  0.2793,  0.2351,  0.4722,  0.4785],\n          [ 0.4009,  0.4570,  0.4972,  0.5785,  0.2261,  0.1447, -0.0028,\n            0.2772,  0.2697,  0.4008,  0.3606,  0.3372,  0.4535,  0.4492],\n          [ 0.5678,  0.5870,  0.5824,  0.3438,  0.5113,  0.0757,  0.1772,\n            0.3677,  0.3572,  0.3742,  0.3820,  0.4868,  0.3781,  0.4694],\n          [ 0.5845,  0.5877,  0.5826,  0.3212,  0.5276,  0.4840,  0.4825,\n            0.5523,  0.5308,  0.5085,  0.5606,  0.5720,  0.4928,  0.5581],\n          [ 0.5853,  0.5849,  0.5793,  0.3410,  0.4428,  0.4044,  0.3275,\n            0.4958,  0.4366,  0.5750,  0.5494,  0.5868,  0.5557,  0.5069],\n          [ 0.5880,  0.5888,  0.5796,  0.3377,  0.2635,  0.2347,  0.3145,\n            0.3486,  0.5158,  0.5722,  0.5347,  0.5753,  0.5816,  0.4378],\n          [ 0.5692,  0.5843,  0.5721,  0.5081,  0.2694,  0.2032,  0.1589,\n            0.3464,  0.5349,  0.5768,  0.5739,  0.5764,  0.5394,  0.4482]]],\n        grad_fn=<SliceBackward0>),\n True)\n```\n</details>\n\nO `grad_fn` significa que o Pytorch esta rastreando os gradientes de mapa, ou seja, quando for treinado ele será atualizado.\n\n### Achatando a incorporação do patch com `torch.nn.Flatten()`\n\nA saída ainda tem como dimensão 2D, porem precisa de uma sequência de 1D, para isso utilizamos `torch.nn.Flatten()`.\n\nO que temos agora é o *(P^2*C) = (16^2*3) = 768*. E a saída desejada uma saída de 1D de patches de 2D achatados. Entao o que \\\nprecisa é o *N* números de patches:\n\n```\n(196, 768) -> (número de patches, dimensão de incorporação) ->   N×(P^2⋅C)\n```\n\nO Pytorch já possui um componente chamado `torch.nn.Flatten()`, que nivela a entrada em uma sequência de 1D.\n\n<Alert type=\"warning\">\nNão queremos o tensor inteiro, somente o `feature_map_height` e `feature_map_width` de `image_out_of_conv`.\n</Alert>\n\n```python\nflatten = nn.Flatten(start_dim=2,  # feature_map_height\n                      end_dim=3)   # feature_map_width\n```\n\n#### Resumo\n\n1. Insira uma única imagem e adicione a uma camada `conv2d` para transformar em mapas de recurso 2D (incorporação de patch).\n2. Passe por um `torch.nn.Flatten()` para transformar os mapas de recursos 2D em uma sequência de 1D.\n\n```python\nplt.imshow(image.permute(1, 2, 0))\nplt.title(class_names[label])\nplt.axis(False);\nprint(f\"Original image shape: {image.shape}\")\n\n# 1. Conv2d\nimage_out_of_conv = conv2d(image.unsqueeze(0)) \nprint(f\"Image feature map shape: {image_out_of_conv.shape}\")\n\n# 2. Flatten\nimage_out_of_conv_flattened = flatten(image_out_of_conv)\nprint(f\"Flattened image feature map shape: {image_out_of_conv_flattened.shape}\")\n```\n\nA única diferença é que agora temos (768, 196) e precisa ser (196, 768), o Pytorch já possui uma função para reorganizar o tensor, com o `torch.Tensor.permute()`.\n\n```python\nimage_out_of_conv_flattened_reshaped = image_out_of_conv_flattened.permute(0, 2, 1) # [batch_size, P^2•C, N] -> [batch_size, N, P^2•C]\n```\n\nPara visualização:\n  \n```python\nsingle_flattened_feature_map = image_out_of_conv_flattened_reshaped[:, :, 0] # index: (batch_size, number_of_patches, embedding_dimension)\n\nplt.figure(figsize=(22, 22))\nplt.imshow(single_flattened_feature_map.detach().numpy())\nplt.title(f\"Flattened feature map shape: {single_flattened_feature_map.shape}\")\nplt.axis(False);\n```\n\nA saída vai ser **extremamente pequena** para ver, mas é possível ver que é uma sequência de 1D. Isso acontece porque\nno artigo original, o Transformers foi projetado para texto e não para imagem. Por isso o ViT transforma uma imagem\nem uma sequência de 1D, igual um texto.\n\n<details>\n\nVisualização do mapa de recursos achatados:\n\n```python\nsingle_flattened_feature_map, single_flattened_feature_map.requires_grad, single_flattened_feature_map.shape\n```\n\n```\n(tensor([[ 0.4732,  0.3567,  0.3377,  0.3736,  0.3208,  0.3913,  0.3464,  0.3702,\n           0.2541,  0.3594,  0.1984,  0.3982,  0.3741,  0.1251,  0.4178,  0.4771,\n           0.3374,  0.3353,  0.3159,  0.4008,  0.3448,  0.3345,  0.5850,  0.4115,\n           0.2969,  0.2751,  0.6150,  0.4188,  0.3209,  0.3776,  0.4970,  0.4272,\n           0.3301,  0.4787,  0.2754,  0.3726,  0.3298,  0.4631,  0.3087,  0.4915,\n           0.4129,  0.4592,  0.4540,  0.4930,  0.5570,  0.2660,  0.2150,  0.2044,\n           0.2766,  0.2076,  0.3278,  0.3727,  0.2637,  0.2493,  0.2782,  0.3664,\n           0.4920,  0.5671,  0.3298,  0.2992,  0.1437,  0.1701,  0.1554,  0.1375,\n           0.1377,  0.3141,  0.2694,  0.2771,  0.2412,  0.3700,  0.5783,  0.5790,\n           0.4229,  0.5032,  0.1216,  0.1000,  0.0356,  0.1258, -0.0023,  0.1640,\n           0.2809,  0.2418,  0.2606,  0.3787,  0.5334,  0.5645,  0.4781,  0.3307,\n           0.2391,  0.0461,  0.0095,  0.0542,  0.1012,  0.1331,  0.2446,  0.2526,\n           0.3323,  0.4120,  0.5724,  0.2840,  0.5188,  0.3934,  0.1328,  0.0776,\n           0.0235,  0.1366,  0.3149,  0.2200,  0.2793,  0.2351,  0.4722,  0.4785,\n           0.4009,  0.4570,  0.4972,  0.5785,  0.2261,  0.1447, -0.0028,  0.2772,\n           0.2697,  0.4008,  0.3606,  0.3372,  0.4535,  0.4492,  0.5678,  0.5870,\n           0.5824,  0.3438,  0.5113,  0.0757,  0.1772,  0.3677,  0.3572,  0.3742,\n           0.3820,  0.4868,  0.3781,  0.4694,  0.5845,  0.5877,  0.5826,  0.3212,\n           0.5276,  0.4840,  0.4825,  0.5523,  0.5308,  0.5085,  0.5606,  0.5720,\n           0.4928,  0.5581,  0.5853,  0.5849,  0.5793,  0.3410,  0.4428,  0.4044,\n           0.3275,  0.4958,  0.4366,  0.5750,  0.5494,  0.5868,  0.5557,  0.5069,\n           0.5880,  0.5888,  0.5796,  0.3377,  0.2635,  0.2347,  0.3145,  0.3486,\n           0.5158,  0.5722,  0.5347,  0.5753,  0.5816,  0.4378,  0.5692,  0.5843,\n           0.5721,  0.5081,  0.2694,  0.2032,  0.1589,  0.3464,  0.5349,  0.5768,\n           0.5739,  0.5764,  0.5394,  0.4482]], grad_fn=<SelectBackward0>),\n True,\n torch.Size([1, 196]))\n```\n</details>\n\nToda essa parte no artigo é o `Projeção Linear de Patches Flattned`.\n\n## Transformando a camada de incorporação do patch ViT em um módulo PyTorch\n\nAgora precisa colocar tudo em um módulo em Pytorch, para ser mais rápido e fácil de utilizar.\n\n```python\n# Criacao da classe com nome PatchEmbedding e herda de nn.Module\nclass PatchEmbedding(nn.Module):\n    \"\"\"Imagem 2D -> sequncia 1D\n\n    Args:\n        in_channels (int): Numero de canais\n        patch_size (int): Tamanho do patch\n        embedding_dim (int): Tamanho do embedding. padrao 768\n    \"\"\"\n    def __init__(self,\n                 in_channels:int=3,\n                 patch_size:int=16,\n                 embedding_dim:int=768):\n        super().__init__()\n\n        # Criacao dos patches\n        self.patcher = nn.Conv2d(in_channels=in_channels,\n                                 out_channels=embedding_dim,\n                                 kernel_size=patch_size,\n                                 stride=patch_size,\n                                 padding=0)\n\n        # Redimensionar os patches\n        self.flatten = nn.Flatten(start_dim=2, # somente um vetor\n                                  end_dim=3)\n\n    def forward(self, x):\n        # Verificar se a imagem é divisivel pelo tamanho do patch\n        image_resolution = x.shape[-1]\n        assert image_resolution % patch_size == 0, f\"Input image size must be divisble by patch size, image shape: {image_resolution}, patch size: {patch_size}\"\n\n        x_patched = self.patcher(x)\n        x_flattened = self.flatten(x_patched)\n        # 6. Reorganizar a incorporação do patch para que o número de patches seja o primeiro\n        return x_flattened.permute(0, 2, 1) # [batch_size, P^2•C, N] -> [batch_size, N, P^2•C]\n```\n\nPara testar:\n\n```python\nset_seeds() # modulos de utilidades\n\npatchify = PatchEmbedding(in_channels=3,\n                          patch_size=16,\n                          embedding_dim=768)\n\nprint(f\"Input image shape: {image.unsqueeze(0).shape}\")\npatch_embedded_image = patchify(image.unsqueeze(0)) \nprint(f\"Output patch embedding shape: {patch_embedded_image.shape}\")\n```\n```\nInput image shape: torch.Size([1, 3, 224, 224])\nOutput patch embedding shape: torch.Size([1, 196, 768])\n```\n\nToda essa classe se resume a isso:\n\n<Image rounded width={600} height={400} caption=\"Mapas de recursos\" src=\"/blog/patchs/equation.png\" />\n\n## Criando a incorporação do token de classe\n\n<Image rounded width={600} height={400} caption=\"Token\" src=\"/blog/patchs/firsts.png\" />\n\nPara criar uma incorporação de token aos patches que possa ser aprendida, precisa criar em um formado,\n`embedding_dimension` chamado de (*D*) e adicionar a uma dimensão `number_of_patches` chamado de (*N*).\n\nUm pseudocódigo:\n\n```python\npatch_embedding = [image_patch_1, image_patch_2, image_patch_3...]\nclass_token = learnable_embedding\npatch_embedding_with_class_token = torch.cat((class_token, patch_embedding), dim=1)\n```\n\n<Alert type=\"attention\">\n  A concatenação acontece `torch.cat()`com dimensão `dim=1`.\n</Alert>\n\nPara criar uma incorporação de token aos patches que possa ser aprendida, precisa do `batch_size` e dimensão\ndos patches, depois cria um `torch.ones()` (tensor de 1) com o tamanho do `batch_size` e `embedding_dimension`, e depois passa\npara o `torch.nn.Parameter()` para poder ser aprendido.\n\n```python\n# Tamanho do batch size\nbatch_size = patch_embedded_image.shape[0]\n# tamanho do embedding\nembedding_dimension = patch_embedded_image.shape[-1]\n\n# Cria um tensor de 1 com o tamanho do batch_size e embedding_dimension\nclass_token = nn.Parameter(torch.ones(batch_size, 1, embedding_dimension), # [batch_size, number_of_tokens, embedding_dimension]\n                           requires_grad=True) # possa ser aprendido\n\n# Mostrar 10 token\nprint(class_token[:, :, :10])\n\nprint(f\"Class token shape: {class_token.shape} -> [batch_size, number_of_tokens, embedding_dimension]\")\n```\n\n```\ntensor([[[1., 1., 1., 1., 1., 1., 1., 1., 1., 1.]]], grad_fn=<SliceBackward0>)\nClass token shape: torch.Size([1, 1, 768]) -> [batch_size, number_of_tokens, embedding_dimension]\n```\n\n<Alert type=\"attention\">\n  Aqui está criando com `torch.ones`, mas na realidade utiliza o `torch.randn()`, para gerar dados aleatórios,\n  e ir melhorando com o tempo.\n</Alert>\n\nAgora precisa juntar (concatenar) o `class_token` com os patches de imagens `patch_embedded_image`.\n\n```python\n# Adicionar o class_token ao patch_embedded_image\npatch_embedded_image_with_class_embedding = torch.cat((class_token, patch_embedded_image),\n                                                      dim=1) # concatenar na dimensao 1\n\n# Print the sequence of patch embeddings with the prepended class token embedding\nprint(patch_embedded_image_with_class_embedding)\nprint(f\"Sequence of patch embeddings with class token prepended shape: {patch_embedded_image_with_class_embedding.shape} -> [batch_size, number_of_patches, embedding_dimension]\")\n```\n\n```\ntensor([[[ 1.0000,  1.0000,  1.0000,  ...,  1.0000,  1.0000,  1.0000],\n         [-0.9145,  0.2454, -0.2292,  ...,  0.6768, -0.4515,  0.3496],\n         [-0.7427,  0.1955, -0.3570,  ...,  0.5823, -0.3458,  0.3261],\n         ...,\n         [-1.0072,  0.2795, -0.2804,  ...,  0.7624, -0.4584,  0.3581],\n         [-0.9839,  0.1652, -0.1576,  ...,  0.7489, -0.5478,  0.3486],\n         [-0.9260,  0.1383, -0.1157,  ...,  0.5847, -0.4717,  0.3112]]],\n       grad_fn=<CatBackward0>)\nSequence of patch embeddings with class token prepended shape: torch.Size([1, 197, 768]) -> [batch_size, number_of_patches, embedding_dimension]\n```\n\n<Image rounded width={600} height={400} caption=\"Token em primeiro\" src=\"/blog/patchs/token.png\" />\n\n## Criando a incorporação de posição\n\nAgora é necessário criar uma incorporação de posição aos patches, ou seja, criar uma ordem.\n\n<Math>{\"E_{pos}\"}</Math>\n\n<Image rounded width={600} height={400} caption=\"Posição\" src=\"/blog/patchs/posicao.png\" />\n\nA sequência que será gerada com a posição servira como entrada para o MSA.\n\n```python\n# Calcular o N (numeros de patches)\nnumber_of_patches = int((height * width) / patch_size**2)\n\n# Dimensao do embedding\nembedding_dimension = patch_embedded_image_with_class_embedding.shape[2]\n\n# Criarcao do tensor de posicao\nposition_embedding = nn.Parameter(torch.ones(1,\n                                             number_of_patches+1,\n                                             embedding_dimension),\n                                  requires_grad=True) # deixar que possa ser aprendido\n\n# Mostrar 10 posicoes\nprint(position_embedding[:, :10, :10])\nprint(f\"Position embeddding shape: {position_embedding.shape} -> [batch_size, number_of_patches, embedding_dimension]\")\n```\n\n```\ntensor([[[1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.]]], grad_fn=<SliceBackward0>)\nPosition embeddding shape: torch.Size([1, 197, 768]) -> [batch_size, number_of_patches, embedding_dimension]\n```\n\n<Alert type=\"attention\">\n  É normal que todos os valores aumentem em 1, porque o embeddings de posição é criado com `torch.ones()`.\n</Alert>\n\n```python\n# Adicionar o position_embedding ao patch_embedded_image_with_class_embedding\npatch_and_position_embedding = patch_embedded_image_with_class_embedding + position_embedding\nprint(patch_and_position_embedding)\nprint(f\"Patch embeddings, class token prepended and positional embeddings added shape: {patch_and_position_embedding.shape} -> [batch_size, number_of_patches, embedding_dimension]\")\n```\n\n```\ntensor([[[ 2.0000,  2.0000,  2.0000,  ...,  2.0000,  2.0000,  2.0000],\n         [ 0.0855,  1.2454,  0.7708,  ...,  1.6768,  0.5485,  1.3496],\n         [ 0.2573,  1.1955,  0.6430,  ...,  1.5823,  0.6542,  1.3261],\n         ...,\n         [-0.0072,  1.2795,  0.7196,  ...,  1.7624,  0.5416,  1.3581],\n         [ 0.0161,  1.1652,  0.8424,  ...,  1.7489,  0.4522,  1.3486],\n         [ 0.0740,  1.1383,  0.8843,  ...,  1.5847,  0.5283,  1.3112]]],\n       grad_fn=<AddBackward0>)\nPatch embeddings, class token prepended and positional embeddings added shape: torch.Size([1, 197, 768]) -> [batch_size, number_of_patches, embedding_dimension]\n```\n\n### Um resumo sobre tudo\n\n```python\nset_seeds()\n\n# 1. Defina o tamanho do patch\npatch_size = 16\n\n# 2. Imprima a forma do tensor da imagem original e obtenha as dimensões da imagem\nprint(f\"Image tensor shape: {image.shape}\")\nheight, width = image.shape[1], image.shape[2]\n\n# 3. Obtenha o tensor de imagem e adicione a dimensão do lote\nx = image.unsqueeze(0)\nprint(f\"Input image with batch dimension shape: {x.shape}\")\n\n# 4. Crie uma camada de incorporação de patch\npatch_embedding_layer = PatchEmbedding(in_channels=3,\n                                       patch_size=patch_size,\n                                       embedding_dim=768)\n\n# 5. Passe a imagem pela camada de incorporação de patch\npatch_embedding = patch_embedding_layer(x)\nprint(f\"Patching embedding shape: {patch_embedding.shape}\")\n\n# 6. Crie incorporação de token de classe\nbatch_size = patch_embedding.shape[0]\nembedding_dimension = patch_embedding.shape[-1]\nclass_token = nn.Parameter(torch.ones(batch_size, 1, embedding_dimension),\n                           requires_grad=True) \nprint(f\"Class token embedding shape: {class_token.shape}\")\n\n# 7. Anexe a incorporação de token de classe à incorporação de patch\npatch_embedding_class_token = torch.cat((class_token, patch_embedding), dim=1)\nprint(f\"Patch embedding with class token shape: {patch_embedding_class_token.shape}\")\n\n# 8. Criar incorporação de posição\nnumber_of_patches = int((height * width) / patch_size**2)\nposition_embedding = nn.Parameter(torch.ones(1, number_of_patches+1, embedding_dimension),\n                                  requires_grad=True) \n\n# 9. Adicione incorporação de posição à incorporação de patch com token de classe\npatch_and_position_embedding = patch_embedding_class_token + position_embedding\nprint(f\"Patch and position embedding shape: {patch_and_position_embedding.shape}\")\n```\n\n",
      "code": "var Component=(()=>{var m=Object.create;var i=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var g=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports),_=(a,e)=>{for(var s in e)i(a,s,{get:e[s],enumerable:!0})},o=(a,e,s,c)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let l of u(e))!k.call(a,l)&&l!==s&&i(a,l,{get:()=>e[l],enumerable:!(c=h(e,l))||c.enumerable});return a};var b=(a,e,s)=>(s=a!=null?m(N(a)):{},o(e||!a||!a.__esModule?i(s,\"default\",{value:a,enumerable:!0}):s,a)),f=a=>o(i({},\"__esModule\",{value:!0}),a);var p=g((q,r)=>{r.exports=_jsx_runtime});var x={};_(x,{default:()=>w,frontmatter:()=>z});var n=b(p()),z={title:\"Vision Transformer (ViT) - Patches\",publishedAt:\"2024-01-15\",summary:\"Dividir os dados em patches e criar a classe, posi\\xE7\\xE3o e incorpora\\xE7\\xE3o de patches\",tags:[\"Pytorch\",\"ViT\",\"Transformer\",\"Vision\"],shortTitle:\"ViT\"};function d(a){let e=Object.assign({h2:\"h2\",blockquote:\"blockquote\",p:\"p\",ul:\"ul\",li:\"li\",em:\"em\",h3:\"h3\",pre:\"pre\",code:\"code\",span:\"span\",strong:\"strong\",br:\"br\",h4:\"h4\",ol:\"ol\"},a.components),{Alert:s,Image:c,Math:l}=e;return s||t(\"Alert\",!0),c||t(\"Image\",!0),l||t(\"Math\",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.h2,{id:\"equa\\xE7\\xE3o-1-dividir-os-dados-em-patches\",children:\"Equa\\xE7\\xE3o 1: Dividir os dados em patches\"}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsx)(e.p,{children:\"Se puder dividir os dados de uma forma facil de enteder e boa de aprender, \\xE9 provavel que o algoritmo tenha um maior desempenho com dados reais.\"}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Para come\\xE7ar primeiro precisa criar os embeddings de classe, posi\\xE7\\xE3o e patch, Assim come\\xE7ando por uma incorpora\\xE7\\xE3o de pacth.\"}),`\n`,(0,n.jsx)(s,{type:\"attention\",children:(0,n.jsx)(e.p,{children:\"Incorpora\\xE7\\xE3o se refere a transformar os dados em um vetor (geralmente) de uma forma que o algoritmo consiga entender mais f\\xE1cil.\"})}),`\n`,(0,n.jsx)(e.p,{children:\"Analisando o artigo:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.em,{children:\"D\"}),\" tamanho do embeddings de patch.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Imagem com dimens\\xE3o \",(0,n.jsx)(e.em,{children:\"H\"}),\" x \",(0,n.jsx)(e.em,{children:\"W x C\"}),\".\",`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"(\",(0,n.jsx)(e.em,{children:\"H\"}),\" x \",(0,n.jsx)(e.em,{children:\"W\"}),\") - (altura, largura).\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.em,{children:\"C\"}),\" - numero de canais (RGB = 3).\"]}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Tamanho \",(0,n.jsx)(e.em,{children:\"N\\xD7(P^2\\u22C5C)\"}),\" da sequ\\xEAncia de patch 2D.\",`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.em,{children:\"(P, P)\"}),\" - resolu\\xE7\\xE3o da imagem em cada patch.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.em,{children:\"N = HW / P^2\"}),\" numero resultante de patches que tamb\\xE9m serve como entrada para o MSA.\"]}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,n.jsx)(c,{rounded:!0,width:600,height:400,caption:\"Visualiza\\xE7\\xE3o da transforma\\xE7\\xE3o de imagem em patch\",src:\"/blog/patchs/patch.png\"}),`\n`,(0,n.jsx)(e.h3,{id:\"calculando-manualmente-utilizando-python\",children:\"Calculando manualmente utilizando Python\"}),`\n`,(0,n.jsx)(e.p,{children:\"Um exemplo de como calcular o n\\xFAmero de patches de uma imagem com altura 224, largura 224 e patch de tamanho 16.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"height \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"224\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Altura\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"width \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"224\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Largura\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"color_channels \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Numero de canais\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"patch_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Ramanho do patch\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Calculando N *(numero de patches)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"number_of_patches \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"height \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\" width\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"/\"}),\" patch_size\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"**\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Number of patches (N) with image height (H='}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"height\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:\"), width (W=\"}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"width\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:\") and patch size (P=\"}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:\"): \"}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"number_of_patches\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`Number of patches (N) with image height (H=224), width (W=224) and patch size (P=16): 196\n`})})}),`\n`,(0,n.jsx)(e.p,{children:\"Agora que temos o n\\xFAmero de patches, precisa calcular o tamanho de vetor de cada patch.\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"INPUT:\"}),\" Imagem com dimens\\xE3o \",(0,n.jsx)(e.em,{children:\"H\"}),\" x \",(0,n.jsx)(e.em,{children:\"W x C\"}),\".\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"OUTPUT:\"}),\" Sequ\\xEAncia de patch 2D com tamanho \",(0,n.jsx)(e.em,{children:\"N\\xD7(P^2\\u22C5C)\"}),\".\"]}),`\n`]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# input imagem shape\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"embedding_layer_input_shape \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"height\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" width\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" color_channels\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Output shape\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"embedding_layer_output_shape \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"number_of_patches\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" patch_size\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"**\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\" color_channels\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Input shape (single 2D image): '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"embedding_layer_input_shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Output shape (single 2D image flattened into patches): '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"embedding_layer_output_shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`Input shape (single 2D image): (224, 224, 3)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Output shape (single 2D image flattened into patches): (196, 768)\n`})]})}),`\n`,(0,n.jsx)(s,{type:\"attention\",children:(0,n.jsx)(e.p,{children:\"Todos os c\\xF3digos se complementam!!\"})}),`\n`,(0,n.jsx)(e.h2,{id:\"transformando-uma-imagem-real-em-um-patch\",children:\"Transformando uma imagem real em um patch\"}),`\n`,(0,n.jsx)(e.p,{children:\"A parte principal de replicar um artigo \\xE9 criar partes menores (camadas), se concentrando na entrada e sa\\xEDda.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# View single image\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"plt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"imshow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"permute\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# ajustando a ordem dos canais\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"plt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"title\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"class_names\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"label\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"plt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"axis\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Para come\\xE7ar do b\\xE1sico, mostrando somente a parte superior antes de fragmentar a imagem por inteiro.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Altere o formato da imagem para ser compat\\xEDvel com matplotlib (color_channels, height, width) -> (height, width, color_channels)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"image_permuted \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"permute\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# \\xCDndice para tra\\xE7ar a linha superior de pixels corrigidos\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"patch_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"plt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"figure\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"figsize\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"plt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"imshow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"image_permuted\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Agora que temos a linha superior da imagem, precisa dividir em patches.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Configure hiperpar\\xE2metros e certifique-se de que img_size e patch_size sejam compat\\xEDveis\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"img_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"224\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"patch_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"num_patches \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" img_size\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"/\"}),`patch_size\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"assert\"}),\" img_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),\" patch_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Image size must be divisible by patch size\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Number of patches per row: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"num_patches\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:\"\\\\nPatch size: \"}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:\" pixels x \"}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:' pixels\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"fig\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" axs \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" plt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"subplots\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nrows\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                        ncols\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"img_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"//\"}),\" patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                        figsize\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"num_patches\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" num_patches\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                        sharex\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                        sharey\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" patch \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"enumerate\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"range\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" img_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    axs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"imshow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"image_permuted\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" patch\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"patch\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),` \n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    axs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"set_xlabel\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"i\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    axs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"set_xticks\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    axs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"set_yticks\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`Number of patches per row: 14.0\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Patch size: 16 pixels x 16 pixels\n`})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Agora que fizemos para a parte superior vamos fazer para a imagem inteira.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Configure hiperpar\\xE2metros e certifique-se de que img_size e patch_size sejam compat\\xEDveis\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"img_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"224\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"patch_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"num_patches \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" img_size\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"/\"}),`patch_size\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"assert\"}),\" img_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),\" patch_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Image size must be divisible by patch size\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),'f\"Number of patches per row',(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"num_patches\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\\\\\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \\\\nNumber of patches per column\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"num_patches\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\\\\\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \\\\nTotal patches\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"num_patches\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"num_patches\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\\\\\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \\\\nPatch size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" pixels x \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),' pixels\"',(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Crie uma s\\xE9rie de subtramas\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"fig\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" axs \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" plt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"subplots\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nrows\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"img_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"//\"}),\" patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# precisa que int n\\xE3o flutue\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                        ncols\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"img_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"//\"}),\" patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                        figsize\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"num_patches\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" num_patches\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                        sharex\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                        sharey\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Loop pela altura e largura da imagem\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" patch_height \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"enumerate\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"range\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" img_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# iterar pela altura\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" j\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" patch_width \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"enumerate\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"range\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" img_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token comment\",children:\"# iterar pela largura\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Plote o patch da imagem permutada (image_permuted -> (Altura, Largura, Canais de cores))\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        axs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" j\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"imshow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"image_permuted\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"patch_height\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"patch_height\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# iterar pela altura\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                        patch_width\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"patch_width\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# iterar pela largura\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#obt\\xE9m todos os canais de cores\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Configure as informa\\xE7\\xF5es do r\\xF3tulo, remova as marcas para maior clareza e defina os r\\xF3tulos para fora\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        axs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" j\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"set_ylabel\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"i\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                             rotation\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"horizontal\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                             horizontalalignment\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"right\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                             verticalalignment\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"center\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        axs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" j\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"set_xlabel\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"j\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        axs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" j\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"set_xticks\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        axs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" j\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"set_yticks\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        axs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" j\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"label_outer\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Defina um supert\\xEDtulo\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"fig\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"suptitle\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"'}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"class_names\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"label\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:' -> Patchified\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" fontsize\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"plt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"show\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`Number of patches per row: 14.0        \n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Number of patches per column: 14.0        \n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Total patches: 196.0        \n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Patch size: 16 pixels x 16 pixels\n`})]})}),`\n`,(0,n.jsxs)(e.h3,{id:\"criando-patches-de-imagem-com-torchnnconv2d\",children:[\"Criando patches de imagem com \",(0,n.jsx)(e.code,{children:\"torch.nn.Conv2d()\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Essa incorpora\\xE7\\xE3o de patches \\xE9 o mesmo que utilizar \",(0,n.jsx)(e.code,{children:\"torch.nn.Conv2d()\"}),`, uma alternativa seria a entrada como formado de\nmapas de caracter\\xEDsticas (`,(0,n.jsx)(e.em,{children:\"pesos/ativa\\xE7\\xF5es\"}),\") como na CNN.\"]}),`\n`,(0,n.jsx)(s,{type:\"attention\",children:(0,n.jsxs)(e.p,{children:[\"Ou seja, podemos simplesmente utilizar um \",(0,n.jsx)(e.code,{children:\"kernel_size\"}),\" e um \",(0,n.jsx)(e.code,{children:\"stripe\"}),` para criar os patches, que seria o mesmo,\ndo que fazer os `,(0,n.jsx)(e.code,{children:\"patch_size\"}),\".\"]})}),`\n`,(0,n.jsx)(e.p,{children:\"No exemplo do c\\xF3digo, utiliza uma imagem 2D e convertemos em uma sequ\\xEAncia de 1D de fragmentos 2D achatados.\"}),`\n`,(0,n.jsx)(e.p,{children:\"No Pytorch podemos utilizar:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"torch.nn.Conv2d()\"}),\" para fragmentar a imagem em uma sequ\\xEAncia de mapas de caracter\\xEDsticas.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"torch.nn.flatten()\"}),\" para achat\\xE1-los em uma sequ\\xEAncia de vetores.\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Passamos como par\\xE2metros \",(0,n.jsx)(e.code,{children:\"kernel_size\"}),\" e \",(0,n.jsx)(e.code,{children:\"stride\"}),\" com o mesmo valor de \",(0,n.jsx)(e.code,{children:\"patch_size\"}),` para obter o mesmo resultado.\nPara cada kernel convolucional de tamanho (patch_size, patch_size), e o `,(0,n.jsx)(e.code,{children:\"stripe\"}),\" tera \",(0,n.jsx)(e.code,{children:\"patch_size\"}),\" p\\xEDxeis de tamanho.\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"patch_size\"}),\" = 16 -> Tamanho do patch\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"kernel_size\"}),\" = (patch_size, patch_size) -> altura e largura do kernel\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"stride\"}),\" = (patch_size) -> Tamanho dos p\\xEDxeis\"]}),`\n`]}),`\n`,(0,n.jsx)(c,{rounded:!0,width:600,height:400,caption:\"nn.Conv2d\",src:\"/blog/patchs/conv.png\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Al\\xE9m disso, definimos \",(0,n.jsx)(e.code,{children:\"in_channels=3\"}),\", pois s\\xE3o 3 canais de cores e \",(0,n.jsx)(e.code,{children:\"out_channels=768\"}),\", esse valor \\xE9 o \",(0,n.jsx)(e.em,{children:\"D\"}),` da equa\\xE7\\xE3o 1.\nEsse valor significa que cada imagem ter\\xE1 um vetor de incorpora\\xE7\\xE3o de tamanho 768, para ser aprendido.`]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" torch \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` nn\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"patch_size\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"conv2d \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" nn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Conv2d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"in_channels\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` \n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                   out_channels\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"768\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` \n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                   kernel_size\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                   stride\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                   padding\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# padding=0 -> sem padding, ou seja nao adiciona pixels na borda\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Passando a imagem pela camada \",(0,n.jsx)(e.code,{children:\"conv2d\"}),\" e verificando a forma de sa\\xEDda.\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"image_out_of_conv \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" conv2d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"unsqueeze\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),` \n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"image_out_of_conv\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`torch.Size([1, 768, 14, 14])\n`})})}),`\n`,(0,n.jsx)(e.p,{children:\"Isso significa que:\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`torch.Size([1, 768, 14, 14]) -> [batch_size, embedding_dim, feature_map_height, feature_map_width]\n`})})}),`\n`,(0,n.jsx)(e.p,{children:\"Para visualizar os mapas:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` random\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"random_indexes \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" random\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"sample\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"range\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"758\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" k\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"5\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Showing random convolutional feature maps from indexes: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"random_indexes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"fig\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" axs \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" plt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"subplots\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nrows\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" ncols\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"5\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" figsize\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"12\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"12\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" idx \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"enumerate\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"random_indexes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    image_conv_feature_map \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" image_out_of_conv\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" idx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` \n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    axs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"imshow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"image_conv_feature_map\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"squeeze\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"detach\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"numpy\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    axs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"set\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"xticklabels\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" yticklabels\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" xticks\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" yticks\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,n.jsx)(c,{rounded:!0,width:600,height:400,caption:\"Mapas de recursos\",src:\"/blog/patchs/maps.png\"}),`\n`,(0,n.jsx)(e.p,{children:`Essa visualiza\\xE7\\xE3o pode mudar com o tempo, conforme a rede aprende, pois s\\xE3o pesos. Essa representa\\xE7\\xE3o \\xE9 de acordo\ncom a imagem original, ou seja, cada mapa de caracter\\xEDsticas \\xE9 uma representa\\xE7\\xE3o da imagem original.`}),`\n`,(0,n.jsx)(e.p,{children:\"Em forma de valores seria:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"single_feature_map \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" image_out_of_conv\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"single_feature_map\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" single_feature_map\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`requires_grad\n`]})]})}),`\n`,(0,n.jsx)(c,{rounded:!0,width:600,height:400,caption:\"Saida em valores\",src:\"/blog/patchs/one.png\"}),`\n`,(0,n.jsxs)(\"details\",{children:[(0,n.jsx)(e.p,{children:\"Saida do c\\xF3digo:\"}),(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`(tensor([[[ 0.4732,  0.3567,  0.3377,  0.3736,  0.3208,  0.3913,  0.3464,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            0.3702,  0.2541,  0.3594,  0.1984,  0.3982,  0.3741,  0.1251],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`          [ 0.4178,  0.4771,  0.3374,  0.3353,  0.3159,  0.4008,  0.3448,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            0.3345,  0.5850,  0.4115,  0.2969,  0.2751,  0.6150,  0.4188],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`          [ 0.3209,  0.3776,  0.4970,  0.4272,  0.3301,  0.4787,  0.2754,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            0.3726,  0.3298,  0.4631,  0.3087,  0.4915,  0.4129,  0.4592],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`          [ 0.4540,  0.4930,  0.5570,  0.2660,  0.2150,  0.2044,  0.2766,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            0.2076,  0.3278,  0.3727,  0.2637,  0.2493,  0.2782,  0.3664],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`          [ 0.4920,  0.5671,  0.3298,  0.2992,  0.1437,  0.1701,  0.1554,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            0.1375,  0.1377,  0.3141,  0.2694,  0.2771,  0.2412,  0.3700],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`          [ 0.5783,  0.5790,  0.4229,  0.5032,  0.1216,  0.1000,  0.0356,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            0.1258, -0.0023,  0.1640,  0.2809,  0.2418,  0.2606,  0.3787],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`          [ 0.5334,  0.5645,  0.4781,  0.3307,  0.2391,  0.0461,  0.0095,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            0.0542,  0.1012,  0.1331,  0.2446,  0.2526,  0.3323,  0.4120],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`          [ 0.5724,  0.2840,  0.5188,  0.3934,  0.1328,  0.0776,  0.0235,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            0.1366,  0.3149,  0.2200,  0.2793,  0.2351,  0.4722,  0.4785],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`          [ 0.4009,  0.4570,  0.4972,  0.5785,  0.2261,  0.1447, -0.0028,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            0.2772,  0.2697,  0.4008,  0.3606,  0.3372,  0.4535,  0.4492],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`          [ 0.5678,  0.5870,  0.5824,  0.3438,  0.5113,  0.0757,  0.1772,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            0.3677,  0.3572,  0.3742,  0.3820,  0.4868,  0.3781,  0.4694],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`          [ 0.5845,  0.5877,  0.5826,  0.3212,  0.5276,  0.4840,  0.4825,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            0.5523,  0.5308,  0.5085,  0.5606,  0.5720,  0.4928,  0.5581],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`          [ 0.5853,  0.5849,  0.5793,  0.3410,  0.4428,  0.4044,  0.3275,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            0.4958,  0.4366,  0.5750,  0.5494,  0.5868,  0.5557,  0.5069],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`          [ 0.5880,  0.5888,  0.5796,  0.3377,  0.2635,  0.2347,  0.3145,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            0.3486,  0.5158,  0.5722,  0.5347,  0.5753,  0.5816,  0.4378],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`          [ 0.5692,  0.5843,  0.5721,  0.5081,  0.2694,  0.2032,  0.1589,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            0.3464,  0.5349,  0.5768,  0.5739,  0.5764,  0.5394,  0.4482]]],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        grad_fn=<SliceBackward0>),\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:` True)\n`})]})})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"O \",(0,n.jsx)(e.code,{children:\"grad_fn\"}),\" significa que o Pytorch esta rastreando os gradientes de mapa, ou seja, quando for treinado ele ser\\xE1 atualizado.\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"achatando-a-incorpora\\xE7\\xE3o-do-patch-com-torchnnflatten\",children:[\"Achatando a incorpora\\xE7\\xE3o do patch com \",(0,n.jsx)(e.code,{children:\"torch.nn.Flatten()\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"A sa\\xEDda ainda tem como dimens\\xE3o 2D, porem precisa de uma sequ\\xEAncia de 1D, para isso utilizamos \",(0,n.jsx)(e.code,{children:\"torch.nn.Flatten()\"}),\".\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"O que temos agora \\xE9 o \",(0,n.jsx)(e.em,{children:\"(P^2\"}),\"C) = (16^2\",(0,n.jsx)(e.em,{children:\"3) = 768\"}),\". E a sa\\xEDda desejada uma sa\\xEDda de 1D de patches de 2D achatados. Entao o que \",(0,n.jsx)(e.br,{}),`\n`,\"precisa \\xE9 o \",(0,n.jsx)(e.em,{children:\"N\"}),\" n\\xFAmeros de patches:\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`(196, 768) -> (n\\xFAmero de patches, dimens\\xE3o de incorpora\\xE7\\xE3o) ->   N\\xD7(P^2\\u22C5C)\n`})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"O Pytorch j\\xE1 possui um componente chamado \",(0,n.jsx)(e.code,{children:\"torch.nn.Flatten()\"}),\", que nivela a entrada em uma sequ\\xEAncia de 1D.\"]}),`\n`,(0,n.jsx)(s,{type:\"warning\",children:(0,n.jsxs)(e.p,{children:[\"N\\xE3o queremos o tensor inteiro, somente o \",(0,n.jsx)(e.code,{children:\"feature_map_height\"}),\" e \",(0,n.jsx)(e.code,{children:\"feature_map_width\"}),\" de \",(0,n.jsx)(e.code,{children:\"image_out_of_conv\"}),\".\"]})}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"flatten \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" nn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Flatten\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"start_dim\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# feature_map_height\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                      end_dim\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"   \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# feature_map_width\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.h4,{id:\"resumo\",children:\"Resumo\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Insira uma \\xFAnica imagem e adicione a uma camada \",(0,n.jsx)(e.code,{children:\"conv2d\"}),\" para transformar em mapas de recurso 2D (incorpora\\xE7\\xE3o de patch).\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Passe por um \",(0,n.jsx)(e.code,{children:\"torch.nn.Flatten()\"}),\" para transformar os mapas de recursos 2D em uma sequ\\xEAncia de 1D.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"plt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"imshow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"permute\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"plt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"title\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"class_names\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"label\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"plt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"axis\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Original image shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 1. Conv2d\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"image_out_of_conv \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" conv2d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"unsqueeze\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),` \n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Image feature map shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"image_out_of_conv\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 2. Flatten\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"image_out_of_conv_flattened \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" flatten\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"image_out_of_conv\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Flattened image feature map shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"image_out_of_conv_flattened\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"A \\xFAnica diferen\\xE7a \\xE9 que agora temos (768, 196) e precisa ser (196, 768), o Pytorch j\\xE1 possui uma fun\\xE7\\xE3o para reorganizar o tensor, com o \",(0,n.jsx)(e.code,{children:\"torch.Tensor.permute()\"}),\".\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsx)(e.code,{className:\"language-python code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"image_out_of_conv_flattened_reshaped \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" image_out_of_conv_flattened\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"permute\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# [batch_size, P^2\\u2022C, N] -> [batch_size, N, P^2\\u2022C]\"}),`\n`]})})}),`\n`,(0,n.jsx)(e.p,{children:\"Para visualiza\\xE7\\xE3o:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"single_flattened_feature_map \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" image_out_of_conv_flattened_reshaped\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# index: (batch_size, number_of_patches, embedding_dimension)\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"plt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"figure\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"figsize\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"22\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"22\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"plt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"imshow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"single_flattened_feature_map\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"detach\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"numpy\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"plt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"title\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Flattened feature map shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"single_flattened_feature_map\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"plt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"axis\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"A sa\\xEDda vai ser \",(0,n.jsx)(e.strong,{children:\"extremamente pequena\"}),` para ver, mas \\xE9 poss\\xEDvel ver que \\xE9 uma sequ\\xEAncia de 1D. Isso acontece porque\nno artigo original, o Transformers foi projetado para texto e n\\xE3o para imagem. Por isso o ViT transforma uma imagem\nem uma sequ\\xEAncia de 1D, igual um texto.`]}),`\n`,(0,n.jsxs)(\"details\",{children:[(0,n.jsx)(e.p,{children:\"Visualiza\\xE7\\xE3o do mapa de recursos achatados:\"}),(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsx)(e.code,{className:\"language-python code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"single_flattened_feature_map\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" single_flattened_feature_map\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"requires_grad\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" single_flattened_feature_map\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`shape\n`]})})}),(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`(tensor([[ 0.4732,  0.3567,  0.3377,  0.3736,  0.3208,  0.3913,  0.3464,  0.3702,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.2541,  0.3594,  0.1984,  0.3982,  0.3741,  0.1251,  0.4178,  0.4771,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.3374,  0.3353,  0.3159,  0.4008,  0.3448,  0.3345,  0.5850,  0.4115,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.2969,  0.2751,  0.6150,  0.4188,  0.3209,  0.3776,  0.4970,  0.4272,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.3301,  0.4787,  0.2754,  0.3726,  0.3298,  0.4631,  0.3087,  0.4915,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.4129,  0.4592,  0.4540,  0.4930,  0.5570,  0.2660,  0.2150,  0.2044,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.2766,  0.2076,  0.3278,  0.3727,  0.2637,  0.2493,  0.2782,  0.3664,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.4920,  0.5671,  0.3298,  0.2992,  0.1437,  0.1701,  0.1554,  0.1375,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.1377,  0.3141,  0.2694,  0.2771,  0.2412,  0.3700,  0.5783,  0.5790,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.4229,  0.5032,  0.1216,  0.1000,  0.0356,  0.1258, -0.0023,  0.1640,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.2809,  0.2418,  0.2606,  0.3787,  0.5334,  0.5645,  0.4781,  0.3307,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.2391,  0.0461,  0.0095,  0.0542,  0.1012,  0.1331,  0.2446,  0.2526,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.3323,  0.4120,  0.5724,  0.2840,  0.5188,  0.3934,  0.1328,  0.0776,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.0235,  0.1366,  0.3149,  0.2200,  0.2793,  0.2351,  0.4722,  0.4785,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.4009,  0.4570,  0.4972,  0.5785,  0.2261,  0.1447, -0.0028,  0.2772,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.2697,  0.4008,  0.3606,  0.3372,  0.4535,  0.4492,  0.5678,  0.5870,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.5824,  0.3438,  0.5113,  0.0757,  0.1772,  0.3677,  0.3572,  0.3742,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.3820,  0.4868,  0.3781,  0.4694,  0.5845,  0.5877,  0.5826,  0.3212,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.5276,  0.4840,  0.4825,  0.5523,  0.5308,  0.5085,  0.5606,  0.5720,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.4928,  0.5581,  0.5853,  0.5849,  0.5793,  0.3410,  0.4428,  0.4044,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.3275,  0.4958,  0.4366,  0.5750,  0.5494,  0.5868,  0.5557,  0.5069,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.5880,  0.5888,  0.5796,  0.3377,  0.2635,  0.2347,  0.3145,  0.3486,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.5158,  0.5722,  0.5347,  0.5753,  0.5816,  0.4378,  0.5692,  0.5843,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.5721,  0.5081,  0.2694,  0.2032,  0.1589,  0.3464,  0.5349,  0.5768,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`           0.5739,  0.5764,  0.5394,  0.4482]], grad_fn=<SelectBackward0>),\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:` True,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:` torch.Size([1, 196]))\n`})]})})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Toda essa parte no artigo \\xE9 o \",(0,n.jsx)(e.code,{children:\"Proje\\xE7\\xE3o Linear de Patches Flattned\"}),\".\"]}),`\n`,(0,n.jsx)(e.h2,{id:\"transformando-a-camada-de-incorpora\\xE7\\xE3o-do-patch-vit-em-um-m\\xF3dulo-pytorch\",children:\"Transformando a camada de incorpora\\xE7\\xE3o do patch ViT em um m\\xF3dulo PyTorch\"}),`\n`,(0,n.jsx)(e.p,{children:\"Agora precisa colocar tudo em um m\\xF3dulo em Pytorch, para ser mais r\\xE1pido e f\\xE1cil de utilizar.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Criacao da classe com nome PatchEmbedding e herda de nn.Module\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"PatchEmbedding\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Module\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`\"\"\"Imagem 2D -> sequncia 1D\n`})]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`    Args:\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`        in_channels (int): Numero de canais\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`        patch_size (int): Tamanho do patch\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`        embedding_dim (int): Tamanho do embedding. padrao 768\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:'    \"\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"__init__\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                 in_channels\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                 patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                 embedding_dim\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"768\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"super\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"__init__\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Criacao dos patches\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"patcher \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" nn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Conv2d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"in_channels\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"in_channels\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                 out_channels\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"embedding_dim\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                 kernel_size\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                 stride\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                 padding\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Redimensionar os patches\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"flatten \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" nn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Flatten\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"start_dim\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# somente um vetor\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                  end_dim\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"forward\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Verificar se a imagem \\xE9 divisivel pelo tamanho do patch\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        image_resolution \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"assert\"}),\" image_resolution \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),\" patch_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Input image size must be divisble by patch size, image shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"image_resolution\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:\", patch size: \"}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        x_patched \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"patcher\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        x_flattened \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"flatten\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"x_patched\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 6. Reorganizar a incorpora\\xE7\\xE3o do patch para que o n\\xFAmero de patches seja o primeiro\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" x_flattened\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"permute\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# [batch_size, P^2\\u2022C, N] -> [batch_size, N, P^2\\u2022C]\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Para testar:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"set_seeds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# modulos de utilidades\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"patchify \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" PatchEmbedding\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"in_channels\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                          patch_size\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                          embedding_dim\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"768\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Input image shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"unsqueeze\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"patch_embedded_image \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" patchify\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"unsqueeze\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),` \n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Output patch embedding shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"patch_embedded_image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`Input image shape: torch.Size([1, 3, 224, 224])\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Output patch embedding shape: torch.Size([1, 196, 768])\n`})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Toda essa classe se resume a isso:\"}),`\n`,(0,n.jsx)(c,{rounded:!0,width:600,height:400,caption:\"Mapas de recursos\",src:\"/blog/patchs/equation.png\"}),`\n`,(0,n.jsx)(e.h2,{id:\"criando-a-incorpora\\xE7\\xE3o-do-token-de-classe\",children:\"Criando a incorpora\\xE7\\xE3o do token de classe\"}),`\n`,(0,n.jsx)(c,{rounded:!0,width:600,height:400,caption:\"Token\",src:\"/blog/patchs/firsts.png\"}),`\n`,(0,n.jsxs)(e.p,{children:[`Para criar uma incorpora\\xE7\\xE3o de token aos patches que possa ser aprendida, precisa criar em um formado,\n`,(0,n.jsx)(e.code,{children:\"embedding_dimension\"}),\" chamado de (\",(0,n.jsx)(e.em,{children:\"D\"}),\") e adicionar a uma dimens\\xE3o \",(0,n.jsx)(e.code,{children:\"number_of_patches\"}),\" chamado de (\",(0,n.jsx)(e.em,{children:\"N\"}),\").\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Um pseudoc\\xF3digo:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"patch_embedding \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"image_patch_1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" image_patch_2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" image_patch_3\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"class_token \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),` learnable_embedding\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"patch_embedding_with_class_token \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" torch\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"cat\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"class_token\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" patch_embedding\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" dim\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(s,{type:\"attention\",children:(0,n.jsxs)(e.p,{children:[\"A concatena\\xE7\\xE3o acontece \",(0,n.jsx)(e.code,{children:\"torch.cat()\"}),\"com dimens\\xE3o \",(0,n.jsx)(e.code,{children:\"dim=1\"}),\".\"]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Para criar uma incorpora\\xE7\\xE3o de token aos patches que possa ser aprendida, precisa do \",(0,n.jsx)(e.code,{children:\"batch_size\"}),` e dimens\\xE3o\ndos patches, depois cria um `,(0,n.jsx)(e.code,{children:\"torch.ones()\"}),\" (tensor de 1) com o tamanho do \",(0,n.jsx)(e.code,{children:\"batch_size\"}),\" e \",(0,n.jsx)(e.code,{children:\"embedding_dimension\"}),`, e depois passa\npara o `,(0,n.jsx)(e.code,{children:\"torch.nn.Parameter()\"}),\" para poder ser aprendido.\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Tamanho do batch size\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"batch_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" patch_embedded_image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# tamanho do embedding\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"embedding_dimension \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" patch_embedded_image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Cria um tensor de 1 com o tamanho do batch_size e embedding_dimension\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"class_token \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" nn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Parameter\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"torch\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ones\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"batch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" embedding_dimension\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# [batch_size, number_of_tokens, embedding_dimension]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                           requires_grad\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# possa ser aprendido\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Mostrar 10 token\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"class_token\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"10\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Class token shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"class_token\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:' -> [batch_size, number_of_tokens, embedding_dimension]\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`tensor([[[1., 1., 1., 1., 1., 1., 1., 1., 1., 1.]]], grad_fn=<SliceBackward0>)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Class token shape: torch.Size([1, 1, 768]) -> [batch_size, number_of_tokens, embedding_dimension]\n`})]})}),`\n`,(0,n.jsx)(s,{type:\"attention\",children:(0,n.jsxs)(e.p,{children:[\"Aqui est\\xE1 criando com \",(0,n.jsx)(e.code,{children:\"torch.ones\"}),\", mas na realidade utiliza o \",(0,n.jsx)(e.code,{children:\"torch.randn()\"}),`, para gerar dados aleat\\xF3rios,\ne ir melhorando com o tempo.`]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Agora precisa juntar (concatenar) o \",(0,n.jsx)(e.code,{children:\"class_token\"}),\" com os patches de imagens \",(0,n.jsx)(e.code,{children:\"patch_embedded_image\"}),\".\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Adicionar o class_token ao patch_embedded_image\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"patch_embedded_image_with_class_embedding \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" torch\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"cat\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"class_token\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" patch_embedded_image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                                      dim\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# concatenar na dimensao 1\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Print the sequence of patch embeddings with the prepended class token embedding\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"patch_embedded_image_with_class_embedding\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Sequence of patch embeddings with class token prepended shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"patch_embedded_image_with_class_embedding\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:' -> [batch_size, number_of_patches, embedding_dimension]\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`tensor([[[ 1.0000,  1.0000,  1.0000,  ...,  1.0000,  1.0000,  1.0000],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [-0.9145,  0.2454, -0.2292,  ...,  0.6768, -0.4515,  0.3496],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [-0.7427,  0.1955, -0.3570,  ...,  0.5823, -0.3458,  0.3261],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         ...,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [-1.0072,  0.2795, -0.2804,  ...,  0.7624, -0.4584,  0.3581],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [-0.9839,  0.1652, -0.1576,  ...,  0.7489, -0.5478,  0.3486],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [-0.9260,  0.1383, -0.1157,  ...,  0.5847, -0.4717,  0.3112]]],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`       grad_fn=<CatBackward0>)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Sequence of patch embeddings with class token prepended shape: torch.Size([1, 197, 768]) -> [batch_size, number_of_patches, embedding_dimension]\n`})]})}),`\n`,(0,n.jsx)(c,{rounded:!0,width:600,height:400,caption:\"Token em primeiro\",src:\"/blog/patchs/token.png\"}),`\n`,(0,n.jsx)(e.h2,{id:\"criando-a-incorpora\\xE7\\xE3o-de-posi\\xE7\\xE3o\",children:\"Criando a incorpora\\xE7\\xE3o de posi\\xE7\\xE3o\"}),`\n`,(0,n.jsx)(e.p,{children:\"Agora \\xE9 necess\\xE1rio criar uma incorpora\\xE7\\xE3o de posi\\xE7\\xE3o aos patches, ou seja, criar uma ordem.\"}),`\n`,(0,n.jsx)(l,{children:\"E_{pos}\"}),`\n`,(0,n.jsx)(c,{rounded:!0,width:600,height:400,caption:\"Posi\\xE7\\xE3o\",src:\"/blog/patchs/posicao.png\"}),`\n`,(0,n.jsx)(e.p,{children:\"A sequ\\xEAncia que ser\\xE1 gerada com a posi\\xE7\\xE3o servira como entrada para o MSA.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Calcular o N (numeros de patches)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"number_of_patches \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"height \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\" width\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"/\"}),\" patch_size\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"**\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Dimensao do embedding\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"embedding_dimension \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" patch_embedded_image_with_class_embedding\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Criarcao do tensor de posicao\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"position_embedding \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" nn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Parameter\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"torch\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ones\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                             number_of_patches\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                             embedding_dimension\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                  requires_grad\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# deixar que possa ser aprendido\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Mostrar 10 posicoes\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"position_embedding\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"10\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"10\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Position embeddding shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"position_embedding\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:' -> [batch_size, number_of_patches, embedding_dimension]\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`tensor([[[1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.]]], grad_fn=<SliceBackward0>)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Position embeddding shape: torch.Size([1, 197, 768]) -> [batch_size, number_of_patches, embedding_dimension]\n`})]})}),`\n`,(0,n.jsx)(s,{type:\"attention\",children:(0,n.jsxs)(e.p,{children:[\"\\xC9 normal que todos os valores aumentem em 1, porque o embeddings de posi\\xE7\\xE3o \\xE9 criado com \",(0,n.jsx)(e.code,{children:\"torch.ones()\"}),\".\"]})}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Adicionar o position_embedding ao patch_embedded_image_with_class_embedding\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"patch_and_position_embedding \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" patch_embedded_image_with_class_embedding \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),` position_embedding\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"patch_and_position_embedding\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Patch embeddings, class token prepended and positional embeddings added shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"patch_and_position_embedding\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:' -> [batch_size, number_of_patches, embedding_dimension]\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`tensor([[[ 2.0000,  2.0000,  2.0000,  ...,  2.0000,  2.0000,  2.0000],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [ 0.0855,  1.2454,  0.7708,  ...,  1.6768,  0.5485,  1.3496],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [ 0.2573,  1.1955,  0.6430,  ...,  1.5823,  0.6542,  1.3261],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         ...,\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [-0.0072,  1.2795,  0.7196,  ...,  1.7624,  0.5416,  1.3581],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [ 0.0161,  1.1652,  0.8424,  ...,  1.7489,  0.4522,  1.3486],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`         [ 0.0740,  1.1383,  0.8843,  ...,  1.5847,  0.5283,  1.3112]]],\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`       grad_fn=<AddBackward0>)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Patch embeddings, class token prepended and positional embeddings added shape: torch.Size([1, 197, 768]) -> [batch_size, number_of_patches, embedding_dimension]\n`})]})}),`\n`,(0,n.jsx)(e.h3,{id:\"um-resumo-sobre-tudo\",children:\"Um resumo sobre tudo\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"set_seeds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 1. Defina o tamanho do patch\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"patch_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 2. Imprima a forma do tensor da imagem original e obtenha as dimens\\xF5es da imagem\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Image tensor shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"height\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" width \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 3. Obtenha o tensor de imagem e adicione a dimens\\xE3o do lote\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"x \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"unsqueeze\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Input image with batch dimension shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 4. Crie uma camada de incorpora\\xE7\\xE3o de patch\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"patch_embedding_layer \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" PatchEmbedding\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"in_channels\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                       patch_size\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"patch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                       embedding_dim\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"768\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 5. Passe a imagem pela camada de incorpora\\xE7\\xE3o de patch\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"patch_embedding \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" patch_embedding_layer\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Patching embedding shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"patch_embedding\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 6. Crie incorpora\\xE7\\xE3o de token de classe\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"batch_size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" patch_embedding\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"embedding_dimension \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" patch_embedding\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"class_token \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" nn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Parameter\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"torch\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ones\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"batch_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" embedding_dimension\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                           requires_grad\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),` \n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Class token embedding shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"class_token\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 7. Anexe a incorpora\\xE7\\xE3o de token de classe \\xE0 incorpora\\xE7\\xE3o de patch\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"patch_embedding_class_token \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" torch\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"cat\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"class_token\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" patch_embedding\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" dim\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Patch embedding with class token shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"patch_embedding_class_token\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 8. Criar incorpora\\xE7\\xE3o de posi\\xE7\\xE3o\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"number_of_patches \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"height \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\" width\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"/\"}),\" patch_size\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"**\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"position_embedding \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" nn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Parameter\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"torch\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ones\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" number_of_patches\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" embedding_dimension\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                  requires_grad\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),` \n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 9. Adicione incorpora\\xE7\\xE3o de posi\\xE7\\xE3o \\xE0 incorpora\\xE7\\xE3o de patch com token de classe\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"patch_and_position_embedding \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" patch_embedding_class_token \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),` position_embedding\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Patch and position embedding shape: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"patch_and_position_embedding\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})})]})}function y(a={}){let{wrapper:e}=a.components||{};return e?(0,n.jsx)(e,Object.assign({},a,{children:(0,n.jsx)(d,a)})):d(a)}var w=y;function t(a,e){throw new Error(\"Expected \"+(e?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return f(x);})();\n;return Component;"
    },
    "_id": "blog/patchs.mdx",
    "_raw": {
      "sourceFilePath": "blog/patchs.mdx",
      "sourceFileName": "patchs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/patchs"
    },
    "type": "Post",
    "slug": "patchs",
    "image": "/blog/patchs/image.jpeg",
    "og": "/blog/patchs/image.jpeg"
  },
  {
    "title": "Como precificar um projeto",
    "summary": "Como precificar um projeto ?",
    "publishedAt": "2023-08-01",
    "tags": [
      "Money",
      "Project"
    ],
    "shortTitle": "money",
    "body": {
      "raw": "\n## Como precificar um projeto ?\n\n* Ao longo do processo, inicia-se com uma reunião para discutir as necessidades do cliente. \nNesse encontro, são abordados tópicos como o que o cliente precisa, quais são \nseus objetivos de saída e quais expectativas ele possui. Entretanto, é possível \nque essa discussão evolua para uma segunda e até mesmo terceira reunião, seguindo \nesse padrão.\n\n* O designer ou engenheiro assimila todas essas informações e elabora um MVP \n(Produto Mínimo Viável), assemelhando-se a um presente ou pacote, que é então\n enviado para avaliação do cliente. Somente após a análise e feedback do cliente, \n inicia-se o processo de precificação. A duração desse processo pode variar, \n sendo mais ágil ou demorado dependendo da complexidade do problema ou do \n produto em questão.\n\n* É crucial que o seu produto seja específico e de fácil compreensão quanto ao que exatamente oferece.\n* Contudo, a parte mais significativa é o preço; se você conhece o valor do produto, automaticamente se sente mais confortável.\n* É semelhante a procurar casas para comprar. Como de costume, você já conhece os preços das casas e tem critérios, mas, em geral, o fator financeiro não é o critério principal, pois você já tem um limite de orçamento ou uma média de preços das casas que está visitando. Se fosse muito caro, nem mesmo consideraria visitar.\nAssim, para o cliente, quanto mais rapidamente ele obtiver uma resposta sobre o preço, mais confortável ele se sentirá.\n\n* A pergunta fundamental a ser feita é: por que você busca este produto? A resposta, \ninvariavelmente, é impulsionar as vendas. Independentemente do motivo secundário, o \ncliente deseja vender mais. Portanto, durante a conversa, é crucial focar em termos \nde DINHEIRO e PROBLEMA. É fundamental permanecer o máximo possível na fase de diagnóstico, \nexplorando e compreendendo a fundo os desafios e obstáculos específicos que o \ncliente enfrenta. Este enfoque direcionado permite uma abordagem mais eficaz na resolução \ndos problemas, alinhando-se diretamente aos objetivos do cliente de aumentar suas vendas.\n\n* Cliente, você deseja vender mais. Quanto mais exatamente? Qual é o preço do seu produto? \nQuanto você ganhará com esse valor adicional, \nseja R$ 10.000, R$ 100.000 por mês, ou por ano? Estou aqui para ajudar, e preciso \nentender como chegar a 1,2 vezes a renda. Em quantos meses isso vai custar?\n\n* Agora, entramos nas métricas, as chamadas METRICAS DE SUCESSO, KPI... Se o produto não pode ser medido por métricas claras, \ncomo uma marca ou logotipo, \na pergunta fundamental a ser feita é: Por que você quer esse produto? Ele realmente ajudará você a ganhar mais.\n\n> A partir da minha experiência, os clientes muitas vezes procuram um logotipo por \nrazões X, Y, Z, mas, na realidade, o logotipo em si não é a solução definitiva, e \nnem sempre a criação do meu produto resolverá o problema de vender mais.\n\nAgora, imagine que meu cliente deseja um logotipo, mas para quê? Ser notado. No entanto, existem \noutras maneiras de alcançar isso, como marketing, mídia social, branding. Após considerar todas essas opções, \nquestionamos se ter um logotipo ainda é a escolha mais relevante. Deixe o cliente decidir. O essencial é resolver o\nproblema do cliente primeiro e, em seguida, avaliar se o nosso produto é a melhor opção para ele. Nunca tome a decisão por ele.\n\nPare de se vender e comece a servir.\nSe o cliente decidir que ainda quer um logotipo, então é crucial apresentar uma visão. Os clientes muitas vezes \ntêm dificuldade em imaginar, então mostre como o logotipo se integra ao dia a dia deles, aos produtos e outros aspectos.\n\n**Nunca faça perguntas abertas, seja sempre específico.**\n\n<LinkPreview\n  imageUrl=\"https://yt3.googleusercontent.com/ytc/AIf8zZQgYdD6A4ti0x1PhcWHnpaCdccd04G-kLRkpc51iA=s176-c-k-c0x00ffffff-no-rj\"\n  title=\"How To Price YOUR Work (Full Whiteboard AdobeMAX)\"\n  description=\"Why do some people almost always land the deal?\"\n  link=\"https://youtu.be/6rZQPhXGOlk?si=seq3wEJZrgCrnUrT\"\n/>\n",
      "code": "var Component=(()=>{var l=Object.create;var r=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty;var v=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports),g=(a,e)=>{for(var n in e)r(a,n,{get:e[n],enumerable:!0})},t=(a,e,n,i)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let s of p(e))!f.call(a,s)&&s!==n&&r(a,s,{get:()=>e[s],enumerable:!(i=u(e,s))||i.enumerable});return a};var b=(a,e,n)=>(n=a!=null?l(h(a)):{},t(e||!a||!a.__esModule?r(n,\"default\",{value:a,enumerable:!0}):n,a)),q=a=>t(r({},\"__esModule\",{value:!0}),a);var d=v((C,c)=>{c.exports=_jsx_runtime});var E={};g(E,{default:()=>A,frontmatter:()=>j});var o=b(d()),j={title:\"Como precificar um projeto\",publishedAt:\"2023-08-01\",summary:\"Como precificar um projeto ?\",tags:[\"Money\",\"Project\"],shortTitle:\"money\"};function m(a){let e=Object.assign({h2:\"h2\",ul:\"ul\",li:\"li\",p:\"p\",code:\"code\",blockquote:\"blockquote\",strong:\"strong\"},a.components),{LinkPreview:n}=e;return n||k(\"LinkPreview\",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h2,{id:\"como-precificar-um-projeto-\",children:\"Como precificar um projeto ?\"}),`\n`,(0,o.jsxs)(e.ul,{children:[`\n`,(0,o.jsxs)(e.li,{children:[`\n`,(0,o.jsx)(e.p,{children:`Ao longo do processo, inicia-se com uma reuni\\xE3o para discutir as necessidades do cliente.\nNesse encontro, s\\xE3o abordados t\\xF3picos como o que o cliente precisa, quais s\\xE3o\nseus objetivos de sa\\xEDda e quais expectativas ele possui. Entretanto, \\xE9 poss\\xEDvel\nque essa discuss\\xE3o evolua para uma segunda e at\\xE9 mesmo terceira reuni\\xE3o, seguindo\nesse padr\\xE3o.`}),`\n`]}),`\n`,(0,o.jsxs)(e.li,{children:[`\n`,(0,o.jsx)(e.p,{children:`O designer ou engenheiro assimila todas essas informa\\xE7\\xF5es e elabora um MVP\n(Produto M\\xEDnimo Vi\\xE1vel), assemelhando-se a um presente ou pacote, que \\xE9 ent\\xE3o\nenviado para avalia\\xE7\\xE3o do cliente. Somente ap\\xF3s a an\\xE1lise e feedback do cliente,\ninicia-se o processo de precifica\\xE7\\xE3o. A dura\\xE7\\xE3o desse processo pode variar,\nsendo mais \\xE1gil ou demorado dependendo da complexidade do problema ou do\nproduto em quest\\xE3o.`}),`\n`]}),`\n`,(0,o.jsxs)(e.li,{children:[`\n`,(0,o.jsx)(e.p,{children:\"\\xC9 crucial que o seu produto seja espec\\xEDfico e de f\\xE1cil compreens\\xE3o quanto ao que exatamente oferece.\"}),`\n`]}),`\n`,(0,o.jsxs)(e.li,{children:[`\n`,(0,o.jsx)(e.p,{children:\"Contudo, a parte mais significativa \\xE9 o pre\\xE7o; se voc\\xEA conhece o valor do produto, automaticamente se sente mais confort\\xE1vel.\"}),`\n`]}),`\n`,(0,o.jsxs)(e.li,{children:[`\n`,(0,o.jsx)(e.p,{children:`\\xC9 semelhante a procurar casas para comprar. Como de costume, voc\\xEA j\\xE1 conhece os pre\\xE7os das casas e tem crit\\xE9rios, mas, em geral, o fator financeiro n\\xE3o \\xE9 o crit\\xE9rio principal, pois voc\\xEA j\\xE1 tem um limite de or\\xE7amento ou uma m\\xE9dia de pre\\xE7os das casas que est\\xE1 visitando. Se fosse muito caro, nem mesmo consideraria visitar.\nAssim, para o cliente, quanto mais rapidamente ele obtiver uma resposta sobre o pre\\xE7o, mais confort\\xE1vel ele se sentir\\xE1.`}),`\n`]}),`\n`,(0,o.jsxs)(e.li,{children:[`\n`,(0,o.jsx)(e.p,{children:`A pergunta fundamental a ser feita \\xE9: por que voc\\xEA busca este produto? A resposta,\ninvariavelmente, \\xE9 impulsionar as vendas. Independentemente do motivo secund\\xE1rio, o\ncliente deseja vender mais. Portanto, durante a conversa, \\xE9 crucial focar em termos\nde DINHEIRO e PROBLEMA. \\xC9 fundamental permanecer o m\\xE1ximo poss\\xEDvel na fase de diagn\\xF3stico,\nexplorando e compreendendo a fundo os desafios e obst\\xE1culos espec\\xEDficos que o\ncliente enfrenta. Este enfoque direcionado permite uma abordagem mais eficaz na resolu\\xE7\\xE3o\ndos problemas, alinhando-se diretamente aos objetivos do cliente de aumentar suas vendas.`}),`\n`]}),`\n`,(0,o.jsxs)(e.li,{children:[`\n`,(0,o.jsxs)(e.p,{children:[`Cliente, voc\\xEA deseja vender mais. Quanto mais exatamente? Qual \\xE9 o pre\\xE7o do seu produto?\nQuanto voc\\xEA ganhar\\xE1 com esse valor adicional,\nseja R`,(0,o.jsx)(e.code,{className:\"language-math math-inline\",children:\" 10.000, R\"}),` 100.000 por m\\xEAs, ou por ano? Estou aqui para ajudar, e preciso\nentender como chegar a 1,2 vezes a renda. Em quantos meses isso vai custar?`]}),`\n`]}),`\n`,(0,o.jsxs)(e.li,{children:[`\n`,(0,o.jsx)(e.p,{children:`Agora, entramos nas m\\xE9tricas, as chamadas METRICAS DE SUCESSO, KPI... Se o produto n\\xE3o pode ser medido por m\\xE9tricas claras,\ncomo uma marca ou logotipo,\na pergunta fundamental a ser feita \\xE9: Por que voc\\xEA quer esse produto? Ele realmente ajudar\\xE1 voc\\xEA a ganhar mais.`}),`\n`]}),`\n`]}),`\n`,(0,o.jsxs)(e.blockquote,{children:[`\n`,(0,o.jsx)(e.p,{children:`A partir da minha experi\\xEAncia, os clientes muitas vezes procuram um logotipo por\nraz\\xF5es X, Y, Z, mas, na realidade, o logotipo em si n\\xE3o \\xE9 a solu\\xE7\\xE3o definitiva, e\nnem sempre a cria\\xE7\\xE3o do meu produto resolver\\xE1 o problema de vender mais.`}),`\n`]}),`\n`,(0,o.jsx)(e.p,{children:`Agora, imagine que meu cliente deseja um logotipo, mas para qu\\xEA? Ser notado. No entanto, existem\noutras maneiras de alcan\\xE7ar isso, como marketing, m\\xEDdia social, branding. Ap\\xF3s considerar todas essas op\\xE7\\xF5es,\nquestionamos se ter um logotipo ainda \\xE9 a escolha mais relevante. Deixe o cliente decidir. O essencial \\xE9 resolver o\nproblema do cliente primeiro e, em seguida, avaliar se o nosso produto \\xE9 a melhor op\\xE7\\xE3o para ele. Nunca tome a decis\\xE3o por ele.`}),`\n`,(0,o.jsx)(e.p,{children:`Pare de se vender e comece a servir.\nSe o cliente decidir que ainda quer um logotipo, ent\\xE3o \\xE9 crucial apresentar uma vis\\xE3o. Os clientes muitas vezes\nt\\xEAm dificuldade em imaginar, ent\\xE3o mostre como o logotipo se integra ao dia a dia deles, aos produtos e outros aspectos.`}),`\n`,(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:\"Nunca fa\\xE7a perguntas abertas, seja sempre espec\\xEDfico.\"})}),`\n`,(0,o.jsx)(n,{imageUrl:\"https://yt3.googleusercontent.com/ytc/AIf8zZQgYdD6A4ti0x1PhcWHnpaCdccd04G-kLRkpc51iA=s176-c-k-c0x00ffffff-no-rj\",title:\"How To Price YOUR Work (Full Whiteboard AdobeMAX)\",description:\"Why do some people almost always land the deal?\",link:\"https://youtu.be/6rZQPhXGOlk?si=seq3wEJZrgCrnUrT\"})]})}function x(a={}){let{wrapper:e}=a.components||{};return e?(0,o.jsx)(e,Object.assign({},a,{children:(0,o.jsx)(m,a)})):m(a)}var A=x;function k(a,e){throw new Error(\"Expected \"+(e?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return q(E);})();\n;return Component;"
    },
    "_id": "blog/price.mdx",
    "_raw": {
      "sourceFilePath": "blog/price.mdx",
      "sourceFileName": "price.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/price"
    },
    "type": "Post",
    "slug": "price",
    "image": "/blog/price/image.jpeg",
    "og": "/blog/price/image.jpeg"
  },
  {
    "title": "Criando tensores com Pytorch",
    "summary": "Conceitos fundamentais do Pytorch",
    "publishedAt": "2024-02-13",
    "tags": [
      "Pytorch"
    ],
    "shortTitle": "Pytorch",
    "body": {
      "raw": "\n# Pytorch - Criando tensores\n\n## Introdução a Tensores\n\nTensores são uma forma de representar dados numericamente. Esses dados podem ser qualquer coisa, texto, imagem, audio e etc. Existe uma pagina inteira no Pytorch dedicada a tensores, [aqui](https://pytorch.org/docs/stable/tensors.html).\n\n## Criando tensores\n\nTodos os dados podem ser representados de forma numérica, por exemplo, uma imagem pode ser representado de formar `[3, 224, 224]`. Onde o primeiro valor é a quantidade de canais, o segundo e terceiro são a altura e largura da imagem. Nesse mesmo exemplo o tensor teria 3 dimensões.\n\n### Escalar\n\nA primeira forma, por assim dizer, de um tensor é um escalar, seria um tensor com dimensão zero.\n\n```python\nscalar = torch.tensor(7)\nscalar\n```\n\n```txt\noutput: tensor(7)\n```\n\nEmbora se somente um único número é do tipo `Tensor`\n\nA partir desse numero podemos extrair informações como o tipo de dado que ele armazena, o tipo de dispositivo que ele está armazenado e etc.\n\n```python\nscalar.ndim # dimensao\nscalar.item() # transforma o tensor em um numero\nscalar.dtype # tipo de dado\nscalar.device # dispositivo que o tensor esta armazenado\n```\n\n### Vetor\n\nAgora, um vetor é um tensor de dimensão única. Mas que pode ter muitos valores\ncomo `[1, 2]`, `[1, 3, 5]`e por assim vai. Esse vetor pode representar qualquer coisa, como`[quartos, banheiros]`.\n\n<Alert type=\"attention\">\nA importância dos vetores é que são flexíveis.\n</Alert>\n\n```python\n# Vector\nvector = torch.tensor([7, 7])\nvector\n```\n\n```txt\noutput: tensor([7, 7])\n```\n\nAgora esse vetor tem somente uma dimensão, ao usar `vector.ndim`, o retorno será 1. Podemos saber a dimensão do tensor contando o número de `[`.\n\nOutra coisa importante sobre os vetores é o atributo `shape`, que retorna como os elementos dentro dele são organizados.\n\n```python\nvector.shape\n```\n\nO retorno é `torch.Size([2])`, pois possui dois valores dentro dele.\n\n### Matriz\n\n```python\n# Matrix\nMATRIX = torch.tensor([[7, 8],\n                       [9, 10]])\nMATRIX\n```\n\nSão flexíveis iguais aos tensores, mas com uma dimensão a mais. Para saber sua dimensão, basta usar `matrix.ndim`.\n\nJá o seu `shape` utilizando `MATRIX.shape`.\n\n```python\nMATRIX.shape\nOut: torch.Size([2, 2])\n```\n\nPois retorna 2 linhas e 2 colunas.\n\n<Image rounded width={800} height={600} caption=\"types\" src=\"/blog/pytorch/types.png\" />\n\n### Tensores\n\n```python\nTENSOR = torch.tensor([[[1, 2, 3],\n                        [3, 6, 9],\n                        [2, 4, 5]]])\nTENSOR\n```\n\n```txt\nOut: tensor([[[1, 2, 3],\n         [3, 6, 9],\n         [2, 4, 5]]])\n```\n\nPara saber a dimensão e o tamanho basta usar os mesmos comandos:\n\n```python\nTENSOR.ndim\nTENSOR.shape\n```\n\n<Image rounded width={800} height={600} caption=\"Tensor\" src=\"/blog/pytorch/tensor.png\" />\n",
      "code": "var Component=(()=>{var cn=Object.create;var j=Object.defineProperty;var un=Object.getOwnPropertyDescriptor;var mn=Object.getOwnPropertyNames;var fn=Object.getPrototypeOf,bn=Object.prototype.hasOwnProperty;var X=(d,n)=>()=>(n||d((n={exports:{}}).exports,n),n.exports),_n=(d,n)=>{for(var f in n)j(d,f,{get:n[f],enumerable:!0})},ye=(d,n,f,p)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let g of mn(n))!bn.call(d,g)&&g!==f&&j(d,g,{get:()=>n[g],enumerable:!(p=un(n,g))||p.enumerable});return d};var Nn=(d,n,f)=>(f=d!=null?cn(fn(d)):{},ye(n||!d||!d.__esModule?j(f,\"default\",{value:d,enumerable:!0}):f,d)),pn=d=>ye(j({},\"__esModule\",{value:!0}),d);var De=X((Dn,we)=>{we.exports=React});var ve=X(B=>{\"use strict\";(function(){\"use strict\";var d=De(),n=Symbol.for(\"react.element\"),f=Symbol.for(\"react.portal\"),p=Symbol.for(\"react.fragment\"),g=Symbol.for(\"react.strict_mode\"),G=Symbol.for(\"react.profiler\"),K=Symbol.for(\"react.provider\"),H=Symbol.for(\"react.context\"),E=Symbol.for(\"react.forward_ref\"),A=Symbol.for(\"react.suspense\"),F=Symbol.for(\"react.suspense_list\"),R=Symbol.for(\"react.memo\"),I=Symbol.for(\"react.lazy\"),Te=Symbol.for(\"react.offscreen\"),J=Symbol.iterator,Oe=\"@@iterator\";function Pe(e){if(e===null||typeof e!=\"object\")return null;var l=J&&e[J]||e[Oe];return typeof l==\"function\"?l:null}var w=d.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function b(e){{for(var l=arguments.length,o=new Array(l>1?l-1:0),i=1;i<l;i++)o[i-1]=arguments[i];Ce(\"error\",e,o)}}function Ce(e,l,o){{var i=w.ReactDebugCurrentFrame,t=i.getStackAddendum();t!==\"\"&&(l+=\"%s\",o=o.concat([t]));var c=o.map(function(r){return String(r)});c.unshift(\"Warning: \"+l),Function.prototype.apply.call(console[e],console,c)}}var Se=!1,je=!1,Ae=!1,Fe=!1,Ie=!1,Z;Z=Symbol.for(\"react.module.reference\");function Me(e){return!!(typeof e==\"string\"||typeof e==\"function\"||e===p||e===G||Ie||e===g||e===A||e===F||Fe||e===Te||Se||je||Ae||typeof e==\"object\"&&e!==null&&(e.$$typeof===I||e.$$typeof===R||e.$$typeof===K||e.$$typeof===H||e.$$typeof===E||e.$$typeof===Z||e.getModuleId!==void 0))}function Ye(e,l,o){var i=e.displayName;if(i)return i;var t=l.displayName||l.name||\"\";return t!==\"\"?o+\"(\"+t+\")\":o}function Q(e){return e.displayName||\"Context\"}function h(e){if(e==null)return null;if(typeof e.tag==\"number\"&&b(\"Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue.\"),typeof e==\"function\")return e.displayName||e.name||null;if(typeof e==\"string\")return e;switch(e){case p:return\"Fragment\";case f:return\"Portal\";case G:return\"Profiler\";case g:return\"StrictMode\";case A:return\"Suspense\";case F:return\"SuspenseList\"}if(typeof e==\"object\")switch(e.$$typeof){case H:var l=e;return Q(l)+\".Consumer\";case K:var o=e;return Q(o._context)+\".Provider\";case E:return Ye(e,e.render,\"ForwardRef\");case R:var i=e.displayName||null;return i!==null?i:h(e.type)||\"Memo\";case I:{var t=e,c=t._payload,r=t._init;try{return h(r(c))}catch{return null}}}return null}var y=Object.assign,U=0,ee,ne,ae,le,oe,ie,se;function re(){}re.__reactDisabledLog=!0;function $e(){{if(U===0){ee=console.log,ne=console.info,ae=console.warn,le=console.error,oe=console.group,ie=console.groupCollapsed,se=console.groupEnd;var e={configurable:!0,enumerable:!0,value:re,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}U++}}function Ve(){{if(U--,U===0){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:y({},e,{value:ee}),info:y({},e,{value:ne}),warn:y({},e,{value:ae}),error:y({},e,{value:le}),group:y({},e,{value:oe}),groupCollapsed:y({},e,{value:ie}),groupEnd:y({},e,{value:se})})}U<0&&b(\"disabledDepth fell below zero. This is a bug in React. Please file an issue.\")}}var M=w.ReactCurrentDispatcher,Y;function T(e,l,o){{if(Y===void 0)try{throw Error()}catch(t){var i=t.stack.trim().match(/\\n( *(at )?)/);Y=i&&i[1]||\"\"}return`\n`+Y+e}}var $=!1,O;{var We=typeof WeakMap==\"function\"?WeakMap:Map;O=new We}function te(e,l){if(!e||$)return\"\";{var o=O.get(e);if(o!==void 0)return o}var i;$=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var c;c=M.current,M.current=null,$e();try{if(l){var r=function(){throw Error()};if(Object.defineProperty(r.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(r,[])}catch(x){i=x}Reflect.construct(e,[],r)}else{try{r.call()}catch(x){i=x}e.call(r.prototype)}}else{try{throw Error()}catch(x){i=x}e()}}catch(x){if(x&&i&&typeof x.stack==\"string\"){for(var s=x.stack.split(`\n`),_=i.stack.split(`\n`),u=s.length-1,m=_.length-1;u>=1&&m>=0&&s[u]!==_[m];)m--;for(;u>=1&&m>=0;u--,m--)if(s[u]!==_[m]){if(u!==1||m!==1)do if(u--,m--,m<0||s[u]!==_[m]){var N=`\n`+s[u].replace(\" at new \",\" at \");return e.displayName&&N.includes(\"<anonymous>\")&&(N=N.replace(\"<anonymous>\",e.displayName)),typeof e==\"function\"&&O.set(e,N),N}while(u>=1&&m>=0);break}}}finally{$=!1,M.current=c,Ve(),Error.prepareStackTrace=t}var v=e?e.displayName||e.name:\"\",ge=v?T(v):\"\";return typeof e==\"function\"&&O.set(e,ge),ge}function qe(e,l,o){return te(e,!1)}function ze(e){var l=e.prototype;return!!(l&&l.isReactComponent)}function P(e,l,o){if(e==null)return\"\";if(typeof e==\"function\")return te(e,ze(e));if(typeof e==\"string\")return T(e);switch(e){case A:return T(\"Suspense\");case F:return T(\"SuspenseList\")}if(typeof e==\"object\")switch(e.$$typeof){case E:return qe(e.render);case R:return P(e.type,l,o);case I:{var i=e,t=i._payload,c=i._init;try{return P(c(t),l,o)}catch{}}}return\"\"}var C=Object.prototype.hasOwnProperty,de={},ce=w.ReactDebugCurrentFrame;function S(e){if(e){var l=e._owner,o=P(e.type,e._source,l?l.type:null);ce.setExtraStackFrame(o)}else ce.setExtraStackFrame(null)}function Le(e,l,o,i,t){{var c=Function.call.bind(C);for(var r in e)if(c(e,r)){var s=void 0;try{if(typeof e[r]!=\"function\"){var _=Error((i||\"React class\")+\": \"+o+\" type `\"+r+\"` is invalid; it must be a function, usually from the `prop-types` package, but received `\"+typeof e[r]+\"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.\");throw _.name=\"Invariant Violation\",_}s=e[r](l,r,i,o,null,\"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED\")}catch(u){s=u}s&&!(s instanceof Error)&&(S(t),b(\"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).\",i||\"React class\",o,r,typeof s),S(null)),s instanceof Error&&!(s.message in de)&&(de[s.message]=!0,S(t),b(\"Failed %s type: %s\",o,s.message),S(null))}}}var Xe=Array.isArray;function V(e){return Xe(e)}function Be(e){{var l=typeof Symbol==\"function\"&&Symbol.toStringTag,o=l&&e[Symbol.toStringTag]||e.constructor.name||\"Object\";return o}}function Ge(e){try{return ue(e),!1}catch{return!0}}function ue(e){return\"\"+e}function me(e){if(Ge(e))return b(\"The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.\",Be(e)),ue(e)}var k=w.ReactCurrentOwner,Ke={key:!0,ref:!0,__self:!0,__source:!0},fe,be,W;W={};function He(e){if(C.call(e,\"ref\")){var l=Object.getOwnPropertyDescriptor(e,\"ref\").get;if(l&&l.isReactWarning)return!1}return e.ref!==void 0}function Je(e){if(C.call(e,\"key\")){var l=Object.getOwnPropertyDescriptor(e,\"key\").get;if(l&&l.isReactWarning)return!1}return e.key!==void 0}function Ze(e,l){if(typeof e.ref==\"string\"&&k.current&&l&&k.current.stateNode!==l){var o=h(k.current.type);W[o]||(b('Component \"%s\" contains the string ref \"%s\". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',h(k.current.type),e.ref),W[o]=!0)}}function Qe(e,l){{var o=function(){fe||(fe=!0,b(\"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",l))};o.isReactWarning=!0,Object.defineProperty(e,\"key\",{get:o,configurable:!0})}}function en(e,l){{var o=function(){be||(be=!0,b(\"%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",l))};o.isReactWarning=!0,Object.defineProperty(e,\"ref\",{get:o,configurable:!0})}}var nn=function(e,l,o,i,t,c,r){var s={$$typeof:n,type:e,key:l,ref:o,props:r,_owner:c};return s._store={},Object.defineProperty(s._store,\"validated\",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(s,\"_self\",{configurable:!1,enumerable:!1,writable:!1,value:i}),Object.defineProperty(s,\"_source\",{configurable:!1,enumerable:!1,writable:!1,value:t}),Object.freeze&&(Object.freeze(s.props),Object.freeze(s)),s};function an(e,l,o,i,t){{var c,r={},s=null,_=null;o!==void 0&&(me(o),s=\"\"+o),Je(l)&&(me(l.key),s=\"\"+l.key),He(l)&&(_=l.ref,Ze(l,t));for(c in l)C.call(l,c)&&!Ke.hasOwnProperty(c)&&(r[c]=l[c]);if(e&&e.defaultProps){var u=e.defaultProps;for(c in u)r[c]===void 0&&(r[c]=u[c])}if(s||_){var m=typeof e==\"function\"?e.displayName||e.name||\"Unknown\":e;s&&Qe(r,m),_&&en(r,m)}return nn(e,s,_,t,i,k.current,r)}}var q=w.ReactCurrentOwner,_e=w.ReactDebugCurrentFrame;function D(e){if(e){var l=e._owner,o=P(e.type,e._source,l?l.type:null);_e.setExtraStackFrame(o)}else _e.setExtraStackFrame(null)}var z;z=!1;function L(e){return typeof e==\"object\"&&e!==null&&e.$$typeof===n}function Ne(){{if(q.current){var e=h(q.current.type);if(e)return`\n\nCheck the render method of \\``+e+\"`.\"}return\"\"}}function ln(e){{if(e!==void 0){var l=e.fileName.replace(/^.*[\\\\\\/]/,\"\"),o=e.lineNumber;return`\n\nCheck your code at `+l+\":\"+o+\".\"}return\"\"}}var pe={};function on(e){{var l=Ne();if(!l){var o=typeof e==\"string\"?e:e.displayName||e.name;o&&(l=`\n\nCheck the top-level render call using <`+o+\">.\")}return l}}function he(e,l){{if(!e._store||e._store.validated||e.key!=null)return;e._store.validated=!0;var o=on(l);if(pe[o])return;pe[o]=!0;var i=\"\";e&&e._owner&&e._owner!==q.current&&(i=\" It was passed a child from \"+h(e._owner.type)+\".\"),D(e),b('Each child in a list should have a unique \"key\" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',o,i),D(null)}}function xe(e,l){{if(typeof e!=\"object\")return;if(V(e))for(var o=0;o<e.length;o++){var i=e[o];L(i)&&he(i,l)}else if(L(e))e._store&&(e._store.validated=!0);else if(e){var t=Pe(e);if(typeof t==\"function\"&&t!==e.entries)for(var c=t.call(e),r;!(r=c.next()).done;)L(r.value)&&he(r.value,l)}}}function sn(e){{var l=e.type;if(l==null||typeof l==\"string\")return;var o;if(typeof l==\"function\")o=l.propTypes;else if(typeof l==\"object\"&&(l.$$typeof===E||l.$$typeof===R))o=l.propTypes;else return;if(o){var i=h(l);Le(o,e.props,\"prop\",i,e)}else if(l.PropTypes!==void 0&&!z){z=!0;var t=h(l);b(\"Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?\",t||\"Unknown\")}typeof l.getDefaultProps==\"function\"&&!l.getDefaultProps.isReactClassApproved&&b(\"getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.\")}}function rn(e){{for(var l=Object.keys(e.props),o=0;o<l.length;o++){var i=l[o];if(i!==\"children\"&&i!==\"key\"){D(e),b(\"Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.\",i),D(null);break}}e.ref!==null&&(D(e),b(\"Invalid attribute `ref` supplied to `React.Fragment`.\"),D(null))}}function tn(e,l,o,i,t,c){{var r=Me(e);if(!r){var s=\"\";(e===void 0||typeof e==\"object\"&&e!==null&&Object.keys(e).length===0)&&(s+=\" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.\");var _=ln(t);_?s+=_:s+=Ne();var u;e===null?u=\"null\":V(e)?u=\"array\":e!==void 0&&e.$$typeof===n?(u=\"<\"+(h(e.type)||\"Unknown\")+\" />\",s=\" Did you accidentally export a JSX literal instead of a component?\"):u=typeof e,b(\"React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s\",u,s)}var m=an(e,l,o,t,c);if(m==null)return m;if(r){var N=l.children;if(N!==void 0)if(i)if(V(N)){for(var v=0;v<N.length;v++)xe(N[v],e);Object.freeze&&Object.freeze(N)}else b(\"React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.\");else xe(N,e)}return e===p?rn(m):sn(m),m}}var dn=tn;B.Fragment=p,B.jsxDEV=dn})()});var ke=X((Un,Ue)=>{\"use strict\";Ue.exports=ve()});var yn={};_n(yn,{default:()=>gn,frontmatter:()=>hn});var a=Nn(ke()),hn={title:\"Criando tensores com Pytorch\",publishedAt:\"2024-02-13\",summary:\"Conceitos fundamentais do Pytorch\",tags:[\"Pytorch\"],shortTitle:\"Pytorch\"};function Ee(d){let n=Object.assign({h1:\"h1\",h2:\"h2\",p:\"p\",a:\"a\",code:\"code\",h3:\"h3\",pre:\"pre\",span:\"span\"},d.components),{Alert:f,Image:p}=n;return f||Re(\"Alert\",!0,\"48:1-50:9\"),p||Re(\"Image\",!0,\"92:1-92:89\"),(0,a.jsxDEV)(a.Fragment,{children:[(0,a.jsxDEV)(n.h1,{id:\"pytorch---criando-tensores\",children:\"Pytorch - Criando tensores\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:9,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.h2,{id:\"introdu\\xE7\\xE3o-a-tensores\",children:\"Introdu\\xE7\\xE3o a Tensores\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:11,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.p,{children:[\"Tensores s\\xE3o uma forma de representar dados numericamente. Esses dados podem ser qualquer coisa, texto, imagem, audio e etc. Existe uma pagina inteira no Pytorch dedicada a tensores, \",(0,a.jsxDEV)(n.a,{href:\"https://pytorch.org/docs/stable/tensors.html\",children:\"aqui\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:13,columnNumber:184},this),\".\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:13,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.h2,{id:\"criando-tensores\",children:\"Criando tensores\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:15,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.p,{children:[\"Todos os dados podem ser representados de forma num\\xE9rica, por exemplo, uma imagem pode ser representado de formar \",(0,a.jsxDEV)(n.code,{children:\"[3, 224, 224]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:17,columnNumber:115},this),\". Onde o primeiro valor \\xE9 a quantidade de canais, o segundo e terceiro s\\xE3o a altura e largura da imagem. Nesse mesmo exemplo o tensor teria 3 dimens\\xF5es.\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:17,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.h3,{id:\"escalar\",children:\"Escalar\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:19,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.p,{children:\"A primeira forma, por assim dizer, de um tensor \\xE9 um escalar, seria um tensor com dimens\\xE3o zero.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:21,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.pre,{className:\"language-python\",children:(0,a.jsxDEV)(n.code,{className:\"language-python code-highlight\",children:[(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[\"scalar \",(0,a.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),\" torch\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),\"tensor\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"7\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this),(0,a.jsxDEV)(n.span,{className:\"code-line\",children:`scalar\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:23,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:23,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.pre,{className:\"language-txt\",children:(0,a.jsxDEV)(n.code,{className:\"language-txt code-highlight\",children:(0,a.jsxDEV)(n.span,{className:\"code-line\",children:`output: tensor(7)\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:28,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:28,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.p,{children:[\"Embora se somente um \\xFAnico n\\xFAmero \\xE9 do tipo \",(0,a.jsxDEV)(n.code,{children:\"Tensor\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:32,columnNumber:45},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:32,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.p,{children:\"A partir desse numero podemos extrair informa\\xE7\\xF5es como o tipo de dado que ele armazena, o tipo de dispositivo que ele est\\xE1 armazenado e etc.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:34,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.pre,{className:\"language-python\",children:(0,a.jsxDEV)(n.code,{className:\"language-python code-highlight\",children:[(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[\"scalar\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),\"ndim \",(0,a.jsxDEV)(n.span,{className:\"token comment\",children:\"# dimensao\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this),(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[\"scalar\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),\"item\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),\" \",(0,a.jsxDEV)(n.span,{className:\"token comment\",children:\"# transforma o tensor em um numero\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this),(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[\"scalar\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),\"dtype \",(0,a.jsxDEV)(n.span,{className:\"token comment\",children:\"# tipo de dado\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this),(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[\"scalar\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:4,columnNumber:1},this),\"device \",(0,a.jsxDEV)(n.span,{className:\"token comment\",children:\"# dispositivo que o tensor esta armazenado\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:4,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:36,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:36,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.h3,{id:\"vetor\",children:\"Vetor\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:43,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.p,{children:[`Agora, um vetor \\xE9 um tensor de dimens\\xE3o \\xFAnica. Mas que pode ter muitos valores\ncomo `,(0,a.jsxDEV)(n.code,{children:\"[1, 2]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:46,columnNumber:6},this),\", \",(0,a.jsxDEV)(n.code,{children:\"[1, 3, 5]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:46,columnNumber:16},this),\"e por assim vai. Esse vetor pode representar qualquer coisa, como\",(0,a.jsxDEV)(n.code,{children:\"[quartos, banheiros]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:46,columnNumber:92},this),\".\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:45,columnNumber:1},this),`\n`,(0,a.jsxDEV)(f,{type:\"attention\",children:(0,a.jsxDEV)(n.p,{children:\"A import\\xE2ncia dos vetores \\xE9 que s\\xE3o flex\\xEDveis.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:49,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:48,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.pre,{className:\"language-python\",children:(0,a.jsxDEV)(n.code,{className:\"language-python code-highlight\",children:[(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[(0,a.jsxDEV)(n.span,{className:\"token comment\",children:\"# Vector\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this),(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[\"vector \",(0,a.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),\" torch\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),\"tensor\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"[\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"7\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),\" \",(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"7\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this),(0,a.jsxDEV)(n.span,{className:\"code-line\",children:`vector\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:52,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:52,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.pre,{className:\"language-txt\",children:(0,a.jsxDEV)(n.code,{className:\"language-txt code-highlight\",children:(0,a.jsxDEV)(n.span,{className:\"code-line\",children:`output: tensor([7, 7])\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:58,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:58,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.p,{children:[\"Agora esse vetor tem somente uma dimens\\xE3o, ao usar \",(0,a.jsxDEV)(n.code,{children:\"vector.ndim\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:62,columnNumber:52},this),\", o retorno ser\\xE1 1. Podemos saber a dimens\\xE3o do tensor contando o n\\xFAmero de \",(0,a.jsxDEV)(n.code,{children:\"[\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:62,columnNumber:141},this),\".\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:62,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.p,{children:[\"Outra coisa importante sobre os vetores \\xE9 o atributo \",(0,a.jsxDEV)(n.code,{children:\"shape\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:64,columnNumber:54},this),\", que retorna como os elementos dentro dele s\\xE3o organizados.\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:64,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.pre,{className:\"language-python\",children:(0,a.jsxDEV)(n.code,{className:\"language-python code-highlight\",children:(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[\"vector\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),`shape\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:66,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:66,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.p,{children:[\"O retorno \\xE9 \",(0,a.jsxDEV)(n.code,{children:\"torch.Size([2])\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:70,columnNumber:13},this),\", pois possui dois valores dentro dele.\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:70,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.h3,{id:\"matriz\",children:\"Matriz\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:72,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.pre,{className:\"language-python\",children:(0,a.jsxDEV)(n.code,{className:\"language-python code-highlight\",children:[(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[(0,a.jsxDEV)(n.span,{className:\"token comment\",children:\"# Matrix\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this),(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[\"MATRIX \",(0,a.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),\" torch\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),\"tensor\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"[\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"[\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"7\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),\" \",(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"8\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this),(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[\"                       \",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"[\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"9\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),\" \",(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"10\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this),(0,a.jsxDEV)(n.span,{className:\"code-line\",children:`MATRIX\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:74,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:74,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.p,{children:[\"S\\xE3o flex\\xEDveis iguais aos tensores, mas com uma dimens\\xE3o a mais. Para saber sua dimens\\xE3o, basta usar \",(0,a.jsxDEV)(n.code,{children:\"matrix.ndim\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:81,columnNumber:101},this),\".\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:81,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.p,{children:[\"J\\xE1 o seu \",(0,a.jsxDEV)(n.code,{children:\"shape\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:83,columnNumber:10},this),\" utilizando \",(0,a.jsxDEV)(n.code,{children:\"MATRIX.shape\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:83,columnNumber:29},this),\".\"]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:83,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.pre,{className:\"language-python\",children:(0,a.jsxDEV)(n.code,{className:\"language-python code-highlight\",children:[(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[\"MATRIX\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),`shape\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this),(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[\"Out\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\":\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),\" torch\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),\"Size\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"[\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"2\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),\" \",(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"2\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:85,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:85,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.p,{children:\"Pois retorna 2 linhas e 2 colunas.\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:90,columnNumber:1},this),`\n`,(0,a.jsxDEV)(p,{rounded:!0,width:800,height:600,caption:\"types\",src:\"/blog/pytorch/types.png\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:92,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.h3,{id:\"tensores\",children:\"Tensores\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:94,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.pre,{className:\"language-python\",children:(0,a.jsxDEV)(n.code,{className:\"language-python code-highlight\",children:[(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[\"TENSOR \",(0,a.jsxDEV)(n.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),\" torch\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),\"tensor\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"[\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"[\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"[\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"1\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),\" \",(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"2\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),\" \",(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"3\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this),(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[\"                        \",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"[\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"3\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),\" \",(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"6\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),\" \",(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"9\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this),(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[\"                        \",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"[\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"2\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),\" \",(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"4\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),\" \",(0,a.jsxDEV)(n.span,{className:\"token number\",children:\"5\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\"]\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:3,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this),(0,a.jsxDEV)(n.span,{className:\"code-line\",children:`TENSOR\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:96,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:96,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.pre,{className:\"language-txt\",children:(0,a.jsxDEV)(n.code,{className:\"language-txt code-highlight\",children:[(0,a.jsxDEV)(n.span,{className:\"code-line\",children:`Out: tensor([[[1, 2, 3],\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this),(0,a.jsxDEV)(n.span,{className:\"code-line\",children:`         [3, 6, 9],\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this),(0,a.jsxDEV)(n.span,{className:\"code-line\",children:`         [2, 4, 5]]])\n`},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:103,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:103,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.p,{children:\"Para saber a dimens\\xE3o e o tamanho basta usar os mesmos comandos:\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:109,columnNumber:1},this),`\n`,(0,a.jsxDEV)(n.pre,{className:\"language-python\",children:(0,a.jsxDEV)(n.code,{className:\"language-python code-highlight\",children:[(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[\"TENSOR\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this),`ndim\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this),(0,a.jsxDEV)(n.span,{className:\"code-line\",children:[\"TENSOR\",(0,a.jsxDEV)(n.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:2,columnNumber:1},this),`shape\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:111,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:111,columnNumber:1},this),`\n`,(0,a.jsxDEV)(p,{rounded:!0,width:800,height:600,caption:\"Tensor\",src:\"/blog/pytorch/tensor.png\"},void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:116,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\",lineNumber:1,columnNumber:1},this)}function xn(d={}){let{wrapper:n}=d.components||{};return n?(0,a.jsxDEV)(n,Object.assign({},d,{children:(0,a.jsxDEV)(Ee,d,void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this)}),void 0,!1,{fileName:\"/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx\"},this):Ee(d)}var gn=xn;function Re(d,n,f){throw new Error(\"Expected \"+(n?\"component\":\"object\")+\" `\"+d+\"` to be defined: you likely forgot to import, pass, or provide it.\"+(f?\"\\nIt\\u2019s referenced in your code at `\"+f+\"` in `/Users/nicolasalan/Downloads/nicolasalan.io/content/blog/_mdx_bundler_entry_point-36daaef2-a929-4998-b3be-f4c706086040.mdx`\":\"\"))}return pn(yn);})();\n/*! Bundled license information:\n\nreact/cjs/react-jsx-dev-runtime.development.js:\n  (**\n   * @license React\n   * react-jsx-dev-runtime.development.js\n   *\n   * Copyright (c) Facebook, Inc. and its affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n*/\n;return Component;"
    },
    "_id": "blog/pytorch.mdx",
    "_raw": {
      "sourceFilePath": "blog/pytorch.mdx",
      "sourceFileName": "pytorch.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/pytorch"
    },
    "type": "Post",
    "slug": "pytorch",
    "image": "/blog/pytorch/image.jpeg",
    "og": "/blog/pytorch/image.jpeg"
  },
  {
    "title": "Descontar recompenças futuras",
    "summary": "Conceitos fundamentais sobre RL",
    "publishedAt": "2024-04-1",
    "tags": [
      "RL",
      "fundamentos"
    ],
    "shortTitle": "RL",
    "body": {
      "raw": "\n# Por que adicionar uma taxa de 0.99 para descontar recompensas futuras?\n\nEquação de desconto de recompensas futuras:\n\n<MathBlock caption=\"\">\n  {\"G_t = γ⁰R_t + γ¹R_t+1 ... = ∑_{k=0}^{∞} γ^k R_{t+k}\"}\n</MathBlock>\n\nOu seja, essa função é uma soma infinita de recompensas futuras, onde cada recompensa é multiplicada por um fator de desconto γ.\n\nBasicamente a equação de Ballman é uma equação infinita, então se não houver um fator de desconto, a soma de recompensas futuras seria infinita.\n\nexemplo:\n<MathBlock caption=\"\">\n{\"G_t = R_t + R_t+1 + R_t+2 + … = 1 + 1 + 1 + … = ∞\"}\n</MathBlock>\n\nEssa parte resolver a questão do infinito na equação de Ballman, mas por que o desconto?\n\nTem mais haver com a psicologia \"aversão ao risco\", nos seres humanos preferimos curtir o agora do que o futuro, então se tivermos uma recompensa futura, ela deve ser descontada, ou seja, ela deve valer menos do que uma recompensa imediata.\n\n<Alert type=\"attention\">\n  Em geral, quanto mais estocástico for o ambiente, menos as nossas ações terão um impacto duradouro no desempenho.\n</Alert>\n\nÀs vezes é melhor pegar uma recompensa imediata do que esperar por uma recompensa futura, pois o ambiente pode mudar e a recompensa futura pode não ser mais valida.\n\n#### Lembrando:\n\n- Se o ambiente é estocástico, o desconto pode ser menor.\n- Se o ambiente é determinístico, o desconto pode ser maior.\n\n#### Alternativas:\n\n- recompensas médias\n- taxas dependentes do Estado\n\n#### Leitura:\n\n- Kahneman, D. (2017). Pensando, rápido e lento.\n- A aprendizagem por reforço com desconto não é um problema de otimização. https://arxiv.org/pdf/1910.02140.pdf\n- Repensando o fator de desconto na aprendizagem por reforço: uma abordagem teórica de decisão. https://arxiv.org/pdf/1902.02893.pdf\n- Compreender o papel do fator de desconto na aprendizagem por reforço. https://stats.stackexchange.com/questions/221402/understanding-the-role-of-the-discount-factor-in-reinforcement-learning\n",
      "code": "var Component=(()=>{var cn=Object.create;var D=Object.defineProperty;var fn=Object.getOwnPropertyDescriptor;var dn=Object.getOwnPropertyNames;var mn=Object.getPrototypeOf,bn=Object.prototype.hasOwnProperty;var z=(u,a)=>()=>(a||u((a={exports:{}}).exports,a),a.exports),vn=(u,a)=>{for(var m in a)D(u,m,{get:a[m],enumerable:!0})},xe=(u,a,m,_)=>{if(a&&typeof a==\"object\"||typeof a==\"function\")for(let y of dn(a))!bn.call(u,y)&&y!==m&&D(u,y,{get:()=>a[y],enumerable:!(_=fn(a,y))||_.enumerable});return u};var pn=(u,a,m)=>(m=u!=null?cn(mn(u)):{},xe(a||!u||!u.__esModule?D(m,\"default\",{value:u,enumerable:!0}):m,u)),_n=u=>xe(D({},\"__esModule\",{value:!0}),u);var Ne=z((Nn,Ee)=>{Ee.exports=React});var Re=z(G=>{\"use strict\";(function(){\"use strict\";var u=Ne(),a=Symbol.for(\"react.element\"),m=Symbol.for(\"react.portal\"),_=Symbol.for(\"react.fragment\"),y=Symbol.for(\"react.strict_mode\"),K=Symbol.for(\"react.profiler\"),X=Symbol.for(\"react.provider\"),H=Symbol.for(\"react.context\"),O=Symbol.for(\"react.forward_ref\"),A=Symbol.for(\"react.suspense\"),F=Symbol.for(\"react.suspense_list\"),w=Symbol.for(\"react.memo\"),I=Symbol.for(\"react.lazy\"),Pe=Symbol.for(\"react.offscreen\"),J=Symbol.iterator,Se=\"@@iterator\";function je(e){if(e===null||typeof e!=\"object\")return null;var n=J&&e[J]||e[Se];return typeof n==\"function\"?n:null}var E=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function b(e){{for(var n=arguments.length,r=new Array(n>1?n-1:0),t=1;t<n;t++)r[t-1]=arguments[t];ke(\"error\",e,r)}}function ke(e,n,r){{var t=E.ReactDebugCurrentFrame,s=t.getStackAddendum();s!==\"\"&&(n+=\"%s\",r=r.concat([s]));var c=r.map(function(i){return String(i)});c.unshift(\"Warning: \"+n),Function.prototype.apply.call(console[e],console,c)}}var Ue=!1,De=!1,Ae=!1,Fe=!1,Ie=!1,Z;Z=Symbol.for(\"react.module.reference\");function Me(e){return!!(typeof e==\"string\"||typeof e==\"function\"||e===_||e===K||Ie||e===y||e===A||e===F||Fe||e===Pe||Ue||De||Ae||typeof e==\"object\"&&e!==null&&(e.$$typeof===I||e.$$typeof===w||e.$$typeof===X||e.$$typeof===H||e.$$typeof===O||e.$$typeof===Z||e.getModuleId!==void 0))}function Ye(e,n,r){var t=e.displayName;if(t)return t;var s=n.displayName||n.name||\"\";return s!==\"\"?r+\"(\"+s+\")\":r}function Q(e){return e.displayName||\"Context\"}function h(e){if(e==null)return null;if(typeof e.tag==\"number\"&&b(\"Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue.\"),typeof e==\"function\")return e.displayName||e.name||null;if(typeof e==\"string\")return e;switch(e){case _:return\"Fragment\";case m:return\"Portal\";case K:return\"Profiler\";case y:return\"StrictMode\";case A:return\"Suspense\";case F:return\"SuspenseList\"}if(typeof e==\"object\")switch(e.$$typeof){case H:var n=e;return Q(n)+\".Consumer\";case X:var r=e;return Q(r._context)+\".Provider\";case O:return Ye(e,e.render,\"ForwardRef\");case w:var t=e.displayName||null;return t!==null?t:h(e.type)||\"Memo\";case I:{var s=e,c=s._payload,i=s._init;try{return h(i(c))}catch{return null}}}return null}var x=Object.assign,T=0,ee,ne,re,ae,te,oe,ie;function le(){}le.__reactDisabledLog=!0;function $e(){{if(T===0){ee=console.log,ne=console.info,re=console.warn,ae=console.error,te=console.group,oe=console.groupCollapsed,ie=console.groupEnd;var e={configurable:!0,enumerable:!0,value:le,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}T++}}function Le(){{if(T--,T===0){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:x({},e,{value:ee}),info:x({},e,{value:ne}),warn:x({},e,{value:re}),error:x({},e,{value:ae}),group:x({},e,{value:te}),groupCollapsed:x({},e,{value:oe}),groupEnd:x({},e,{value:ie})})}T<0&&b(\"disabledDepth fell below zero. This is a bug in React. Please file an issue.\")}}var M=E.ReactCurrentDispatcher,Y;function P(e,n,r){{if(Y===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\\n( *(at )?)/);Y=t&&t[1]||\"\"}return`\n`+Y+e}}var $=!1,S;{var We=typeof WeakMap==\"function\"?WeakMap:Map;S=new We}function se(e,n){if(!e||$)return\"\";{var r=S.get(e);if(r!==void 0)return r}var t;$=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var c;c=M.current,M.current=null,$e();try{if(n){var i=function(){throw Error()};if(Object.defineProperty(i.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(i,[])}catch(g){t=g}Reflect.construct(e,[],i)}else{try{i.call()}catch(g){t=g}e.call(i.prototype)}}else{try{throw Error()}catch(g){t=g}e()}}catch(g){if(g&&t&&typeof g.stack==\"string\"){for(var o=g.stack.split(`\n`),v=t.stack.split(`\n`),f=o.length-1,d=v.length-1;f>=1&&d>=0&&o[f]!==v[d];)d--;for(;f>=1&&d>=0;f--,d--)if(o[f]!==v[d]){if(f!==1||d!==1)do if(f--,d--,d<0||o[f]!==v[d]){var p=`\n`+o[f].replace(\" at new \",\" at \");return e.displayName&&p.includes(\"<anonymous>\")&&(p=p.replace(\"<anonymous>\",e.displayName)),typeof e==\"function\"&&S.set(e,p),p}while(f>=1&&d>=0);break}}}finally{$=!1,M.current=c,Le(),Error.prepareStackTrace=s}var R=e?e.displayName||e.name:\"\",ye=R?P(R):\"\";return typeof e==\"function\"&&S.set(e,ye),ye}function Ve(e,n,r){return se(e,!1)}function qe(e){var n=e.prototype;return!!(n&&n.isReactComponent)}function j(e,n,r){if(e==null)return\"\";if(typeof e==\"function\")return se(e,qe(e));if(typeof e==\"string\")return P(e);switch(e){case A:return P(\"Suspense\");case F:return P(\"SuspenseList\")}if(typeof e==\"object\")switch(e.$$typeof){case O:return Ve(e.render);case w:return j(e.type,n,r);case I:{var t=e,s=t._payload,c=t._init;try{return j(c(s),n,r)}catch{}}}return\"\"}var k=Object.prototype.hasOwnProperty,ue={},ce=E.ReactDebugCurrentFrame;function U(e){if(e){var n=e._owner,r=j(e.type,e._source,n?n.type:null);ce.setExtraStackFrame(r)}else ce.setExtraStackFrame(null)}function Be(e,n,r,t,s){{var c=Function.call.bind(k);for(var i in e)if(c(e,i)){var o=void 0;try{if(typeof e[i]!=\"function\"){var v=Error((t||\"React class\")+\": \"+r+\" type `\"+i+\"` is invalid; it must be a function, usually from the `prop-types` package, but received `\"+typeof e[i]+\"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.\");throw v.name=\"Invariant Violation\",v}o=e[i](n,i,t,r,null,\"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED\")}catch(f){o=f}o&&!(o instanceof Error)&&(U(s),b(\"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).\",t||\"React class\",r,i,typeof o),U(null)),o instanceof Error&&!(o.message in ue)&&(ue[o.message]=!0,U(s),b(\"Failed %s type: %s\",r,o.message),U(null))}}}var ze=Array.isArray;function L(e){return ze(e)}function Ge(e){{var n=typeof Symbol==\"function\"&&Symbol.toStringTag,r=n&&e[Symbol.toStringTag]||e.constructor.name||\"Object\";return r}}function Ke(e){try{return fe(e),!1}catch{return!0}}function fe(e){return\"\"+e}function de(e){if(Ke(e))return b(\"The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.\",Ge(e)),fe(e)}var C=E.ReactCurrentOwner,Xe={key:!0,ref:!0,__self:!0,__source:!0},me,be,W;W={};function He(e){if(k.call(e,\"ref\")){var n=Object.getOwnPropertyDescriptor(e,\"ref\").get;if(n&&n.isReactWarning)return!1}return e.ref!==void 0}function Je(e){if(k.call(e,\"key\")){var n=Object.getOwnPropertyDescriptor(e,\"key\").get;if(n&&n.isReactWarning)return!1}return e.key!==void 0}function Ze(e,n){if(typeof e.ref==\"string\"&&C.current&&n&&C.current.stateNode!==n){var r=h(C.current.type);W[r]||(b('Component \"%s\" contains the string ref \"%s\". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',h(C.current.type),e.ref),W[r]=!0)}}function Qe(e,n){{var r=function(){me||(me=!0,b(\"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",n))};r.isReactWarning=!0,Object.defineProperty(e,\"key\",{get:r,configurable:!0})}}function en(e,n){{var r=function(){be||(be=!0,b(\"%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",n))};r.isReactWarning=!0,Object.defineProperty(e,\"ref\",{get:r,configurable:!0})}}var nn=function(e,n,r,t,s,c,i){var o={$$typeof:a,type:e,key:n,ref:r,props:i,_owner:c};return o._store={},Object.defineProperty(o._store,\"validated\",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(o,\"_self\",{configurable:!1,enumerable:!1,writable:!1,value:t}),Object.defineProperty(o,\"_source\",{configurable:!1,enumerable:!1,writable:!1,value:s}),Object.freeze&&(Object.freeze(o.props),Object.freeze(o)),o};function rn(e,n,r,t,s){{var c,i={},o=null,v=null;r!==void 0&&(de(r),o=\"\"+r),Je(n)&&(de(n.key),o=\"\"+n.key),He(n)&&(v=n.ref,Ze(n,s));for(c in n)k.call(n,c)&&!Xe.hasOwnProperty(c)&&(i[c]=n[c]);if(e&&e.defaultProps){var f=e.defaultProps;for(c in f)i[c]===void 0&&(i[c]=f[c])}if(o||v){var d=typeof e==\"function\"?e.displayName||e.name||\"Unknown\":e;o&&Qe(i,d),v&&en(i,d)}return nn(e,o,v,s,t,C.current,i)}}var V=E.ReactCurrentOwner,ve=E.ReactDebugCurrentFrame;function N(e){if(e){var n=e._owner,r=j(e.type,e._source,n?n.type:null);ve.setExtraStackFrame(r)}else ve.setExtraStackFrame(null)}var q;q=!1;function B(e){return typeof e==\"object\"&&e!==null&&e.$$typeof===a}function pe(){{if(V.current){var e=h(V.current.type);if(e)return`\n\nCheck the render method of \\``+e+\"`.\"}return\"\"}}function an(e){{if(e!==void 0){var n=e.fileName.replace(/^.*[\\\\\\/]/,\"\"),r=e.lineNumber;return`\n\nCheck your code at `+n+\":\"+r+\".\"}return\"\"}}var _e={};function tn(e){{var n=pe();if(!n){var r=typeof e==\"string\"?e:e.displayName||e.name;r&&(n=`\n\nCheck the top-level render call using <`+r+\">.\")}return n}}function he(e,n){{if(!e._store||e._store.validated||e.key!=null)return;e._store.validated=!0;var r=tn(n);if(_e[r])return;_e[r]=!0;var t=\"\";e&&e._owner&&e._owner!==V.current&&(t=\" It was passed a child from \"+h(e._owner.type)+\".\"),N(e),b('Each child in a list should have a unique \"key\" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',r,t),N(null)}}function ge(e,n){{if(typeof e!=\"object\")return;if(L(e))for(var r=0;r<e.length;r++){var t=e[r];B(t)&&he(t,n)}else if(B(e))e._store&&(e._store.validated=!0);else if(e){var s=je(e);if(typeof s==\"function\"&&s!==e.entries)for(var c=s.call(e),i;!(i=c.next()).done;)B(i.value)&&he(i.value,n)}}}function on(e){{var n=e.type;if(n==null||typeof n==\"string\")return;var r;if(typeof n==\"function\")r=n.propTypes;else if(typeof n==\"object\"&&(n.$$typeof===O||n.$$typeof===w))r=n.propTypes;else return;if(r){var t=h(n);Be(r,e.props,\"prop\",t,e)}else if(n.PropTypes!==void 0&&!q){q=!0;var s=h(n);b(\"Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?\",s||\"Unknown\")}typeof n.getDefaultProps==\"function\"&&!n.getDefaultProps.isReactClassApproved&&b(\"getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.\")}}function ln(e){{for(var n=Object.keys(e.props),r=0;r<n.length;r++){var t=n[r];if(t!==\"children\"&&t!==\"key\"){N(e),b(\"Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.\",t),N(null);break}}e.ref!==null&&(N(e),b(\"Invalid attribute `ref` supplied to `React.Fragment`.\"),N(null))}}function sn(e,n,r,t,s,c){{var i=Me(e);if(!i){var o=\"\";(e===void 0||typeof e==\"object\"&&e!==null&&Object.keys(e).length===0)&&(o+=\" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.\");var v=an(s);v?o+=v:o+=pe();var f;e===null?f=\"null\":L(e)?f=\"array\":e!==void 0&&e.$$typeof===a?(f=\"<\"+(h(e.type)||\"Unknown\")+\" />\",o=\" Did you accidentally export a JSX literal instead of a component?\"):f=typeof e,b(\"React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s\",f,o)}var d=rn(e,n,r,s,c);if(d==null)return d;if(i){var p=n.children;if(p!==void 0)if(t)if(L(p)){for(var R=0;R<p.length;R++)ge(p[R],e);Object.freeze&&Object.freeze(p)}else b(\"React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.\");else ge(p,e)}return e===_?ln(d):on(d),d}}var un=sn;G.Fragment=_,G.jsxDEV=un})()});var Ce=z((Tn,Te)=>{\"use strict\";Te.exports=Re()});var xn={};vn(xn,{default:()=>yn,frontmatter:()=>hn});var l=pn(Ce()),hn={title:\"Descontar recompen\\xE7as futuras\",publishedAt:\"2024-04-1\",summary:\"Conceitos fundamentais sobre RL\",tags:[\"RL\",\"fundamentos\"],shortTitle:\"RL\"};function Oe(u){let a=Object.assign({h1:\"h1\",p:\"p\",h4:\"h4\",ul:\"ul\",li:\"li\"},u.components),{MathBlock:m,Alert:_}=a;return _||we(\"Alert\",!0,\"30:1-32:9\"),m||we(\"MathBlock\",!0,\"13:1-15:13\"),(0,l.jsxDEV)(l.Fragment,{children:[(0,l.jsxDEV)(a.h1,{id:\"por-que-adicionar-uma-taxa-de-099-para-descontar-recompensas-futuras\",children:\"Por que adicionar uma taxa de 0.99 para descontar recompensas futuras?\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:9,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.p,{children:\"Equa\\xE7\\xE3o de desconto de recompensas futuras:\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:11,columnNumber:1},this),`\n`,(0,l.jsxDEV)(m,{caption:\"\",children:\"G_t = \\u03B3\\u2070R_t + \\u03B3\\xB9R_t+1 ... = \\u2211_{k=0}^{\\u221E} \\u03B3^k R_{t+k}\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:13,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.p,{children:\"Ou seja, essa fun\\xE7\\xE3o \\xE9 uma soma infinita de recompensas futuras, onde cada recompensa \\xE9 multiplicada por um fator de desconto \\u03B3.\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:17,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.p,{children:\"Basicamente a equa\\xE7\\xE3o de Ballman \\xE9 uma equa\\xE7\\xE3o infinita, ent\\xE3o se n\\xE3o houver um fator de desconto, a soma de recompensas futuras seria infinita.\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:19,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.p,{children:\"exemplo:\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:21,columnNumber:1},this),`\n`,(0,l.jsxDEV)(m,{caption:\"\",children:\"G_t = R_t + R_t+1 + R_t+2 + \\u2026 = 1 + 1 + 1 + \\u2026 = \\u221E\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:22,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.p,{children:\"Essa parte resolver a quest\\xE3o do infinito na equa\\xE7\\xE3o de Ballman, mas por que o desconto?\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:26,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.p,{children:'Tem mais haver com a psicologia \"avers\\xE3o ao risco\", nos seres humanos preferimos curtir o agora do que o futuro, ent\\xE3o se tivermos uma recompensa futura, ela deve ser descontada, ou seja, ela deve valer menos do que uma recompensa imediata.'},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:28,columnNumber:1},this),`\n`,(0,l.jsxDEV)(_,{type:\"attention\",children:(0,l.jsxDEV)(a.p,{children:\"Em geral, quanto mais estoc\\xE1stico for o ambiente, menos as nossas a\\xE7\\xF5es ter\\xE3o um impacto duradouro no desempenho.\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:31,columnNumber:3},this)},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:30,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.p,{children:\"\\xC0s vezes \\xE9 melhor pegar uma recompensa imediata do que esperar por uma recompensa futura, pois o ambiente pode mudar e a recompensa futura pode n\\xE3o ser mais valida.\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:34,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.h4,{id:\"lembrando\",children:\"Lembrando:\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:36,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.ul,{children:[`\n`,(0,l.jsxDEV)(a.li,{children:\"Se o ambiente \\xE9 estoc\\xE1stico, o desconto pode ser menor.\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:38,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.li,{children:\"Se o ambiente \\xE9 determin\\xEDstico, o desconto pode ser maior.\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:39,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:38,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.h4,{id:\"alternativas\",children:\"Alternativas:\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:41,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.ul,{children:[`\n`,(0,l.jsxDEV)(a.li,{children:\"recompensas m\\xE9dias\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:43,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.li,{children:\"taxas dependentes do Estado\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:44,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:43,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.h4,{id:\"leitura\",children:\"Leitura:\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:46,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.ul,{children:[`\n`,(0,l.jsxDEV)(a.li,{children:\"Kahneman, D. (2017). Pensando, r\\xE1pido e lento.\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:48,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.li,{children:\"A aprendizagem por refor\\xE7o com desconto n\\xE3o \\xE9 um problema de otimiza\\xE7\\xE3o. https://arxiv.org/pdf/1910.02140.pdf\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:49,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.li,{children:\"Repensando o fator de desconto na aprendizagem por refor\\xE7o: uma abordagem te\\xF3rica de decis\\xE3o. https://arxiv.org/pdf/1902.02893.pdf\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:50,columnNumber:1},this),`\n`,(0,l.jsxDEV)(a.li,{children:\"Compreender o papel do fator de desconto na aprendizagem por refor\\xE7o. https://stats.stackexchange.com/questions/221402/understanding-the-role-of-the-discount-factor-in-reinforcement-learning\"},void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:51,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:48,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\",lineNumber:1,columnNumber:1},this)}function gn(u={}){let{wrapper:a}=u.components||{};return a?(0,l.jsxDEV)(a,Object.assign({},u,{children:(0,l.jsxDEV)(Oe,u,void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\"},this)}),void 0,!1,{fileName:\"/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx\"},this):Oe(u)}var yn=gn;function we(u,a,m){throw new Error(\"Expected \"+(a?\"component\":\"object\")+\" `\"+u+\"` to be defined: you likely forgot to import, pass, or provide it.\"+(m?\"\\nIt\\u2019s referenced in your code at `\"+m+\"` in `/Users/nicolasalan/microvault/nicolasalan.io/content/blog/_mdx_bundler_entry_point-647a21f9-1216-4aa7-b184-b78f161beab3.mdx`\":\"\"))}return _n(xn);})();\n/*! Bundled license information:\n\nreact/cjs/react-jsx-dev-runtime.development.js:\n  (**\n   * @license React\n   * react-jsx-dev-runtime.development.js\n   *\n   * Copyright (c) Facebook, Inc. and its affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n*/\n;return Component;"
    },
    "_id": "blog/reward_discount.mdx",
    "_raw": {
      "sourceFilePath": "blog/reward_discount.mdx",
      "sourceFileName": "reward_discount.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/reward_discount"
    },
    "type": "Post",
    "slug": "reward_discount",
    "image": "/blog/reward_discount/image.jpeg",
    "og": "/blog/reward_discount/image.jpeg"
  },
  {
    "title": "Vision Transformer (ViT) - Resumo",
    "summary": "Reconhecimento de imagem com o Vision Transformer (ViT)",
    "publishedAt": "2024-01-02",
    "tags": [
      "Pytorch",
      "ViT",
      "Transformer",
      "Vision"
    ],
    "shortTitle": "ViT",
    "body": {
      "raw": "\nBasicamente toda a arquitetura de modelos de *deep learning* é construído por camadas,\ncada camada executa uma função, um conjunto de camadas é um bloco e um conjunto\nde blocos forma um modelo.\n\n<Image rounded width={600} height={400} caption=\"Blocos do Transformers\" src=\"/blog/transformer/blocks.png\" />\n\nO modelo **`Vit Tranformer`** é dividido nas seguintes partes:\n\n<Image rounded width={600} height={400} caption=\"Blocos do Transformers\" src=\"/blog/transformer/block.png\" />\n\n#### 1. **Incorporação de patch + posição (entradas):**\n\n    Nessa parte ele divide as entradas no caso imagens em patch, além disso incorpora uma posição em cada patch para saber como a ordem.\n\n#### 2. ***Embedded Patches*:**\n\n    Nessa parte ele faz uma incorporação, assim que chamam onde seria transformar em um material que seria mais fácil de aprender para um IA, basicamente seria uma vetorização.\n\n#### 3. **Normalização:**\n\n    Normalizar a camada para evitar o *overfitting*.\n\n#### 4. **Atenção multicabeças:**\n\n    É aqui que a atenção é incorporada, também chamada de MSA, o pytorch já tem uma função para isso `[torch.nn.MultiheadAttention()`.\n\n#### 5. **MLP:**\n\n    *Perception* multi camada ou qualquer outra camada totalmente conectar como o linear que passa pelo *forward*. No próprio artigo possui uma camada linear, uma ativação não linear GELU e um *Dropout*.\n\n#### 6. ***Transformer Encoder*:**\n\n    Nessa parte é o decodificador onde na arquitetura *transformers* possui vários.\n\n#### 7. **MLP Head:**\n\n    Aqui somente produz a saída desejada.\n\n<Image rounded width={600} height={400} caption=\"4 Equações Gerais\" src=\"/blog/transformer/math.png\" />\n\n## Resumo de cada uma das equações:\n\n### 1) Embeddings de patch\nO Transformer utiliza um vetor latente constante `(uma dimensão definida, o termo \"vetor latente\" se refere a uma\nRepresentação de cada característica da entrada)` e mapeia cada vetor em 1D, pois é mais \"treinável\" para a máquina. \nFazer essa transformação é chamado de **embeddings de patch**, que seria vetorizar os valores e deixar em uma dimensão só, além de \nadicionar uma posição para cada patch, para saber a ordem.\n\n### 2) Codificador Transformer\nO codificador consiste em várias camadas de auto atenção chamadas de **Multi-Head Self-Attention (MSA)**,\nO layer Norm é aplicado antes de cada bloco e uma conexão residual após os blocos.\n\n### 3) Mesmo que a 2.\nMesma equação realizado na 2.\n\n### 4) Tokenização\nAdicionamos um token na sequência de patchs e produzir uma saída para o modelo.\n\n<Image rounded width={600} height={400} caption=\"Relação dos blocos\" src=\"/blog/transformer/equations.png\" />\n\n### Para mais detalhes:\n\n#### Visão geral da Equação 1\n\n<MathBlock caption=\"Equação Z0\">\n  {\"Z_0 = [X_{class}; X_{2p}E; ...;X_{np}E]+E_{pos}, E R^{(p^2*C)^D}, E_{pos} R^{(N*1)^D}\"}\n</MathBlock>\n\nEquação da tokenização !!!, onde enfim incorpora os patchs e a posição nos valores de entradas.\n`O valores de entradas podem ser uma imagem, textou ou qualquer outro tipo de dado.`\n\nUm pseudocódigo:\n\n```python\nx_input = [class_token, image_patch_1, image_patch_2, image_patch_3...] + \n[class_token_position, image_patch_1_position, image_patch_2_position, \nimage_patch_3_position...]\n``` \n\nOnde cada vetor dessa lista/vetor pode ser aprendido. `requires_grad=True`\n\n#### Visão geral da Equação 2\n\n<MathBlock caption=\"Equação Zl\">\n  {\"Z_l = MSA(LN(Z_{l-1})) + Z_{l-1}, l=1...L\"}\n</MathBlock>\n\nNessa equação mostra que para cada camada, existe um MSA envolvendo uma camada layer norm (LN).\nA adição final é uma conexão residual, que é basicamente adicionar as informações originais a saída. Ou seja, o modelo\ndiz simplesmente:\n> Mantenha parte da informação original, pois ela pode ser útil!\n\n<Image rounded width={600} height={400} caption=\"Conexão residual\" src=\"/blog/transformer/residual.png\" />\n\nUm pseudocódigo:\n```python\nx_output_MSA_block = MSA_layer(LN_layer(x_input)) + x_input\n```\n#### Visão geral da Equação 3\n\n<MathBlock caption=\"Equação Zl\">\n  {\"Z_l = MLP(LN(Z_{l}')) + Z_{l}, l=1...L\"}\n</MathBlock>\n\nA equação é quase o mesmo que a equação 2, porém com uma MLP (Multi Layer Perception) no final, ao invés de uma MSA, envolto de uma (LN).\n\nUm pseudocódigo:\n```python\nx_output_MLP_block = MLP_layer(LN_layer(x_output_MSA_block)) + x_output_MSA_block\n```\n#### Visão geral da Equação 4\n\n<MathBlock caption=\"Equação final\">\n  {\"y = LN(Z_l^0)\"}\n</MathBlock>\n\nPara última camada, a saída é um token de índice 0, envolto de uma camada (LN).\n\nUm pseudocódigo:\n```python\ny = Linear_layer(LN_layer(x_output_MLP_block[0]))\n```",
      "code": "var Component=(()=>{var m=Object.create;var s=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var _=(n,a)=>()=>(a||n((a={exports:{}}).exports,a),a.exports),k=(n,a)=>{for(var o in a)s(n,o,{get:a[o],enumerable:!0})},c=(n,a,o,r)=>{if(a&&typeof a==\"object\"||typeof a==\"function\")for(let i of h(a))!N.call(n,i)&&i!==o&&s(n,i,{get:()=>a[i],enumerable:!(r=u(a,i))||r.enumerable});return n};var f=(n,a,o)=>(o=n!=null?m(g(n)):{},c(a||!n||!n.__esModule?s(o,\"default\",{value:n,enumerable:!0}):o,n)),q=n=>c(s({},\"__esModule\",{value:!0}),n);var d=_((L,t)=>{t.exports=_jsx_runtime});var x={};k(x,{default:()=>M,frontmatter:()=>b});var e=f(d()),b={title:\"Vision Transformer (ViT) - Resumo\",publishedAt:\"2024-01-02\",summary:\"Reconhecimento de imagem com o Vision Transformer (ViT)\",tags:[\"Pytorch\",\"ViT\",\"Transformer\",\"Vision\"],shortTitle:\"ViT\"};function l(n){let a=Object.assign({p:\"p\",em:\"em\",strong:\"strong\",code:\"code\",h4:\"h4\",h2:\"h2\",h3:\"h3\",pre:\"pre\",span:\"span\",blockquote:\"blockquote\"},n.components),{Image:o,MathBlock:r}=a;return o||p(\"Image\",!0),r||p(\"MathBlock\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(a.p,{children:[\"Basicamente toda a arquitetura de modelos de \",(0,e.jsx)(a.em,{children:\"deep learning\"}),` \\xE9 constru\\xEDdo por camadas,\ncada camada executa uma fun\\xE7\\xE3o, um conjunto de camadas \\xE9 um bloco e um conjunto\nde blocos forma um modelo.`]}),`\n`,(0,e.jsx)(o,{rounded:!0,width:600,height:400,caption:\"Blocos do Transformers\",src:\"/blog/transformer/blocks.png\"}),`\n`,(0,e.jsxs)(a.p,{children:[\"O modelo \",(0,e.jsx)(a.strong,{children:(0,e.jsx)(a.code,{children:\"Vit Tranformer\"})}),\" \\xE9 dividido nas seguintes partes:\"]}),`\n`,(0,e.jsx)(o,{rounded:!0,width:600,height:400,caption:\"Blocos do Transformers\",src:\"/blog/transformer/block.png\"}),`\n`,(0,e.jsxs)(a.h4,{id:\"1-incorpora\\xE7\\xE3o-de-patch--posi\\xE7\\xE3o-entradas\",children:[\"1. \",(0,e.jsx)(a.strong,{children:\"Incorpora\\xE7\\xE3o de patch + posi\\xE7\\xE3o (entradas):\"})]}),`\n`,(0,e.jsx)(a.p,{children:\"Nessa parte ele divide as entradas no caso imagens em patch, al\\xE9m disso incorpora uma posi\\xE7\\xE3o em cada patch para saber como a ordem.\"}),`\n`,(0,e.jsxs)(a.h4,{id:\"2-embedded-patches\",children:[\"2. \",(0,e.jsxs)(a.strong,{children:[(0,e.jsx)(a.em,{children:\"Embedded Patches\"}),\":\"]})]}),`\n`,(0,e.jsx)(a.p,{children:\"Nessa parte ele faz uma incorpora\\xE7\\xE3o, assim que chamam onde seria transformar em um material que seria mais f\\xE1cil de aprender para um IA, basicamente seria uma vetoriza\\xE7\\xE3o.\"}),`\n`,(0,e.jsxs)(a.h4,{id:\"3-normaliza\\xE7\\xE3o\",children:[\"3. \",(0,e.jsx)(a.strong,{children:\"Normaliza\\xE7\\xE3o:\"})]}),`\n`,(0,e.jsxs)(a.p,{children:[\"Normalizar a camada para evitar o \",(0,e.jsx)(a.em,{children:\"overfitting\"}),\".\"]}),`\n`,(0,e.jsxs)(a.h4,{id:\"4-aten\\xE7\\xE3o-multicabe\\xE7as\",children:[\"4. \",(0,e.jsx)(a.strong,{children:\"Aten\\xE7\\xE3o multicabe\\xE7as:\"})]}),`\n`,(0,e.jsxs)(a.p,{children:[\"\\xC9 aqui que a aten\\xE7\\xE3o \\xE9 incorporada, tamb\\xE9m chamada de MSA, o pytorch j\\xE1 tem uma fun\\xE7\\xE3o para isso \",(0,e.jsx)(a.code,{children:\"[torch.nn.MultiheadAttention()\"}),\".\"]}),`\n`,(0,e.jsxs)(a.h4,{id:\"5-mlp\",children:[\"5. \",(0,e.jsx)(a.strong,{children:\"MLP:\"})]}),`\n`,(0,e.jsxs)(a.p,{children:[(0,e.jsx)(a.em,{children:\"Perception\"}),\" multi camada ou qualquer outra camada totalmente conectar como o linear que passa pelo \",(0,e.jsx)(a.em,{children:\"forward\"}),\". No pr\\xF3prio artigo possui uma camada linear, uma ativa\\xE7\\xE3o n\\xE3o linear GELU e um \",(0,e.jsx)(a.em,{children:\"Dropout\"}),\".\"]}),`\n`,(0,e.jsxs)(a.h4,{id:\"6-transformer-encoder\",children:[\"6. \",(0,e.jsxs)(a.strong,{children:[(0,e.jsx)(a.em,{children:\"Transformer Encoder\"}),\":\"]})]}),`\n`,(0,e.jsxs)(a.p,{children:[\"Nessa parte \\xE9 o decodificador onde na arquitetura \",(0,e.jsx)(a.em,{children:\"transformers\"}),\" possui v\\xE1rios.\"]}),`\n`,(0,e.jsxs)(a.h4,{id:\"7-mlp-head\",children:[\"7. \",(0,e.jsx)(a.strong,{children:\"MLP Head:\"})]}),`\n`,(0,e.jsx)(a.p,{children:\"Aqui somente produz a sa\\xEDda desejada.\"}),`\n`,(0,e.jsx)(o,{rounded:!0,width:600,height:400,caption:\"4 Equa\\xE7\\xF5es Gerais\",src:\"/blog/transformer/math.png\"}),`\n`,(0,e.jsx)(a.h2,{id:\"resumo-de-cada-uma-das-equa\\xE7\\xF5es\",children:\"Resumo de cada uma das equa\\xE7\\xF5es:\"}),`\n`,(0,e.jsx)(a.h3,{id:\"1-embeddings-de-patch\",children:\"1) Embeddings de patch\"}),`\n`,(0,e.jsxs)(a.p,{children:[\"O Transformer utiliza um vetor latente constante \",(0,e.jsx)(a.code,{children:'(uma dimens\\xE3o definida, o termo \"vetor latente\" se refere a uma Representa\\xE7\\xE3o de cada caracter\\xEDstica da entrada)'}),` e mapeia cada vetor em 1D, pois \\xE9 mais \"trein\\xE1vel\" para a m\\xE1quina.\nFazer essa transforma\\xE7\\xE3o \\xE9 chamado de `,(0,e.jsx)(a.strong,{children:\"embeddings de patch\"}),`, que seria vetorizar os valores e deixar em uma dimens\\xE3o s\\xF3, al\\xE9m de\nadicionar uma posi\\xE7\\xE3o para cada patch, para saber a ordem.`]}),`\n`,(0,e.jsx)(a.h3,{id:\"2-codificador-transformer\",children:\"2) Codificador Transformer\"}),`\n`,(0,e.jsxs)(a.p,{children:[\"O codificador consiste em v\\xE1rias camadas de auto aten\\xE7\\xE3o chamadas de \",(0,e.jsx)(a.strong,{children:\"Multi-Head Self-Attention (MSA)\"}),`,\nO layer Norm \\xE9 aplicado antes de cada bloco e uma conex\\xE3o residual ap\\xF3s os blocos.`]}),`\n`,(0,e.jsx)(a.h3,{id:\"3-mesmo-que-a-2\",children:\"3) Mesmo que a 2.\"}),`\n`,(0,e.jsx)(a.p,{children:\"Mesma equa\\xE7\\xE3o realizado na 2.\"}),`\n`,(0,e.jsx)(a.h3,{id:\"4-tokeniza\\xE7\\xE3o\",children:\"4) Tokeniza\\xE7\\xE3o\"}),`\n`,(0,e.jsx)(a.p,{children:\"Adicionamos um token na sequ\\xEAncia de patchs e produzir uma sa\\xEDda para o modelo.\"}),`\n`,(0,e.jsx)(o,{rounded:!0,width:600,height:400,caption:\"Rela\\xE7\\xE3o dos blocos\",src:\"/blog/transformer/equations.png\"}),`\n`,(0,e.jsx)(a.h3,{id:\"para-mais-detalhes\",children:\"Para mais detalhes:\"}),`\n`,(0,e.jsx)(a.h4,{id:\"vis\\xE3o-geral-da-equa\\xE7\\xE3o-1\",children:\"Vis\\xE3o geral da Equa\\xE7\\xE3o 1\"}),`\n`,(0,e.jsx)(r,{caption:\"Equa\\xE7\\xE3o Z0\",children:\"Z_0 = [X_{class}; X_{2p}E; ...;X_{np}E]+E_{pos}, E R^{(p^2*C)^D}, E_{pos} R^{(N*1)^D}\"}),`\n`,(0,e.jsxs)(a.p,{children:[`Equa\\xE7\\xE3o da tokeniza\\xE7\\xE3o !!!, onde enfim incorpora os patchs e a posi\\xE7\\xE3o nos valores de entradas.\n`,(0,e.jsx)(a.code,{children:\"O valores de entradas podem ser uma imagem, textou ou qualquer outro tipo de dado.\"})]}),`\n`,(0,e.jsx)(a.p,{children:\"Um pseudoc\\xF3digo:\"}),`\n`,(0,e.jsx)(a.pre,{className:\"language-python\",children:(0,e.jsxs)(a.code,{className:\"language-python code-highlight\",children:[(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"x_input \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"class_token\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" image_patch_1\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" image_patch_2\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" image_patch_3\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"+\"}),` \n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"class_token_position\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" image_patch_1_position\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" image_patch_2_position\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),` \n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"image_patch_3_position\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(a.p,{children:[\"Onde cada vetor dessa lista/vetor pode ser aprendido. \",(0,e.jsx)(a.code,{children:\"requires_grad=True\"})]}),`\n`,(0,e.jsx)(a.h4,{id:\"vis\\xE3o-geral-da-equa\\xE7\\xE3o-2\",children:\"Vis\\xE3o geral da Equa\\xE7\\xE3o 2\"}),`\n`,(0,e.jsx)(r,{caption:\"Equa\\xE7\\xE3o Zl\",children:\"Z_l = MSA(LN(Z_{l-1})) + Z_{l-1}, l=1...L\"}),`\n`,(0,e.jsx)(a.p,{children:`Nessa equa\\xE7\\xE3o mostra que para cada camada, existe um MSA envolvendo uma camada layer norm (LN).\nA adi\\xE7\\xE3o final \\xE9 uma conex\\xE3o residual, que \\xE9 basicamente adicionar as informa\\xE7\\xF5es originais a sa\\xEDda. Ou seja, o modelo\ndiz simplesmente:`}),`\n`,(0,e.jsxs)(a.blockquote,{children:[`\n`,(0,e.jsx)(a.p,{children:\"Mantenha parte da informa\\xE7\\xE3o original, pois ela pode ser \\xFAtil!\"}),`\n`]}),`\n`,(0,e.jsx)(o,{rounded:!0,width:600,height:400,caption:\"Conex\\xE3o residual\",src:\"/blog/transformer/residual.png\"}),`\n`,(0,e.jsx)(a.p,{children:\"Um pseudoc\\xF3digo:\"}),`\n`,(0,e.jsx)(a.pre,{className:\"language-python\",children:(0,e.jsx)(a.code,{className:\"language-python code-highlight\",children:(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"x_output_MSA_block \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" MSA_layer\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"LN_layer\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"x_input\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"+\"}),` x_input\n`]})})}),`\n`,(0,e.jsx)(a.h4,{id:\"vis\\xE3o-geral-da-equa\\xE7\\xE3o-3\",children:\"Vis\\xE3o geral da Equa\\xE7\\xE3o 3\"}),`\n`,(0,e.jsx)(r,{caption:\"Equa\\xE7\\xE3o Zl\",children:\"Z_l = MLP(LN(Z_{l}')) + Z_{l}, l=1...L\"}),`\n`,(0,e.jsx)(a.p,{children:\"A equa\\xE7\\xE3o \\xE9 quase o mesmo que a equa\\xE7\\xE3o 2, por\\xE9m com uma MLP (Multi Layer Perception) no final, ao inv\\xE9s de uma MSA, envolto de uma (LN).\"}),`\n`,(0,e.jsx)(a.p,{children:\"Um pseudoc\\xF3digo:\"}),`\n`,(0,e.jsx)(a.pre,{className:\"language-python\",children:(0,e.jsx)(a.code,{className:\"language-python code-highlight\",children:(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"x_output_MLP_block \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" MLP_layer\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"LN_layer\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"x_output_MSA_block\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"+\"}),` x_output_MSA_block\n`]})})}),`\n`,(0,e.jsx)(a.h4,{id:\"vis\\xE3o-geral-da-equa\\xE7\\xE3o-4\",children:\"Vis\\xE3o geral da Equa\\xE7\\xE3o 4\"}),`\n`,(0,e.jsx)(r,{caption:\"Equa\\xE7\\xE3o final\",children:\"y = LN(Z_l^0)\"}),`\n`,(0,e.jsx)(a.p,{children:\"Para \\xFAltima camada, a sa\\xEDda \\xE9 um token de \\xEDndice 0, envolto de uma camada (LN).\"}),`\n`,(0,e.jsx)(a.p,{children:\"Um pseudoc\\xF3digo:\"}),`\n`,(0,e.jsx)(a.pre,{className:\"language-python\",children:(0,e.jsx)(a.code,{className:\"language-python code-highlight\",children:(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"y \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" Linear_layer\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"LN_layer\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"x_output_MLP_block\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(a.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),`\n`]})})})]})}function v(n={}){let{wrapper:a}=n.components||{};return a?(0,e.jsx)(a,Object.assign({},n,{children:(0,e.jsx)(l,n)})):l(n)}var M=v;function p(n,a){throw new Error(\"Expected \"+(a?\"component\":\"object\")+\" `\"+n+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return q(x);})();\n;return Component;"
    },
    "_id": "blog/transformer.mdx",
    "_raw": {
      "sourceFilePath": "blog/transformer.mdx",
      "sourceFileName": "transformer.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/transformer"
    },
    "type": "Post",
    "slug": "transformer",
    "image": "/blog/transformer/image.jpeg",
    "og": "/blog/transformer/image.jpeg"
  }
]